    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::NYTProf version 5.06
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="en-us" />
    <meta name="robots" content="noindex,nofollow" />
    <title>Profile of POE/Kernel.pm</title>
<link rel="stylesheet" type="text/css" href="style.css" />
    <script type="text/javascript" src="js/jquery-min.js"></script> 

    <script type="text/javascript" src="js/jquery-tablesorter-min.js"></script> 
    <link rel="stylesheet" type="text/css" href="js/style-tablesorter.css" />
    <script type="text/javascript">
    // when a column is first clicked on to sort it, use descending order
    // XXX doesn't seem to work (and not just because the tablesorter formatSortingOrder() is broken)
    $.tablesorter.defaults.sortInitialOrder = "desc";
    // add parser through the tablesorter addParser method 
    $.tablesorter.addParser({
        id: 'fmt_time',   // name of this parser
        is: function(s) { 
            return false; // return false so this parser is not auto detected 
        }, 
        format: function(orig) { // format data for normalization 
            // console.log(orig);
            var val = orig.replace(/ns/,'');
            if (val != orig) { return val / (1000*1000*1000); } 
            val = orig.replace(/[Âµµ]s/,''); /* micro */
            if (val != orig) { return val / (1000*1000); } 
            val = orig.replace(/ms/,'');
            if (val != orig) { return val / (1000); }
            val = orig.replace(/([0-9])s/,"$1");
            if (val != orig) { return val; }
            if (orig == '0') { return orig; } 
            var non_number = orig.replace(/^[-+]?[0-9.]+/, '', 'g');
            console.log('no match for fmt_time of '+orig+' (units:'+non_number+' charCodeAt0:'+non_number.charCodeAt(0)+')');
            return orig;
        },
        type: 'numeric' // set type, either numeric or text 
    }); 
    </script> 
</head>

<body > 
<div class="header" style="position: relative; overflow-x: hidden; overflow-y: hidden; z-index: 0; ">
<div class="header_back">
            <a href="index.html">&larr; Index</a>
        </div>
<div class="headerForeground" style="float: left">
    <span class="siteTitle">NYTProf Performance Profile</span>
    <span class="siteSubtitle">&emsp;&emsp;<span>&laquo;&emsp;<span class="mode_btn"><a href="POE-Kernel-pm-54-block.html">block view</a></span>&emsp;&bull;&emsp;<span class="mode_btn"><a href="POE-Kernel-pm-54-line.html">line view</a></span>&emsp;&bull;&emsp;<span class="mode_btn mode_btn_selected">sub view</span>&emsp;&raquo;</span><br />
            For t/simple_parallel_superbig.t
        </span>
</div>
<div class="headerForeground" style="float: right; text-align: right">
    <span class="siteTitle">&nbsp;</span>
    <span class="siteSubtitle">Run on Fri Nov 14 09:54:35 2014<br />Reported on Fri Nov 14 09:55:30 2014</span>
</div>
<div style="position: absolute; left: 0px; top: 0%; width: 100%; height: 101%; z-index: -1; background-color: rgb(17, 136, 255); "></div>
<div style="position: absolute; left: 0px; top: 2%; width: 100%; height: 99%; z-index: -1; background-color: rgb(16, 134, 253); "></div>
<div style="position: absolute; left: 0px; top: 4%; width: 100%; height: 97%; z-index: -1; background-color: rgb(16, 133, 252); "></div>
<div style="position: absolute; left: 0px; top: 6%; width: 100%; height: 95%; z-index: -1; background-color: rgb(15, 131, 250); "></div>
<div style="position: absolute; left: 0px; top: 8%; width: 100%; height: 93%; z-index: -1; background-color: rgb(15, 130, 249); "></div>
<div style="position: absolute; left: 0px; top: 10%; width: 100%; height: 91%; z-index: -1; background-color: rgb(15, 129, 248); "></div>
<div style="position: absolute; left: 0px; top: 12%; width: 100%; height: 89%; z-index: -1; background-color: rgb(14, 127, 246); "></div>
<div style="position: absolute; left: 0px; top: 14%; width: 100%; height: 87%; z-index: -1; background-color: rgb(14, 126, 245); "></div>
<div style="position: absolute; left: 0px; top: 16%; width: 100%; height: 85%; z-index: -1; background-color: rgb(14, 125, 244); "></div>
<div style="position: absolute; left: 0px; top: 18%; width: 100%; height: 83%; z-index: -1; background-color: rgb(13, 123, 242); "></div>
<div style="position: absolute; left: 0px; top: 20%; width: 100%; height: 81%; z-index: -1; background-color: rgb(13, 122, 241); "></div>
<div style="position: absolute; left: 0px; top: 22%; width: 100%; height: 79%; z-index: -1; background-color: rgb(13, 121, 240); "></div>
<div style="position: absolute; left: 0px; top: 24%; width: 100%; height: 77%; z-index: -1; background-color: rgb(12, 119, 238); "></div>
<div style="position: absolute; left: 0px; top: 26%; width: 100%; height: 75%; z-index: -1; background-color: rgb(12, 118, 237); "></div>
<div style="position: absolute; left: 0px; top: 28%; width: 100%; height: 73%; z-index: -1; background-color: rgb(12, 116, 235); "></div>
<div style="position: absolute; left: 0px; top: 30%; width: 100%; height: 71%; z-index: -1; background-color: rgb(11, 115, 234); "></div>
<div style="position: absolute; left: 0px; top: 32%; width: 100%; height: 69%; z-index: -1; background-color: rgb(11, 114, 233); "></div>
<div style="position: absolute; left: 0px; top: 34%; width: 100%; height: 67%; z-index: -1; background-color: rgb(11, 112, 231); "></div>
<div style="position: absolute; left: 0px; top: 36%; width: 100%; height: 65%; z-index: -1; background-color: rgb(10, 111, 230); "></div>
<div style="position: absolute; left: 0px; top: 38%; width: 100%; height: 63%; z-index: -1; background-color: rgb(10, 110, 229); "></div>
<div style="position: absolute; left: 0px; top: 40%; width: 100%; height: 61%; z-index: -1; background-color: rgb(10, 108, 227); "></div>
<div style="position: absolute; left: 0px; top: 42%; width: 100%; height: 59%; z-index: -1; background-color: rgb(9, 107, 226); "></div>
<div style="position: absolute; left: 0px; top: 44%; width: 100%; height: 57%; z-index: -1; background-color: rgb(9, 106, 225); "></div>
<div style="position: absolute; left: 0px; top: 46%; width: 100%; height: 55%; z-index: -1; background-color: rgb(9, 104, 223); "></div>
<div style="position: absolute; left: 0px; top: 48%; width: 100%; height: 53%; z-index: -1; background-color: rgb(8, 103, 222); "></div>
<div style="position: absolute; left: 0px; top: 50%; width: 100%; height: 51%; z-index: -1; background-color: rgb(8, 102, 221); "></div>
<div style="position: absolute; left: 0px; top: 52%; width: 100%; height: 49%; z-index: -1; background-color: rgb(8, 100, 219); "></div>
<div style="position: absolute; left: 0px; top: 54%; width: 100%; height: 47%; z-index: -1; background-color: rgb(7, 99, 218); "></div>
<div style="position: absolute; left: 0px; top: 56%; width: 100%; height: 45%; z-index: -1; background-color: rgb(7, 97, 216); "></div>
<div style="position: absolute; left: 0px; top: 58%; width: 100%; height: 43%; z-index: -1; background-color: rgb(7, 96, 215); "></div>
<div style="position: absolute; left: 0px; top: 60%; width: 100%; height: 41%; z-index: -1; background-color: rgb(6, 95, 214); "></div>
<div style="position: absolute; left: 0px; top: 62%; width: 100%; height: 39%; z-index: -1; background-color: rgb(6, 93, 212); "></div>
<div style="position: absolute; left: 0px; top: 64%; width: 100%; height: 37%; z-index: -1; background-color: rgb(6, 92, 211); "></div>
<div style="position: absolute; left: 0px; top: 66%; width: 100%; height: 35%; z-index: -1; background-color: rgb(5, 91, 210); "></div>
<div style="position: absolute; left: 0px; top: 68%; width: 100%; height: 33%; z-index: -1; background-color: rgb(5, 89, 208); "></div>
<div style="position: absolute; left: 0px; top: 70%; width: 100%; height: 31%; z-index: -1; background-color: rgb(5, 88, 207); "></div>
<div style="position: absolute; left: 0px; top: 72%; width: 100%; height: 29%; z-index: -1; background-color: rgb(4, 87, 206); "></div>
<div style="position: absolute; left: 0px; top: 74%; width: 100%; height: 27%; z-index: -1; background-color: rgb(4, 85, 204); "></div>
<div style="position: absolute; left: 0px; top: 76%; width: 100%; height: 25%; z-index: -1; background-color: rgb(4, 84, 203); "></div>
<div style="position: absolute; left: 0px; top: 78%; width: 100%; height: 23%; z-index: -1; background-color: rgb(3, 82, 201); "></div>
<div style="position: absolute; left: 0px; top: 80%; width: 100%; height: 21%; z-index: -1; background-color: rgb(3, 81, 200); "></div>
<div style="position: absolute; left: 0px; top: 82%; width: 100%; height: 19%; z-index: -1; background-color: rgb(3, 80, 199); "></div>
<div style="position: absolute; left: 0px; top: 84%; width: 100%; height: 17%; z-index: -1; background-color: rgb(2, 78, 197); "></div>
<div style="position: absolute; left: 0px; top: 86%; width: 100%; height: 15%; z-index: -1; background-color: rgb(2, 77, 196); "></div>
<div style="position: absolute; left: 0px; top: 88%; width: 100%; height: 13%; z-index: -1; background-color: rgb(2, 76, 195); "></div>
<div style="position: absolute; left: 0px; top: 90%; width: 100%; height: 11%; z-index: -1; background-color: rgb(1, 74, 193); "></div>
<div style="position: absolute; left: 0px; top: 92%; width: 100%; height: 9%; z-index: -1; background-color: rgb(1, 73, 192); "></div>
<div style="position: absolute; left: 0px; top: 94%; width: 100%; height: 7%; z-index: -1; background-color: rgb(1, 72, 191); "></div>
<div style="position: absolute; left: 0px; top: 96%; width: 100%; height: 5%; z-index: -1; background-color: rgb(0, 70, 189); "></div>
<div style="position: absolute; left: 0px; top: 98%; width: 100%; height: 3%; z-index: -1; background-color: rgb(0, 69, 188); "></div>
<div style="position: absolute; left: 0px; top: 100%; width: 100%; height: 1%; z-index: -1; background-color: rgb(0, 68, 187); "></div>
</div>

<div class="body_content"><br />
<table class="file_summary"><tr><td class="h">Filename</td><td align="left"><a href="file:///usr/local/share/perl/5.18.2/POE/Kernel.pm">/usr/local/share/perl/5.18.2/POE/Kernel.pm</a></td></tr>
<tr><td class="h">Statements</td><td align="left">Executed 84039 statements in 85.8ms</td></tr></table>
        
        <table id="subs_table" border="1" cellpadding="0" class="tablesorter">
        <caption>Subroutines</caption>
        <thead>
        <tr>
        <th>Calls</th>
        <th><span title="Number of Places sub is called from">P</span></th>
        <th><span title="Number of Files sub is called from">F</span></th>
        <th>Exclusive<br />Time</th>
        <th>Inclusive<br />Time</th>
        <th>Subroutine</th>
        </tr>
        </thead>
    <tbody>
<tr><td class="c0">401</td><td class="c1">2</td><td class="c1">2</td><td class="c0"><span title="8.0%">811ms</span></td><td class="c0"><span title="8.0%">811ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:sselect</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_sselect">CORE:sselect</a>&nbsp;(opcode)</td></tr>
<tr><td class="c0">4091</td><td class="c0">8</td><td class="c0">4</td><td class="c0"><span title="0.5%">48.6ms</span></td><td class="c0"><span title="89.5%">9.04s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_dispatch_event</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#996">_dispatch_event</a>&nbsp;(recurses: max depth 1, inclusive time 19.1ms)</td></tr>
<tr><td class="c0">80</td><td class="c0">6</td><td class="c0">3</td><td class="c0"><span title="0.1%">14.3ms</span></td><td class="c0"><span title="1.7%">176ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::call</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1710">call</a></td></tr>
<tr><td class="c0">398</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">4.74ms</span></td><td class="c0"><span title="0.1%">5.36ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_test_if_kernel_is_idle</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#609">_test_if_kernel_is_idle</a></td></tr>
<tr><td class="c0">91</td><td class="c0">3</td><td class="c3">1</td><td class="c0"><span title="0.0%">1.46ms</span></td><td class="c0"><span title="0.0%">2.46ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_find_loop</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#482">_find_loop</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">1.42ms</span></td><td class="c0"><span title="0.0%">1.52ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@27</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#27">BEGIN@27</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">1.17ms</span></td><td class="c0"><span title="0.0%">1.97ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_load_loop</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#491">_load_loop</a></td></tr>
<tr><td class="c0">819</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">1.01ms</span></td><td class="c0"><span title="0.0%">1.01ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:fteread</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_fteread">CORE:fteread</a>&nbsp;(opcode)</td></tr>
<tr><td class="c0">22</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">723Âµs</span></td><td class="c0"><span title="0.3%">26.3ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::session_alloc</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1444">session_alloc</a></td></tr>
<tr><td class="c0">145</td><td class="c0">5</td><td class="c3">1</td><td class="c0"><span title="0.0%">641Âµs</span></td><td class="c0"><span title="0.1%">9.23ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_internal_select</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2162">_internal_select</a></td></tr>
<tr><td class="c0">102</td><td class="c0">8</td><td class="c1">2</td><td class="c0"><span title="0.0%">567Âµs</span></td><td class="c0"><span title="0.0%">1.15ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::state</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2578">state</a></td></tr>
<tr><td class="c0">82</td><td class="c1">2</td><td class="c3">1</td><td class="c0"><span title="0.0%">512Âµs</span></td><td class="c0"><span title="0.0%">844Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_resolve_session</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#583">_resolve_session</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">507Âµs</span></td><td class="c0"><span title="0.0%">681Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@13</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#13">BEGIN@13</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">464Âµs</span></td><td class="c0"><span title="0.0%">5.01ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_test_loop</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#511">_test_loop</a></td></tr>
<tr><td class="c0">40</td><td class="c1">2</td><td class="c3">1</td><td class="c0"><span title="0.0%">384Âµs</span></td><td class="c0"><span title="0.0%">1.56ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::select_pause_write</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2281">select_pause_write</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">346Âµs</span></td><td class="c0"><span title="0.0%">1.10ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_finalize_kernel</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1205">_finalize_kernel</a></td></tr>
<tr><td class="c0">60</td><td class="c0">4</td><td class="c1">2</td><td class="c0"><span title="0.0%">269Âµs</span></td><td class="c0"><span title="0.0%">2.45ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::select_write</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2234">select_write</a></td></tr>
<tr><td class="c0">52</td><td class="c0">5</td><td class="c1">2</td><td class="c0"><span title="0.0%">262Âµs</span></td><td class="c0"><span title="0.1%">6.33ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::select_read</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2211">select_read</a></td></tr>
<tr><td class="c0">20</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">235Âµs</span></td><td class="c0"><span title="0.0%">1.03ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::select_resume_write</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2302">select_resume_write</a></td></tr>
<tr><td class="c0">12</td><td class="c1">2</td><td class="c3">1</td><td class="c0"><span title="0.0%">226Âµs</span></td><td class="c0"><span title="0.0%">1.06ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::delay</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1875">delay</a></td></tr>
<tr><td class="c0">31</td><td class="c0">4</td><td class="c0">3</td><td class="c0"><span title="0.0%">193Âµs</span></td><td class="c0"><span title="0.1%">5.31ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::yield</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1685">yield</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">186Âµs</span></td><td class="c0"><span title="0.0%">253Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@575</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#575">BEGIN@575</a></td></tr>
<tr><td class="c0">120</td><td class="c0">15</td><td class="c0">4</td><td class="c0"><span title="0.0%">181Âµs</span></td><td class="c1"><span title="0.0%">181Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::ID</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2482">ID</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">163Âµs</span></td><td class="c0"><span title="0.0%">734Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_dispatch_signal_event</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#874">_dispatch_signal_event</a></td></tr>
<tr><td class="c0">21</td><td class="c0">3</td><td class="c1">2</td><td class="c0"><span title="0.0%">128Âµs</span></td><td class="c1"><span title="0.0%">210Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alias_set</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2370">alias_set</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">121Âµs</span></td><td class="c1"><span title="0.0%">227Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@338</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#338">BEGIN@338</a></td></tr>
<tr><td class="c0">11</td><td class="c3">1</td><td class="c3">1</td><td class="c0"><span title="0.0%">115Âµs</span></td><td class="c0"><span title="0.0%">1.10ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::select</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2178">select</a></td></tr>
<tr><td class="c0">11</td><td class="c1">2</td><td class="c1">2</td><td class="c0"><span title="0.0%">103Âµs</span></td><td class="c1"><span title="0.0%">181Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alias_remove</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2393">alias_remove</a></td></tr>
<tr><td class="c0">26</td><td class="c1">2</td><td class="c3">1</td><td class="c1"><span title="0.0%">86Âµs</span></td><td class="c1"><span title="0.0%">173Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_invoke_state</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1406">_invoke_state</a></td></tr>
<tr><td class="c0">203</td><td class="c0">4</td><td class="c1">2</td><td class="c1"><span title="0.0%">85Âµs</span></td><td class="c3"><span title="0.0%">85Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:match</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_match">CORE:match</a>&nbsp;(opcode)</td></tr>
<tr><td class="c0">4</td><td class="c0">4</td><td class="c0">4</td><td class="c1"><span title="0.0%">73Âµs</span></td><td class="c0"><span title="0.2%">21.8ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::import</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#40">import</a>&nbsp;(recurses: max depth 1, inclusive time 17Âµs)</td></tr>
<tr><td class="c0">32</td><td class="c3">1</td><td class="c3">1</td><td class="c1"><span title="0.0%">72Âµs</span></td><td class="c0"><span title="0.0%">3.47ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:binmode</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_binmode">CORE:binmode</a>&nbsp;(opcode)</td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c2"><span title="0.0%">56Âµs</span></td><td class="c3"><span title="0.0%">59Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_define_trace</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#321">_define_trace</a></td></tr>
<tr><td class="c0">27</td><td class="c0">3</td><td class="c3">1</td><td class="c3"><span title="0.0%">47Âµs</span></td><td class="c3"><span title="0.0%">47Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_explain_usage</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#680">_explain_usage</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">42Âµs</span></td><td class="c1"><span title="0.0%">247Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alarm_remove_all</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2133">alarm_remove_all</a></td></tr>
<tr><td class="c0">64</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">41Âµs</span></td><td class="c3"><span title="0.0%">41Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:select</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_select">CORE:select</a>&nbsp;(opcode)</td></tr>
<tr><td class="c0">47</td><td class="c0">3</td><td class="c3">1</td><td class="c3"><span title="0.0%">36Âµs</span></td><td class="c3"><span title="0.0%">36Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:subst</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_subst">CORE:subst</a>&nbsp;(opcode)</td></tr>
<tr><td class="c1">2</td><td class="c1">2</td><td class="c3">1</td><td class="c3"><span title="0.0%">36Âµs</span></td><td class="c3"><span title="0.0%">36Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:close</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_close">CORE:close</a>&nbsp;(opcode)</td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">34Âµs</span></td><td class="c0"><span title="0.2%">16.7ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::new</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#797">new</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">33Âµs</span></td><td class="c3"><span title="0.0%">35Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_define_assert</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#340">_define_assert</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">29Âµs</span></td><td class="c0"><span title="98.4%">9.94s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::run</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1249">run</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">28Âµs</span></td><td class="c3"><span title="0.0%">49Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_recalc_id</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2457">_recalc_id</a></td></tr>
<tr><td class="c0">30</td><td class="c0">10</td><td class="c0">3</td><td class="c3"><span title="0.0%">26Âµs</span></td><td class="c3"><span title="0.0%">26Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__[:92]</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#92">__ANON__[:92]</a></td></tr>
<tr><td class="c0">23</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">22Âµs</span></td><td class="c3"><span title="0.0%">22Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::get_active_session</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1625">get_active_session</a></td></tr>
<tr><td class="c1">2</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">20Âµs</span></td><td class="c3"><span title="0.0%">101Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::post</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1650">post</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">14Âµs</span></td><td class="c3"><span title="0.0%">16Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@97</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#97">BEGIN@97</a></td></tr>
<tr><td class="c0">6</td><td class="c1">2</td><td class="c1">2</td><td class="c3"><span title="0.0%">14Âµs</span></td><td class="c3"><span title="0.0%">14Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:unpack</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_unpack">CORE:unpack</a>&nbsp;(opcode)</td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">14Âµs</span></td><td class="c3"><span title="0.0%">14Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:waitpid</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_waitpid">CORE:waitpid</a>&nbsp;(opcode)</td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">10Âµs</span></td><td class="c3"><span title="0.0%">27Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_initialize_kernel_session</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1193">_initialize_kernel_session</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">9Âµs</span></td><td class="c3"><span title="0.0%">9Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@84</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#84">BEGIN@84</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">8Âµs</span></td><td class="c3"><span title="0.0%">18Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@3</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#3">BEGIN@3</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">7Âµs</span></td><td class="c3"><span title="0.0%">14Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@341</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#341">BEGIN@341</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">7Âµs</span></td><td class="c3"><span title="0.0%">14Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@365</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#365">BEGIN@365</a></td></tr>
<tr><td class="c0">15</td><td class="c0">4</td><td class="c1">2</td><td class="c3"><span title="0.0%">7Âµs</span></td><td class="c3"><span title="0.0%">7Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel____ANON__">__ANON__</a>&nbsp;(xsub)</td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">6Âµs</span></td><td class="c3"><span title="0.0%">42Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@11</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#11">BEGIN@11</a></td></tr>
<tr><td class="c0">4</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">6Âµs</span></td><td class="c3"><span title="0.0%">6Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:sort</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_sort">CORE:sort</a>&nbsp;(opcode)</td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">6Âµs</span></td><td class="c3"><span title="0.0%">13Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@48</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#48">BEGIN@48</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">6Âµs</span></td><td class="c3"><span title="0.0%">12Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@322</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#322">BEGIN@322</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c3"><span title="0.0%">20Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@176</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#176">BEGIN@176</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c3"><span title="0.0%">13Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@88</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#88">BEGIN@88</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c3"><span title="0.0%">31Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@12</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#12">BEGIN@12</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c3"><span title="0.0%">13Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@357</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#357">BEGIN@357</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c0"><span title="0.0%">1.19ms</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@10</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#10">BEGIN@10</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c3"><span title="0.0%">40Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@8</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#8">BEGIN@8</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c3"><span title="0.0%">12Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@373</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#373">BEGIN@373</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c3"><span title="0.0%">12Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@100</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#100">BEGIN@100</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c3"><span title="0.0%">20Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@5</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#5">BEGIN@5</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">5Âµs</span></td><td class="c3"><span title="0.0%">27Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@20</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#20">BEGIN@20</a></td></tr>
<tr><td class="c0">3</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">4Âµs</span></td><td class="c3"><span title="0.0%">4Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CORE:pack</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_pack">CORE:pack</a>&nbsp;(opcode)</td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">3Âµs</span></td><td class="c3"><span title="0.0%">3Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_explain_resolve_failure</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#655">_explain_resolve_failure</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">3Âµs</span></td><td class="c3"><span title="0.0%">3Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@14</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#14">BEGIN@14</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">2Âµs</span></td><td class="c3"><span title="0.0%">2Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::BEGIN@15</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#15">BEGIN@15</a></td></tr>
<tr><td class="c3">1</td><td class="c3">1</td><td class="c3">1</td><td class="c3"><span title="0.0%">1Âµs</span></td><td class="c3"><span title="0.0%">1Âµs</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_idle_queue_reset</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#410">_idle_queue_reset</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::CLONE</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#861">CLONE</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::DESTROY</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1380">DESTROY</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::ID_id_to_session</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2488">ID_id_to_session</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::ID_session_to_id</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2505">ID_session_to_id</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__[:2041]</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2039">__ANON__[:2041]</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__[:2122]</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2120">__ANON__[:2122]</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__[:327]</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#327">__ANON__[:327]</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__[:346]</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#346">__ANON__[:346]</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__[:367]</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#367">__ANON__[:367]</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__[:368]</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#368">__ANON__[:368]</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__[:494]</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#494">__ANON__[:494]</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::__ANON__[:90]</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#90">__ANON__[:90]</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_carp</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#454">_carp</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_cluck</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#446">_cluck</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_confess</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#438">_confess</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_croak</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#430">_croak</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_die</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#470">_die</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_dummy_sigdie_handler</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#872">_dummy_sigdie_handler</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_explain_return</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#670">_explain_return</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_idle_queue_grow</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#407">_idle_queue_grow</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_idle_queue_shrink</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#408">_idle_queue_shrink</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_idle_queue_size</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#409">_idle_queue_size</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_rethrow_kr_exception</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1290">_rethrow_kr_exception</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_trap</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#417">_trap</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::_warn</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#462">_warn</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alarm</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1806">alarm</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alarm_add</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1845">alarm_add</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alarm_adjust</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2019">alarm_adjust</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alarm_remove</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1987">alarm_remove</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alarm_set</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1950">alarm_set</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alias_list</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2430">alias_list</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::alias_resolve</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2418">alias_resolve</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::delay_add</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1913">delay_add</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::delay_adjust</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2093">delay_adjust</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::delay_set</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2050">delay_set</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::detach_child</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1570">detach_child</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::detach_myself</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1524">detach_myself</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::get_active_event</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1629">get_active_event</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::get_event_count</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1634">get_event_count</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::get_next_event_time</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1639">get_next_event_time</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::has_forked</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1360">has_forked</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::refcount_decrement</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2551">refcount_decrement</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::refcount_increment</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2530">refcount_increment</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::run_one_timeslice</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1233">run_one_timeslice</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::run_while</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1228">run_while</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::select_expedite</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2257">select_expedite</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::select_pause_read</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2323">select_pause_read</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::select_resume_read</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#2344">select_resume_read</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::sig</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#698">sig</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::sig_child</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#772">sig_child</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::sig_handled</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#749">sig_handled</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::signal</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#722">signal</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::signal_ui_destroy</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#765">signal_ui_destroy</a></td></tr>
<tr><td class="c3">0</td><td class="c3">0</td><td class="c3">0</td><td class="c3"><span title="0.0%">0s</span></td><td class="c3"><span title="0.0%">0s</span></td><td class="sub_name"><span style="display: none;">POE::Kernel::::stop</span>POE::Kernel::<a href="POE-Kernel-pm-54-sub.html#1313">stop</a></td></tr>
</tbody></table>
                Call graph for these subroutines as a
                <a href="http://en.wikipedia.org/wiki/Graphviz">Graphviz</a>
                <a href="usr-local-share-perl-5-18-2-POE-Kernel-pm.dot">dot language file</a>.
            
      <table border="1" cellpadding="0">
      <thead>
      <tr><th>Line</th>
      <th><span title="Number of statements executed">State<br />ments</span></th>
      <th><span title="Time spend executing statements on the line,
        excluding time spent executing statements in any called subroutines">Time<br />on line</span></th>
      <th><span title="Number of subroutines calls">Calls</span></th>
      <th><span title="Time spent in subroutines called (inclusive)">Time<br />in subs</span></th>
      <th class="left_indent_header">Code</th>
      </tr>

      </thead>
      <tbody>
    <tr><td class="h"><a name="1"></a>1</td><td></td><td></td><td></td><td></td><td class="s">package POE::Kernel;</td></tr>
<tr><td class="h"><a name="2"></a>2</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="3"></a>3</td><td class="c3">2</td><td class="c3"><span title="Avg 10Âµs">20Âµs</span></td><td class="c3">2</td><td class="c3">28Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 18Âµs (8+10) within POE::Kernel::BEGIN@3 which was called:
#    once (8Âµs+10Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#3">line 3</a></div></div>use strict;<div class="calls"><div class="calls_out"># spent    18Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#3">POE::Kernel::BEGIN@3</a>
# spent    10Âµs making 1 call to <a href="strict-pm-2-sub.html#42">strict::import</a></div></div></td></tr>
<tr><td class="h"><a name="4"></a>4</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="5"></a>5</td><td class="c3">2</td><td class="c3"><span title="Avg 13Âµs">26Âµs</span></td><td class="c3">2</td><td class="c3">35Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 20Âµs (5+15) within POE::Kernel::BEGIN@5 which was called:
#    once (5Âµs+15Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#5">line 5</a></div></div>use vars qw($VERSION);<div class="calls"><div class="calls_out"># spent    20Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#5">POE::Kernel::BEGIN@5</a>
# spent    15Âµs making 1 call to <a href="vars-pm-9-sub.html#10">vars::import</a></div></div></td></tr>
<tr><td class="h"><a name="6"></a>6</td><td class="c3">1</td><td class="c3"><span title="Avg 800ns">800ns</span></td><td></td><td></td><td class="s">$VERSION = '1.365'; # NOTE - Should be #.### (three decimal places)</td></tr>
<tr><td class="h"><a name="7"></a>7</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="8"></a>8</td><td class="c3">2</td><td class="c3"><span title="Avg 12Âµs">24Âµs</span></td><td class="c3">2</td><td class="c1">74Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 40Âµs (5+35) within POE::Kernel::BEGIN@8 which was called:
#    once (5Âµs+35Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#8">line 8</a></div></div>use POE::Resource::Clock qw( monotime sleep mono2wall wall2mono walltime time );<div class="calls"><div class="calls_out"># spent    40Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#8">POE::Kernel::BEGIN@8</a>
# spent    35Âµs making 1 call to <a href="Exporter-pm-13-sub.html#28">Exporter::import</a></div></div></td></tr>
<tr><td class="h"><a name="9"></a>9</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="10"></a>10</td><td class="c3">2</td><td class="c3"><span title="Avg 11Âµs">22Âµs</span></td><td class="c3">2</td><td class="c0">2.38ms</td><td class="s"><div class="calls"><div class="calls_in"># spent 1.19ms (5Âµs+1.19) within POE::Kernel::BEGIN@10 which was called:
#    once (5Âµs+1.19ms) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#10">line 10</a></div></div>use POSIX qw(uname);<div class="calls"><div class="calls_out"># spent  1.19ms making 1 call to <a href="POE-Kernel-pm-54-sub.html#10">POE::Kernel::BEGIN@10</a>
# spent  1.19ms making 1 call to <a href="POSIX-pm-27-sub.html#21">POSIX::import</a></div></div></td></tr>
<tr><td class="h"><a name="11"></a>11</td><td class="c3">2</td><td class="c3"><span title="Avg 10Âµs">20Âµs</span></td><td class="c3">2</td><td class="c1">77Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 42Âµs (6+35) within POE::Kernel::BEGIN@11 which was called:
#    once (6Âµs+35Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#11">line 11</a></div></div>use Errno qw(ESRCH EINTR ECHILD EPERM EINVAL EEXIST EAGAIN EWOULDBLOCK);<div class="calls"><div class="calls_out"># spent    42Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#11">POE::Kernel::BEGIN@11</a>
# spent    35Âµs making 1 call to <a href="Exporter-pm-13-sub.html#28">Exporter::import</a></div></div></td></tr>
<tr><td class="h"><a name="12"></a>12</td><td class="c3">2</td><td class="c3"><span title="Avg 12Âµs">24Âµs</span></td><td class="c3">2</td><td class="c1">56Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 31Âµs (5+25) within POE::Kernel::BEGIN@12 which was called:
#    once (5Âµs+25Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#12">line 12</a></div></div>use Carp qw(carp croak confess cluck);<div class="calls"><div class="calls_out"># spent    31Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#12">POE::Kernel::BEGIN@12</a>
# spent    25Âµs making 1 call to <a href="Exporter-pm-13-sub.html#28">Exporter::import</a></div></div></td></tr>
<tr><td class="h"><a name="13"></a>13</td><td class="c3">2</td><td class="c3"><span title="Avg 43Âµs">87Âµs</span></td><td class="c3">2</td><td class="c0">702Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 681Âµs (507+174) within POE::Kernel::BEGIN@13 which was called:
#    once (507Âµs+174Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#13">line 13</a></div></div>use Sys::Hostname qw(hostname);<div class="calls"><div class="calls_out"># spent   681Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#13">POE::Kernel::BEGIN@13</a>
# spent    21Âµs making 1 call to <a href="Exporter-pm-13-sub.html#28">Exporter::import</a></div></div></td></tr>
<tr><td class="h"><a name="14"></a>14</td><td class="c3">2</td><td class="c3"><span title="Avg 8Âµs">16Âµs</span></td><td class="c3">1</td><td class="c3">3Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 3Âµs within POE::Kernel::BEGIN@14 which was called:
#    once (3Âµs+0s) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#14">line 14</a></div></div>use IO::Handle ();<div class="calls"><div class="calls_out"># spent     3Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#14">POE::Kernel::BEGIN@14</a></div></div></td></tr>
<tr><td class="h"><a name="15"></a>15</td><td class="c3">2</td><td class="c3"><span title="Avg 10Âµs">19Âµs</span></td><td class="c3">1</td><td class="c3">2Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 2Âµs within POE::Kernel::BEGIN@15 which was called:
#    once (2Âµs+0s) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#15">line 15</a></div></div>use File::Spec ();<div class="calls"><div class="calls_out"># spent     2Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#15">POE::Kernel::BEGIN@15</a></div></div></td></tr>
<tr><td class="h"><a name="16"></a>16</td><td></td><td></td><td></td><td></td><td class="s">#use Time::HiRes qw(time sleep);</td></tr>
<tr><td class="h"><a name="17"></a>17</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="18"></a>18</td><td></td><td></td><td></td><td></td><td class="s"># People expect these to be lexical.</td></tr>
<tr><td class="h"><a name="19"></a>19</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="20"></a>20</td><td class="c3">2</td><td class="c3"><span title="Avg 30Âµs">60Âµs</span></td><td class="c3">2</td><td class="c2">50Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 27Âµs (5+23) within POE::Kernel::BEGIN@20 which was called:
#    once (5Âµs+23Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#20">line 20</a></div></div>use vars qw($poe_kernel $poe_main_window);<div class="calls"><div class="calls_out"># spent    27Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#20">POE::Kernel::BEGIN@20</a>
# spent    23Âµs making 1 call to <a href="vars-pm-9-sub.html#10">vars::import</a></div></div></td></tr>
<tr><td class="h"><a name="21"></a>21</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="22"></a>22</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="23"></a>23</td><td></td><td></td><td></td><td></td><td class="s"># A cheezy exporter to avoid using Exporter.</td></tr>
<tr><td class="h"><a name="24"></a>24</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="25"></a>25</td><td class="c3">1</td><td class="c3"><span title="Avg 300ns">300ns</span></td><td></td><td></td><td class="s">my $queue_class;</td></tr>
<tr><td class="h"><a name="26"></a>26</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="27"></a>27</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.52ms (1.42+103Âµs) within POE::Kernel::BEGIN@27 which was called:
#    once (1.42ms+103Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#38">line 38</a></div></div>BEGIN {</td></tr>
<tr><td class="h"><a name="28"></a>28</td><td class="c2">6</td><td class="c3"><span title="Avg 15Âµs">88Âµs</span></td><td></td><td></td><td class="s">  eval {</td></tr>
<tr><td class="h"><a name="29"></a>29</td><td></td><td></td><td></td><td></td><td class="s">    require POE::XS::Queue::Array;</td></tr>
<tr><td class="h"><a name="30"></a>30</td><td></td><td></td><td></td><td></td><td class="s">    POE::XS::Queue::Array-&gt;import();</td></tr>
<tr><td class="h"><a name="31"></a>31</td><td></td><td></td><td></td><td></td><td class="s">    $queue_class = &quot;POE::XS::Queue::Array&quot;;</td></tr>
<tr><td class="h"><a name="32"></a>32</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="33"></a>33</td><td></td><td></td><td></td><td></td><td class="s">  unless ($queue_class) {</td></tr>
<tr><td class="h"><a name="34"></a>34</td><td></td><td></td><td></td><td></td><td class="s">    require POE::Queue::Array;</td></tr>
<tr><td class="h"><a name="35"></a>35</td><td></td><td></td><td class="c3">1</td><td class="c3">8Âµs</td><td class="s">    POE::Queue::Array-&gt;import();<div class="calls"><div class="calls_out">    # spent     8Âµs making 1 call to <a href="POE-Queue-Array-pm-56-sub.html#22">POE::Queue::Array::import</a></div></div></td></tr>
<tr><td class="h"><a name="36"></a>36</td><td></td><td></td><td></td><td></td><td class="s">    $queue_class = &quot;POE::Queue::Array&quot;;</td></tr>
<tr><td class="h"><a name="37"></a>37</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="38"></a>38</td><td class="c3">1</td><td class="c3"><span title="Avg 48Âµs">48Âµs</span></td><td class="c3">1</td><td class="c0">1.52ms</td><td class="s">}<div class="calls"><div class="calls_out"># spent  1.52ms making 1 call to <a href="POE-Kernel-pm-54-sub.html#27">POE::Kernel::BEGIN@27</a></div></div></td></tr>
<tr><td class="h"><a name="39"></a>39</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="40"></a>40</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 21.8ms (73Âµs+21.7) within POE::Kernel::import which was called 4 times, avg 5.44ms/call:
#    once (33Âµs+21.7ms) by main::BEGIN@1.7 at <a href="(eval 15)[POE-pm-47]-53-line.html#1">line 1 of (eval 15)[POE.pm:47]</a>
#    once (13Âµs+2Âµs) by POE::Wheel::ReadWrite::BEGIN@1 at <a href="(eval 39)[POE-pm-47]-95-line.html#1">line 1 of (eval 39)[POE.pm:47]</a>
#    once (12Âµs+2Âµs) by POE::Wheel::SocketFactory::BEGIN@1 at <a href="(eval 44)[POE-pm-47]-102-line.html#1">line 1 of (eval 44)[POE.pm:47]</a>
#    once (15Âµs+-15Âµs) by POE::Kernel::BEGIN@17 at <a href="POE-Loop-PerlSignals-pm-60-sub.html#17">line 17 of POE/Loop/PerlSignals.pm</a></div></div>sub import {</td></tr>
<tr><td class="h"><a name="41"></a>41</td><td class="c0">43</td><td class="c3"><span title="Avg 2Âµs">85Âµs</span></td><td></td><td></td><td class="s">  my ($class, $args) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="42"></a>42</td><td></td><td></td><td></td><td></td><td class="s">  my $package = caller();</td></tr>
<tr><td class="h"><a name="43"></a>43</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="44"></a>44</td><td></td><td></td><td></td><td></td><td class="s">  croak &quot;POE::Kernel expects its arguments in a hash ref&quot;</td></tr>
<tr><td class="h"><a name="45"></a>45</td><td></td><td></td><td></td><td></td><td class="s">    if ($args &amp;&amp; ref($args) ne 'HASH');</td></tr>
<tr><td class="h"><a name="46"></a>46</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="47"></a>47</td><td></td><td></td><td></td><td></td><td class="s">  {</td></tr>
<tr><td class="h"><a name="48"></a>48</td><td class="c3">2</td><td class="c1"><span title="Avg 84Âµs">167Âµs</span></td><td class="c3">2</td><td class="c3">21Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 13Âµs (6+8) within POE::Kernel::BEGIN@48 which was called:
#    once (6Âµs+8Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#48">line 48</a></div></div>    no strict 'refs';<div class="calls"><div class="calls_out">    # spent    13Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#48">POE::Kernel::BEGIN@48</a>
    # spent     8Âµs making 1 call to <a href="strict-pm-2-sub.html#47">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="49"></a>49</td><td></td><td></td><td></td><td></td><td class="s">    *{ $package . '::poe_kernel'      } = \$poe_kernel;</td></tr>
<tr><td class="h"><a name="50"></a>50</td><td></td><td></td><td></td><td></td><td class="s">    *{ $package . '::poe_main_window' } = \$poe_main_window;</td></tr>
<tr><td class="h"><a name="51"></a>51</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="52"></a>52</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="53"></a>53</td><td></td><td></td><td></td><td></td><td class="s">  # Extract the import arguments we're interested in here.</td></tr>
<tr><td class="h"><a name="54"></a>54</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="55"></a>55</td><td></td><td></td><td></td><td></td><td class="s">  my $loop = delete $args-&gt;{loop} || $ENV{POE_EVENT_LOOP};</td></tr>
<tr><td class="h"><a name="56"></a>56</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="57"></a>57</td><td></td><td></td><td></td><td></td><td class="s">  # Don't accept unknown/mistyped arguments.</td></tr>
<tr><td class="h"><a name="58"></a>58</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="59"></a>59</td><td></td><td></td><td class="c0">4</td><td class="c3">6Âµs</td><td class="s">  my @unknown = sort keys %$args;<div class="calls"><div class="calls_out">  # spent     6Âµs making 4 calls to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_sort">POE::Kernel::CORE:sort</a>, avg 2Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="60"></a>60</td><td></td><td></td><td></td><td></td><td class="s">  croak &quot;Unknown POE::Kernel import arguments: @unknown&quot; if @unknown;</td></tr>
<tr><td class="h"><a name="61"></a>61</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="62"></a>62</td><td></td><td></td><td></td><td></td><td class="s">  # Now do things with them.</td></tr>
<tr><td class="h"><a name="63"></a>63</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="64"></a>64</td><td></td><td></td><td class="c0">4</td><td class="c3">8Âµs</td><td class="s">  unless (UNIVERSAL::can('POE::Kernel', 'poe_kernel_loop')) {<div class="calls"><div class="calls_out">  # spent     8Âµs making 4 calls to <a href="t-simple_parallel_superbig-t-1-sub.html#UNIVERSAL__can">UNIVERSAL::can</a>, avg 2Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="65"></a>65</td><td></td><td></td><td></td><td></td><td class="s">    if (defined $loop) {</td></tr>
<tr><td class="h"><a name="66"></a>66</td><td></td><td></td><td></td><td></td><td class="s">      $loop =~ s/^(POE::)?(XS::)?(Loop::)?//;</td></tr>
<tr><td class="h"><a name="67"></a>67</td><td></td><td></td><td></td><td></td><td class="s">      if (defined $2) {</td></tr>
<tr><td class="h"><a name="68"></a>68</td><td></td><td></td><td></td><td></td><td class="s">        $loop = &quot;POE::XS::Loop::$loop&quot;;</td></tr>
<tr><td class="h"><a name="69"></a>69</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="70"></a>70</td><td></td><td></td><td></td><td></td><td class="s">      else {</td></tr>
<tr><td class="h"><a name="71"></a>71</td><td></td><td></td><td></td><td></td><td class="s">        $loop = &quot;POE::Loop::$loop&quot;;</td></tr>
<tr><td class="h"><a name="72"></a>72</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="73"></a>73</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="74"></a>74</td><td></td><td></td><td class="c3">1</td><td class="c0">5.01ms</td><td class="s">    _test_loop($loop);<div class="calls"><div class="calls_out">    # spent  5.01ms making 1 call to <a href="POE-Kernel-pm-54-sub.html#511">POE::Kernel::_test_loop</a></div></div></td></tr>
<tr><td class="h"><a name="75"></a>75</td><td></td><td></td><td></td><td></td><td class="s">    # Bootstrap the kernel.  This is inherited from a time when multiple</td></tr>
<tr><td class="h"><a name="76"></a>76</td><td></td><td></td><td></td><td></td><td class="s">    # kernels could be present in the same Perl process.</td></tr>
<tr><td class="h"><a name="77"></a>77</td><td></td><td></td><td class="c3">2</td><td class="c0">16.7ms</td><td class="s">    POE::Kernel-&gt;new() if UNIVERSAL::can('POE::Kernel', 'poe_kernel_loop');<div class="calls"><div class="calls_out">    # spent  16.7ms making 1 call to <a href="POE-Kernel-pm-54-sub.html#797">POE::Kernel::new</a>
    # spent     1Âµs making 1 call to <a href="t-simple_parallel_superbig-t-1-sub.html#UNIVERSAL__can">UNIVERSAL::can</a></div></div></td></tr>
<tr><td class="h"><a name="78"></a>78</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="79"></a>79</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="80"></a>80</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="81"></a>81</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="82"></a>82</td><td></td><td></td><td></td><td></td><td class="s"># Perform some optional setup.</td></tr>
<tr><td class="h"><a name="83"></a>83</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="84"></a>84</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 9Âµs within POE::Kernel::BEGIN@84 which was called:
#    once (9Âµs+0s) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#95">line 95</a></div></div>BEGIN {</td></tr>
<tr><td class="h"><a name="85"></a>85</td><td class="c3">4</td><td class="c3"><span title="Avg 2Âµs">10Âµs</span></td><td></td><td></td><td class="s">  local $SIG{'__DIE__'} = 'DEFAULT';</td></tr>
<tr><td class="h"><a name="86"></a>86</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="87"></a>87</td><td></td><td></td><td></td><td></td><td class="s">  {</td></tr>
<tr><td class="h"><a name="88"></a>88</td><td class="c3">2</td><td class="c3"><span title="Avg 30Âµs">60Âµs</span></td><td class="c3">2</td><td class="c3">20Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 13Âµs (5+7) within POE::Kernel::BEGIN@88 which was called:
#    once (5Âµs+7Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#88">line 88</a></div></div>    no strict 'refs';<div class="calls"><div class="calls_out">    # spent    13Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#88">POE::Kernel::BEGIN@88</a>
    # spent     7Âµs making 1 call to <a href="strict-pm-2-sub.html#47">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="89"></a>89</td><td></td><td></td><td></td><td></td><td class="s">    if ($^O eq 'MSWin32') {</td></tr>
<tr><td class="h"><a name="90"></a>90</td><td></td><td></td><td></td><td></td><td class="s">        *{ __PACKAGE__ . '::RUNNING_IN_HELL' } = sub { 1 };</td></tr>
<tr><td class="h"><a name="91"></a>91</td><td></td><td></td><td></td><td></td><td class="s">    } else {</td></tr>
<tr><td class="h"><a name="92"></a>92</td><td class="c0">30</td><td class="c3"><span title="Avg 3Âµs">81Âµs</span></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 26Âµs within POE::Kernel::__ANON__[/usr/local/share/perl/5.18.2/POE/Kernel.pm:92] which was called 30 times, avg 880ns/call:
# 11 times (9Âµs+0s) by POE::Wheel::SocketFactory::new at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#593">line 593 of POE/Wheel/SocketFactory.pm</a>, avg 818ns/call
# 11 times (9Âµs+0s) by POE::Wheel::SocketFactory::new at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#637">line 637 of POE/Wheel/SocketFactory.pm</a>, avg 791ns/call
#     once (4Âµs+0s) by POE::Kernel::_data_sig_finalize at <a href="POE-Resource-Signals-pm-85-sub.html#275">line 275 of POE/Resource/Signals.pm</a>
#     once (800ns+0s) by POE::Kernel::BEGIN@97 at <a href="POE-Kernel-pm-54-sub.html#125">line 125</a>
#     once (800ns+0s) by POE::Kernel::_data_sig_initialize at <a href="POE-Resource-Signals-pm-85-sub.html#168">line 168 of POE/Resource/Signals.pm</a>
#     once (700ns+0s) by POE::Kernel::_data_sig_mask_all at <a href="POE-Resource-Signals-pm-85-sub.html#860">line 860 of POE/Resource/Signals.pm</a>
#     once (700ns+0s) by POE::Kernel::_data_sig_pipe_build at <a href="POE-Resource-Signals-pm-85-sub.html#825">line 825 of POE/Resource/Signals.pm</a>
#     once (700ns+0s) by POE::Kernel::_data_sig_unmask_all at <a href="POE-Resource-Signals-pm-85-sub.html#872">line 872 of POE/Resource/Signals.pm</a>
#     once (600ns+0s) by POE::Kernel::BEGIN@97 at <a href="POE-Kernel-pm-54-sub.html#142">line 142</a>
#     once (600ns+0s) by POE::Kernel::_data_sig_mask_build at <a href="POE-Resource-Signals-pm-85-sub.html#851">line 851 of POE/Resource/Signals.pm</a></div></div>        *{ __PACKAGE__ . '::RUNNING_IN_HELL' } = sub { 0 };</td></tr>
<tr><td class="h"><a name="93"></a>93</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="94"></a>94</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="95"></a>95</td><td class="c3">1</td><td class="c3"><span title="Avg 19Âµs">19Âµs</span></td><td class="c3">1</td><td class="c3">9Âµs</td><td class="s">}<div class="calls"><div class="calls_out"># spent     9Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#84">POE::Kernel::BEGIN@84</a></div></div></td></tr>
<tr><td class="h"><a name="96"></a>96</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="97"></a>97</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 16Âµs (14+1) within POE::Kernel::BEGIN@97 which was called:
#    once (14Âµs+1Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#161">line 161</a></div></div>BEGIN {</td></tr>
<tr><td class="h"><a name="98"></a>98</td><td></td><td></td><td></td><td></td><td class="s">  # The entire BEGIN block is a no-strict-refs zone.</td></tr>
<tr><td class="h"><a name="99"></a>99</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="100"></a>100</td><td class="c3">2</td><td class="c0"><span title="Avg 111Âµs">222Âµs</span></td><td class="c3">2</td><td class="c3">18Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 12Âµs (5+7) within POE::Kernel::BEGIN@100 which was called:
#    once (5Âµs+7Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#100">line 100</a></div></div>  no strict 'refs';<div class="calls"><div class="calls_out">  # spent    12Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#100">POE::Kernel::BEGIN@100</a>
  # spent     7Âµs making 1 call to <a href="strict-pm-2-sub.html#47">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="101"></a>101</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="102"></a>102</td><td></td><td></td><td></td><td></td><td class="s">  # Set up a constant that lets the user deactivate automatic</td></tr>
<tr><td class="h"><a name="103"></a>103</td><td></td><td></td><td></td><td></td><td class="s">  # exception handling.</td></tr>
<tr><td class="h"><a name="104"></a>104</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="105"></a>105</td><td class="c0">10</td><td class="c3"><span title="Avg 920ns">9Âµs</span></td><td></td><td></td><td class="s">  unless (defined &amp;CATCH_EXCEPTIONS) {</td></tr>
<tr><td class="h"><a name="106"></a>106</td><td></td><td></td><td></td><td></td><td class="s">    my $catch_exceptions = (</td></tr>
<tr><td class="h"><a name="107"></a>107</td><td></td><td></td><td></td><td></td><td class="s">      (exists $ENV{POE_CATCH_EXCEPTIONS})</td></tr>
<tr><td class="h"><a name="108"></a>108</td><td></td><td></td><td></td><td></td><td class="s">      ? $ENV{POE_CATCH_EXCEPTIONS}</td></tr>
<tr><td class="h"><a name="109"></a>109</td><td></td><td></td><td></td><td></td><td class="s">      : 1</td></tr>
<tr><td class="h"><a name="110"></a>110</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="111"></a>111</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="112"></a>112</td><td></td><td></td><td></td><td></td><td class="s">    if ($catch_exceptions) {</td></tr>
<tr><td class="h"><a name="113"></a>113</td><td></td><td></td><td></td><td></td><td class="s">      *CATCH_EXCEPTIONS = sub () { 1 };</td></tr>
<tr><td class="h"><a name="114"></a>114</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="115"></a>115</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="116"></a>116</td><td></td><td></td><td></td><td></td><td class="s">      *CATCH_EXCEPTIONS = sub () { 0 };</td></tr>
<tr><td class="h"><a name="117"></a>117</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="118"></a>118</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="119"></a>119</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="120"></a>120</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined &amp;CHILD_POLLING_INTERVAL) {</td></tr>
<tr><td class="h"><a name="121"></a>121</td><td></td><td></td><td></td><td></td><td class="s">    # That's one second, not a true value.</td></tr>
<tr><td class="h"><a name="122"></a>122</td><td></td><td></td><td></td><td></td><td class="s">    *CHILD_POLLING_INTERVAL = sub () { 1 };</td></tr>
<tr><td class="h"><a name="123"></a>123</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="124"></a>124</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="125"></a>125</td><td></td><td></td><td class="c3">1</td><td class="c3">800ns</td><td class="s">  unless (defined &amp;USE_SIGCHLD) {<div class="calls"><div class="calls_out">  # spent   800ns making 1 call to <a href="POE-Kernel-pm-54-sub.html#92">POE::Kernel::__ANON__[POE/Kernel.pm:92]</a></div></div></td></tr>
<tr><td class="h"><a name="126"></a>126</td><td></td><td></td><td></td><td></td><td class="s">    # Perl &gt;= 5.7.3 has safe signals support</td></tr>
<tr><td class="h"><a name="127"></a>127</td><td></td><td></td><td></td><td></td><td class="s">    # perlipc.pod#Deferred_Signals_(Safe_Signals)</td></tr>
<tr><td class="h"><a name="128"></a>128</td><td></td><td></td><td></td><td></td><td class="s">    # We decided to target 5.8.1 just to be safe :)</td></tr>
<tr><td class="h"><a name="129"></a>129</td><td></td><td></td><td></td><td></td><td class="s">    if ( $] &gt;= 5.008001 and not RUNNING_IN_HELL ) {</td></tr>
<tr><td class="h"><a name="130"></a>130</td><td></td><td></td><td></td><td></td><td class="s">      *USE_SIGCHLD = sub () { 1 };</td></tr>
<tr><td class="h"><a name="131"></a>131</td><td></td><td></td><td></td><td></td><td class="s">    } else {</td></tr>
<tr><td class="h"><a name="132"></a>132</td><td></td><td></td><td></td><td></td><td class="s">      *USE_SIGCHLD = sub () { 0 };</td></tr>
<tr><td class="h"><a name="133"></a>133</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="134"></a>134</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="135"></a>135</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="136"></a>136</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined &amp;USE_SIGNAL_PIPE) {</td></tr>
<tr><td class="h"><a name="137"></a>137</td><td></td><td></td><td></td><td></td><td class="s">    my $use_signal_pipe;</td></tr>
<tr><td class="h"><a name="138"></a>138</td><td></td><td></td><td></td><td></td><td class="s">    if ( exists $ENV{POE_USE_SIGNAL_PIPE} ) {</td></tr>
<tr><td class="h"><a name="139"></a>139</td><td></td><td></td><td></td><td></td><td class="s">      $use_signal_pipe = $ENV{POE_USE_SIGNAL_PIPE};</td></tr>
<tr><td class="h"><a name="140"></a>140</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="141"></a>141</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="142"></a>142</td><td></td><td></td><td class="c3">1</td><td class="c3">600ns</td><td class="s">    if (RUNNING_IN_HELL) {<div class="calls"><div class="calls_out">    # spent   600ns making 1 call to <a href="POE-Kernel-pm-54-sub.html#92">POE::Kernel::__ANON__[POE/Kernel.pm:92]</a></div></div></td></tr>
<tr><td class="h"><a name="143"></a>143</td><td></td><td></td><td></td><td></td><td class="s">      if ($use_signal_pipe) {</td></tr>
<tr><td class="h"><a name="144"></a>144</td><td></td><td></td><td></td><td></td><td class="s">        _warn(</td></tr>
<tr><td class="h"><a name="145"></a>145</td><td></td><td></td><td></td><td></td><td class="s">          &quot;Sorry, disabling USE_SIGNAL_PIPE on $^O.\n&quot;,</td></tr>
<tr><td class="h"><a name="146"></a>146</td><td></td><td></td><td></td><td></td><td class="s">          &quot;Programs are reported to hang when it's enabled.\n&quot;,</td></tr>
<tr><td class="h"><a name="147"></a>147</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="148"></a>148</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="149"></a>149</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="150"></a>150</td><td></td><td></td><td></td><td></td><td class="s">      # Must be defined to supersede the default.</td></tr>
<tr><td class="h"><a name="151"></a>151</td><td></td><td></td><td></td><td></td><td class="s">      $use_signal_pipe = 0;</td></tr>
<tr><td class="h"><a name="152"></a>152</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="153"></a>153</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="154"></a>154</td><td></td><td></td><td></td><td></td><td class="s">    if ($use_signal_pipe or not defined $use_signal_pipe) {</td></tr>
<tr><td class="h"><a name="155"></a>155</td><td></td><td></td><td></td><td></td><td class="s">      *USE_SIGNAL_PIPE = sub () { 1 };</td></tr>
<tr><td class="h"><a name="156"></a>156</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="157"></a>157</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="158"></a>158</td><td></td><td></td><td></td><td></td><td class="s">      *USE_SIGNAL_PIPE = sub () { 0 };</td></tr>
<tr><td class="h"><a name="159"></a>159</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="160"></a>160</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="161"></a>161</td><td class="c3">1</td><td class="c3"><span title="Avg 35Âµs">35Âµs</span></td><td class="c3">1</td><td class="c3">16Âµs</td><td class="s">}<div class="calls"><div class="calls_out"># spent    16Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#97">POE::Kernel::BEGIN@97</a></div></div></td></tr>
<tr><td class="h"><a name="162"></a>162</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="163"></a>163</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="164"></a>164</td><td></td><td></td><td></td><td></td><td class="s"># Globals, or at least package-scoped things.  Data structures were</td></tr>
<tr><td class="h"><a name="165"></a>165</td><td></td><td></td><td></td><td></td><td class="s"># moved into lexicals in 0.1201.</td></tr>
<tr><td class="h"><a name="166"></a>166</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="167"></a>167</td><td></td><td></td><td></td><td></td><td class="s"># A reference to the currently active session.  Used throughout the</td></tr>
<tr><td class="h"><a name="168"></a>168</td><td></td><td></td><td></td><td></td><td class="s"># functions that act on the current session.</td></tr>
<tr><td class="h"><a name="169"></a>169</td><td class="c3">1</td><td class="c3"><span title="Avg 100ns">100ns</span></td><td></td><td></td><td class="s">my $kr_active_session;</td></tr>
<tr><td class="h"><a name="170"></a>170</td><td class="c3">1</td><td class="c3"><span title="Avg 100ns">100ns</span></td><td></td><td></td><td class="s">my $kr_active_event;</td></tr>
<tr><td class="h"><a name="171"></a>171</td><td class="c3">1</td><td class="c3"><span title="Avg 100ns">100ns</span></td><td></td><td></td><td class="s">my $kr_active_event_type;</td></tr>
<tr><td class="h"><a name="172"></a>172</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="173"></a>173</td><td></td><td></td><td></td><td></td><td class="s"># Needs to be lexical so that POE::Resource::Events can see it</td></tr>
<tr><td class="h"><a name="174"></a>174</td><td></td><td></td><td></td><td></td><td class="s"># change.  TODO - Something better?  Maybe we call a method in</td></tr>
<tr><td class="h"><a name="175"></a>175</td><td></td><td></td><td></td><td></td><td class="s"># POE::Resource::Events to trigger the exception there?</td></tr>
<tr><td class="h"><a name="176"></a>176</td><td class="c3">2</td><td class="c0"><span title="Avg 245Âµs">490Âµs</span></td><td class="c3">2</td><td class="c3">35Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 20Âµs (5+15) within POE::Kernel::BEGIN@176 which was called:
#    once (5Âµs+15Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#176">line 176</a></div></div>use vars qw($kr_exception);<div class="calls"><div class="calls_out"># spent    20Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#176">POE::Kernel::BEGIN@176</a>
# spent    15Âµs making 1 call to <a href="vars-pm-9-sub.html#10">vars::import</a></div></div></td></tr>
<tr><td class="h"><a name="177"></a>177</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="178"></a>178</td><td></td><td></td><td></td><td></td><td class="s"># The Kernel's master queue.</td></tr>
<tr><td class="h"><a name="179"></a>179</td><td class="c3">1</td><td class="c3"><span title="Avg 100ns">100ns</span></td><td></td><td></td><td class="s">my $kr_queue;</td></tr>
<tr><td class="h"><a name="180"></a>180</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="181"></a>181</td><td></td><td></td><td></td><td></td><td class="s"># The current PID, to detect when it changes</td></tr>
<tr><td class="h"><a name="182"></a>182</td><td class="c3">1</td><td class="c3"><span title="Avg 100ns">100ns</span></td><td></td><td></td><td class="s">my $kr_pid;</td></tr>
<tr><td class="h"><a name="183"></a>183</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="184"></a>184</td><td></td><td></td><td></td><td></td><td class="s"># Filehandle activity modes.  They are often used as list indexes.</td></tr>
<tr><td class="h"><a name="185"></a>185</td><td></td><td></td><td></td><td></td><td class="s">sub MODE_RD () { 0 }  # read</td></tr>
<tr><td class="h"><a name="186"></a>186</td><td></td><td></td><td></td><td></td><td class="s">sub MODE_WR () { 1 }  # write</td></tr>
<tr><td class="h"><a name="187"></a>187</td><td></td><td></td><td></td><td></td><td class="s">sub MODE_EX () { 2 }  # exception/expedite</td></tr>
<tr><td class="h"><a name="188"></a>188</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="189"></a>189</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="190"></a>190</td><td></td><td></td><td></td><td></td><td class="s"># Kernel structure.  This is the root of a large data tree.  Dumping</td></tr>
<tr><td class="h"><a name="191"></a>191</td><td></td><td></td><td></td><td></td><td class="s"># $poe_kernel with Data::Dumper or something will show most of the</td></tr>
<tr><td class="h"><a name="192"></a>192</td><td></td><td></td><td></td><td></td><td class="s"># data that POE keeps track of.  The exceptions to this are private</td></tr>
<tr><td class="h"><a name="193"></a>193</td><td></td><td></td><td></td><td></td><td class="s"># storage in some of the leaf objects, such as POE::Wheel.  All its</td></tr>
<tr><td class="h"><a name="194"></a>194</td><td></td><td></td><td></td><td></td><td class="s"># members are described in detail further on.</td></tr>
<tr><td class="h"><a name="195"></a>195</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="196"></a>196</td><td class="c3">1</td><td class="c3"><span title="Avg 200ns">200ns</span></td><td></td><td></td><td class="s">my $kr_id_seq = 0;</td></tr>
<tr><td class="h"><a name="197"></a>197</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="198"></a>198</td><td></td><td></td><td></td><td></td><td class="s">sub KR_SESSIONS          () {  0 } # [ \%kr_sessions,</td></tr>
<tr><td class="h"><a name="199"></a>199</td><td></td><td></td><td></td><td></td><td class="s">sub KR_FILENOS           () {  1 } #   \%kr_filenos,</td></tr>
<tr><td class="h"><a name="200"></a>200</td><td></td><td></td><td></td><td></td><td class="s">sub KR_SIGNALS           () {  2 } #   \%kr_signals,</td></tr>
<tr><td class="h"><a name="201"></a>201</td><td></td><td></td><td></td><td></td><td class="s">sub KR_ALIASES           () {  3 } #   \%kr_aliases,</td></tr>
<tr><td class="h"><a name="202"></a>202</td><td></td><td></td><td></td><td></td><td class="s">sub KR_ACTIVE_SESSION    () {  4 } #   \$kr_active_session,</td></tr>
<tr><td class="h"><a name="203"></a>203</td><td></td><td></td><td></td><td></td><td class="s">sub KR_QUEUE             () {  5 } #   \$kr_queue,</td></tr>
<tr><td class="h"><a name="204"></a>204</td><td></td><td></td><td></td><td></td><td class="s">sub KR_ID                () {  6 } #   $unique_kernel_id,</td></tr>
<tr><td class="h"><a name="205"></a>205</td><td></td><td></td><td></td><td></td><td class="s">sub KR_SESSION_IDS       () {  7 } #   \%kr_session_ids,</td></tr>
<tr><td class="h"><a name="206"></a>206</td><td></td><td></td><td></td><td></td><td class="s">sub KR_SID_SEQ           () {  8 } #   \$kr_sid_seq,</td></tr>
<tr><td class="h"><a name="207"></a>207</td><td></td><td></td><td></td><td></td><td class="s">sub KR_EXTRA_REFS        () {  9 } #   \$kr_extra_refs,</td></tr>
<tr><td class="h"><a name="208"></a>208</td><td></td><td></td><td></td><td></td><td class="s">sub KR_SIZE              () { 10 } #   XXX UNUSED ???</td></tr>
<tr><td class="h"><a name="209"></a>209</td><td></td><td></td><td></td><td></td><td class="s">sub KR_RUN               () { 11 } #   \$kr_run_warning</td></tr>
<tr><td class="h"><a name="210"></a>210</td><td></td><td></td><td></td><td></td><td class="s">sub KR_ACTIVE_EVENT      () { 12 } #   \$kr_active_event</td></tr>
<tr><td class="h"><a name="211"></a>211</td><td></td><td></td><td></td><td></td><td class="s">sub KR_PIDS              () { 13 } #   \%kr_pids_to_events</td></tr>
<tr><td class="h"><a name="212"></a>212</td><td></td><td></td><td></td><td></td><td class="s">sub KR_ACTIVE_EVENT_TYPE () { 14 } #   \$kr_active_event_type</td></tr>
<tr><td class="h"><a name="213"></a>213</td><td></td><td></td><td></td><td></td><td class="s">                                   # ]</td></tr>
<tr><td class="h"><a name="214"></a>214</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="215"></a>215</td><td></td><td></td><td></td><td></td><td class="s"># This flag indicates that POE::Kernel's run() method was called.</td></tr>
<tr><td class="h"><a name="216"></a>216</td><td></td><td></td><td></td><td></td><td class="s"># It's used to warn about forgetting $poe_kernel-&gt;run().</td></tr>
<tr><td class="h"><a name="217"></a>217</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="218"></a>218</td><td></td><td></td><td></td><td></td><td class="s">sub KR_RUN_CALLED  () { 0x01 }  # $kernel-&gt;run() called</td></tr>
<tr><td class="h"><a name="219"></a>219</td><td></td><td></td><td></td><td></td><td class="s">sub KR_RUN_SESSION () { 0x02 }  # sessions created</td></tr>
<tr><td class="h"><a name="220"></a>220</td><td></td><td></td><td></td><td></td><td class="s">sub KR_RUN_DONE    () { 0x04 }  # run returned</td></tr>
<tr><td class="h"><a name="221"></a>221</td><td class="c3">1</td><td class="c3"><span title="Avg 200ns">200ns</span></td><td></td><td></td><td class="s">my $kr_run_warning = 0;</td></tr>
<tr><td class="h"><a name="222"></a>222</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="223"></a>223</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="224"></a>224</td><td></td><td></td><td></td><td></td><td class="s"># Events themselves.</td></tr>
<tr><td class="h"><a name="225"></a>225</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="226"></a>226</td><td></td><td></td><td></td><td></td><td class="s">sub EV_SESSION    () { 0 }  # [ $destination_session,</td></tr>
<tr><td class="h"><a name="227"></a>227</td><td></td><td></td><td></td><td></td><td class="s">sub EV_SOURCE     () { 1 }  #   $sender_session,</td></tr>
<tr><td class="h"><a name="228"></a>228</td><td></td><td></td><td></td><td></td><td class="s">sub EV_NAME       () { 2 }  #   $event_name,</td></tr>
<tr><td class="h"><a name="229"></a>229</td><td></td><td></td><td></td><td></td><td class="s">sub EV_TYPE       () { 3 }  #   $event_type,</td></tr>
<tr><td class="h"><a name="230"></a>230</td><td></td><td></td><td></td><td></td><td class="s">sub EV_ARGS       () { 4 }  #   \@event_parameters_arg0_etc,</td></tr>
<tr><td class="h"><a name="231"></a>231</td><td></td><td></td><td></td><td></td><td class="s">                            #</td></tr>
<tr><td class="h"><a name="232"></a>232</td><td></td><td></td><td></td><td></td><td class="s">                            #   (These fields go towards the end</td></tr>
<tr><td class="h"><a name="233"></a>233</td><td></td><td></td><td></td><td></td><td class="s">                            #   because they are optional in some</td></tr>
<tr><td class="h"><a name="234"></a>234</td><td></td><td></td><td></td><td></td><td class="s">                            #   cases.  TODO: Is this still true?)</td></tr>
<tr><td class="h"><a name="235"></a>235</td><td></td><td></td><td></td><td></td><td class="s">                            #</td></tr>
<tr><td class="h"><a name="236"></a>236</td><td></td><td></td><td></td><td></td><td class="s">sub EV_OWNER_FILE () { 5 }  #   $caller_filename_where_enqueued,</td></tr>
<tr><td class="h"><a name="237"></a>237</td><td></td><td></td><td></td><td></td><td class="s">sub EV_OWNER_LINE () { 6 }  #   $caller_line_where_enqueued,</td></tr>
<tr><td class="h"><a name="238"></a>238</td><td></td><td></td><td></td><td></td><td class="s">sub EV_FROMSTATE  () { 7 }  #   $fromstate</td></tr>
<tr><td class="h"><a name="239"></a>239</td><td></td><td></td><td></td><td></td><td class="s">sub EV_SEQ        () { 8 }  #   Maintained by POE::Queue (unique event ID)</td></tr>
<tr><td class="h"><a name="240"></a>240</td><td></td><td></td><td></td><td></td><td class="s">sub EV_WALLTIME   () { 9 }  #   Walltime when event was created (for alarms)</td></tr>
<tr><td class="h"><a name="241"></a>241</td><td></td><td></td><td></td><td></td><td class="s">sub EV_DELTA      () { 10 } #   Seconds past walltime for event (for alarms)</td></tr>
<tr><td class="h"><a name="242"></a>242</td><td></td><td></td><td></td><td></td><td class="s">                            # ]</td></tr>
<tr><td class="h"><a name="243"></a>243</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="244"></a>244</td><td></td><td></td><td></td><td></td><td class="s"># These are the names of POE's internal events.  They're in constants</td></tr>
<tr><td class="h"><a name="245"></a>245</td><td></td><td></td><td></td><td></td><td class="s"># so we don't mistype them again.</td></tr>
<tr><td class="h"><a name="246"></a>246</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="247"></a>247</td><td></td><td></td><td></td><td></td><td class="s">sub EN_CHILD  () { '_child'           }</td></tr>
<tr><td class="h"><a name="248"></a>248</td><td></td><td></td><td></td><td></td><td class="s">sub EN_GC     () { '_garbage_collect' }</td></tr>
<tr><td class="h"><a name="249"></a>249</td><td></td><td></td><td></td><td></td><td class="s">sub EN_PARENT () { '_parent'          }</td></tr>
<tr><td class="h"><a name="250"></a>250</td><td></td><td></td><td></td><td></td><td class="s">sub EN_SCPOLL () { '_sigchld_poll'    }</td></tr>
<tr><td class="h"><a name="251"></a>251</td><td></td><td></td><td></td><td></td><td class="s">sub EN_SIGNAL () { '_signal'          }</td></tr>
<tr><td class="h"><a name="252"></a>252</td><td></td><td></td><td></td><td></td><td class="s">sub EN_START  () { '_start'           }</td></tr>
<tr><td class="h"><a name="253"></a>253</td><td></td><td></td><td></td><td></td><td class="s">sub EN_STOP   () { '_stop'            }</td></tr>
<tr><td class="h"><a name="254"></a>254</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="255"></a>255</td><td></td><td></td><td></td><td></td><td class="s"># These are POE's event classes (types).  They often shadow the event</td></tr>
<tr><td class="h"><a name="256"></a>256</td><td></td><td></td><td></td><td></td><td class="s"># names themselves, but they can encompass a large group of events.</td></tr>
<tr><td class="h"><a name="257"></a>257</td><td></td><td></td><td></td><td></td><td class="s"># For example, ET_ALARM describes anything enqueued as by an alarm</td></tr>
<tr><td class="h"><a name="258"></a>258</td><td></td><td></td><td></td><td></td><td class="s"># call.  Types are preferred over names because bitmask tests are</td></tr>
<tr><td class="h"><a name="259"></a>259</td><td></td><td></td><td></td><td></td><td class="s"># faster than string equality tests.</td></tr>
<tr><td class="h"><a name="260"></a>260</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="261"></a>261</td><td></td><td></td><td></td><td></td><td class="s">sub ET_POST   () { 0x0001 }  # User events (posted, yielded).</td></tr>
<tr><td class="h"><a name="262"></a>262</td><td></td><td></td><td></td><td></td><td class="s">sub ET_CALL   () { 0x0002 }  # User events that weren't enqueued.</td></tr>
<tr><td class="h"><a name="263"></a>263</td><td></td><td></td><td></td><td></td><td class="s">sub ET_START  () { 0x0004 }  # _start</td></tr>
<tr><td class="h"><a name="264"></a>264</td><td></td><td></td><td></td><td></td><td class="s">sub ET_STOP   () { 0x0008 }  # _stop</td></tr>
<tr><td class="h"><a name="265"></a>265</td><td></td><td></td><td></td><td></td><td class="s">sub ET_SIGNAL () { 0x0010 }  # _signal</td></tr>
<tr><td class="h"><a name="266"></a>266</td><td></td><td></td><td></td><td></td><td class="s">sub ET_GC     () { 0x0020 }  # _garbage_collect</td></tr>
<tr><td class="h"><a name="267"></a>267</td><td></td><td></td><td></td><td></td><td class="s">sub ET_PARENT () { 0x0040 }  # _parent</td></tr>
<tr><td class="h"><a name="268"></a>268</td><td></td><td></td><td></td><td></td><td class="s">sub ET_CHILD  () { 0x0080 }  # _child</td></tr>
<tr><td class="h"><a name="269"></a>269</td><td></td><td></td><td></td><td></td><td class="s">sub ET_SCPOLL () { 0x0100 }  # _sigchild_poll</td></tr>
<tr><td class="h"><a name="270"></a>270</td><td></td><td></td><td></td><td></td><td class="s">sub ET_ALARM  () { 0x0200 }  # Alarm events.</td></tr>
<tr><td class="h"><a name="271"></a>271</td><td></td><td></td><td></td><td></td><td class="s">sub ET_SELECT () { 0x0400 }  # File activity events.</td></tr>
<tr><td class="h"><a name="272"></a>272</td><td></td><td></td><td></td><td></td><td class="s">sub ET_SIGCLD () { 0x0800 }  # sig_child() events.</td></tr>
<tr><td class="h"><a name="273"></a>273</td><td></td><td></td><td></td><td></td><td class="s">sub ET_SIGDIE () { 0x1000 }  # SIGDIE exception events.</td></tr>
<tr><td class="h"><a name="274"></a>274</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="275"></a>275</td><td></td><td></td><td></td><td></td><td class="s"># A mask for all events generated by/for users.</td></tr>
<tr><td class="h"><a name="276"></a>276</td><td></td><td></td><td></td><td></td><td class="s">sub ET_MASK_USER () { ~(ET_GC | ET_SCPOLL) }</td></tr>
<tr><td class="h"><a name="277"></a>277</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="278"></a>278</td><td></td><td></td><td></td><td></td><td class="s"># A mask for all events that are delayed by a dispatch time.</td></tr>
<tr><td class="h"><a name="279"></a>279</td><td></td><td></td><td></td><td></td><td class="s">sub ET_MASK_DELAYED () { ET_ALARM | ET_SCPOLL }</td></tr>
<tr><td class="h"><a name="280"></a>280</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="281"></a>281</td><td></td><td></td><td></td><td></td><td class="s"># Temporary signal subtypes, used during signal dispatch semantics</td></tr>
<tr><td class="h"><a name="282"></a>282</td><td></td><td></td><td></td><td></td><td class="s"># deprecation and reformation.</td></tr>
<tr><td class="h"><a name="283"></a>283</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="284"></a>284</td><td></td><td></td><td></td><td></td><td class="s">sub ET_SIGNAL_RECURSIVE () { 0x2000 }  # Explicitly requested signal.</td></tr>
<tr><td class="h"><a name="285"></a>285</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="286"></a>286</td><td></td><td></td><td></td><td></td><td class="s"># A hash of reserved names.  It's used to test whether someone is</td></tr>
<tr><td class="h"><a name="287"></a>287</td><td></td><td></td><td></td><td></td><td class="s"># trying to use an internal event directly.</td></tr>
<tr><td class="h"><a name="288"></a>288</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="289"></a>289</td><td class="c3">1</td><td class="c3"><span title="Avg 10Âµs">10Âµs</span></td><td></td><td></td><td class="s">my %poes_own_events = (</td></tr>
<tr><td class="h"><a name="290"></a>290</td><td></td><td></td><td></td><td></td><td class="s">  +EN_CHILD  =&gt; 1,</td></tr>
<tr><td class="h"><a name="291"></a>291</td><td></td><td></td><td></td><td></td><td class="s">  +EN_GC     =&gt; 1,</td></tr>
<tr><td class="h"><a name="292"></a>292</td><td></td><td></td><td></td><td></td><td class="s">  +EN_PARENT =&gt; 1,</td></tr>
<tr><td class="h"><a name="293"></a>293</td><td></td><td></td><td></td><td></td><td class="s">  +EN_SCPOLL =&gt; 1,</td></tr>
<tr><td class="h"><a name="294"></a>294</td><td></td><td></td><td></td><td></td><td class="s">  +EN_SIGNAL =&gt; 1,</td></tr>
<tr><td class="h"><a name="295"></a>295</td><td></td><td></td><td></td><td></td><td class="s">  +EN_START  =&gt; 1,</td></tr>
<tr><td class="h"><a name="296"></a>296</td><td></td><td></td><td></td><td></td><td class="s">  +EN_STOP   =&gt; 1,</td></tr>
<tr><td class="h"><a name="297"></a>297</td><td></td><td></td><td></td><td></td><td class="s">  +EN_STAT   =&gt; 1,</td></tr>
<tr><td class="h"><a name="298"></a>298</td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h"><a name="299"></a>299</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="300"></a>300</td><td></td><td></td><td></td><td></td><td class="s"># These are ways a child may come or go.</td></tr>
<tr><td class="h"><a name="301"></a>301</td><td></td><td></td><td></td><td></td><td class="s"># TODO - It would be useful to split 'lose' into two types.  One to</td></tr>
<tr><td class="h"><a name="302"></a>302</td><td></td><td></td><td></td><td></td><td class="s"># indicate that the child has stopped, and one to indicate that it was</td></tr>
<tr><td class="h"><a name="303"></a>303</td><td></td><td></td><td></td><td></td><td class="s"># given away.</td></tr>
<tr><td class="h"><a name="304"></a>304</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="305"></a>305</td><td></td><td></td><td></td><td></td><td class="s">sub CHILD_GAIN   () { 'gain'   }  # The session was inherited from another.</td></tr>
<tr><td class="h"><a name="306"></a>306</td><td></td><td></td><td></td><td></td><td class="s">sub CHILD_LOSE   () { 'lose'   }  # The session is no longer this one's child.</td></tr>
<tr><td class="h"><a name="307"></a>307</td><td></td><td></td><td></td><td></td><td class="s">sub CHILD_CREATE () { 'create' }  # The session was created as a child of this.</td></tr>
<tr><td class="h"><a name="308"></a>308</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="309"></a>309</td><td></td><td></td><td></td><td></td><td class="s"># Argument offsets for different types of internally generated events.</td></tr>
<tr><td class="h"><a name="310"></a>310</td><td></td><td></td><td></td><td></td><td class="s"># TODO Exporting (EXPORT_OK) these would let people stop depending on</td></tr>
<tr><td class="h"><a name="311"></a>311</td><td></td><td></td><td></td><td></td><td class="s"># positions for them.</td></tr>
<tr><td class="h"><a name="312"></a>312</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="313"></a>313</td><td></td><td></td><td></td><td></td><td class="s">sub EA_SEL_HANDLE () { 0 }</td></tr>
<tr><td class="h"><a name="314"></a>314</td><td></td><td></td><td></td><td></td><td class="s">sub EA_SEL_MODE   () { 1 }</td></tr>
<tr><td class="h"><a name="315"></a>315</td><td></td><td></td><td></td><td></td><td class="s">sub EA_SEL_ARGS   () { 2 }</td></tr>
<tr><td class="h"><a name="316"></a>316</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="317"></a>317</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="318"></a>318</td><td></td><td></td><td></td><td></td><td class="s"># Debugging and configuration constants.</td></tr>
<tr><td class="h"><a name="319"></a>319</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="320"></a>320</td><td></td><td></td><td></td><td></td><td class="s"># Shorthand for defining a trace constant.</td></tr>
<tr><td class="h"><a name="321"></a>321</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 59Âµs (56+3) within POE::Kernel::_define_trace which was called:
#    once (56Âµs+3Âµs) by POE::Kernel::BEGIN@338 at <a href="POE-Kernel-pm-54-sub.html#387">line 387</a></div></div>sub _define_trace {</td></tr>
<tr><td class="h"><a name="322"></a>322</td><td class="c3">2</td><td class="c3"><span title="Avg 43Âµs">87Âµs</span></td><td class="c3">2</td><td class="c3">20Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 12Âµs (6+7) within POE::Kernel::BEGIN@322 which was called:
#    once (6Âµs+7Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#322">line 322</a></div></div>  no strict 'refs';<div class="calls"><div class="calls_out">  # spent    12Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#322">POE::Kernel::BEGIN@322</a>
  # spent     7Âµs making 1 call to <a href="strict-pm-2-sub.html#47">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="323"></a>323</td><td class="c0">33</td><td class="c3"><span title="Avg 2Âµs">61Âµs</span></td><td></td><td></td><td class="s">  foreach my $name (@_) {</td></tr>
<tr><td class="h"><a name="324"></a>324</td><td></td><td></td><td></td><td></td><td class="s">    next if defined *{&quot;TRACE_$name&quot;}{CODE};</td></tr>
<tr><td class="h"><a name="325"></a>325</td><td></td><td></td><td class="c0">8</td><td class="c3">3Âµs</td><td class="s">    my $trace_value = &amp;TRACE_DEFAULT;<div class="calls"><div class="calls_out">    # spent     3Âµs making 8 calls to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel____ANON__">POE::Kernel::__ANON__</a>, avg 412ns/call</div></div></td></tr>
<tr><td class="h"><a name="326"></a>326</td><td></td><td></td><td></td><td></td><td class="s">    my $trace_name  = &quot;TRACE_$name&quot;;</td></tr>
<tr><td class="h"><a name="327"></a>327</td><td></td><td></td><td></td><td></td><td class="s">    *$trace_name = sub () { $trace_value };</td></tr>
<tr><td class="h"><a name="328"></a>328</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="329"></a>329</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="330"></a>330</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="331"></a>331</td><td></td><td></td><td></td><td></td><td class="s"># Debugging flags for subsystems.  They're done as double evals here</td></tr>
<tr><td class="h"><a name="332"></a>332</td><td></td><td></td><td></td><td></td><td class="s"># so that someone may define them before using POE::Kernel (or POE),</td></tr>
<tr><td class="h"><a name="333"></a>333</td><td></td><td></td><td></td><td></td><td class="s"># and the pre-defined value will take precedence over the defaults</td></tr>
<tr><td class="h"><a name="334"></a>334</td><td></td><td></td><td></td><td></td><td class="s"># here.</td></tr>
<tr><td class="h"><a name="335"></a>335</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="336"></a>336</td><td class="c3">1</td><td class="c3"><span title="Avg 100ns">100ns</span></td><td></td><td></td><td class="s">my $trace_file_handle;</td></tr>
<tr><td class="h"><a name="337"></a>337</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="338"></a>338</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 227Âµs (121+106) within POE::Kernel::BEGIN@338 which was called:
#    once (121Âµs+106Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#397">line 397</a></div></div>BEGIN {</td></tr>
<tr><td class="h"><a name="339"></a>339</td><td></td><td></td><td></td><td></td><td class="s">  # Shorthand for defining an assert constant.</td></tr>
<tr><td class="h"><a name="340"></a>340</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 35Âµs (33+2) within POE::Kernel::_define_assert which was called:
#    once (33Âµs+2Âµs) by POE::Kernel::BEGIN@338 at <a href="POE-Kernel-pm-54-sub.html#396">line 396</a></div></div>  sub _define_assert {</td></tr>
<tr><td class="h"><a name="341"></a>341</td><td class="c3">2</td><td class="c1"><span title="Avg 59Âµs">119Âµs</span></td><td class="c3">2</td><td class="c3">21Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 14Âµs (7+7) within POE::Kernel::BEGIN@341 which was called:
#    once (7Âµs+7Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#341">line 341</a></div></div>    no strict 'refs';<div class="calls"><div class="calls_out">    # spent    14Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#341">POE::Kernel::BEGIN@341</a>
    # spent     7Âµs making 1 call to <a href="strict-pm-2-sub.html#47">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="342"></a>342</td><td class="c0">21</td><td class="c3"><span title="Avg 2Âµs">36Âµs</span></td><td></td><td></td><td class="s">    foreach my $name (@_) {</td></tr>
<tr><td class="h"><a name="343"></a>343</td><td></td><td></td><td></td><td></td><td class="s">      next if defined *{&quot;ASSERT_$name&quot;}{CODE};</td></tr>
<tr><td class="h"><a name="344"></a>344</td><td></td><td></td><td class="c0">5</td><td class="c3">2Âµs</td><td class="s">      my $assert_value = &amp;ASSERT_DEFAULT;<div class="calls"><div class="calls_out">      # spent     2Âµs making 5 calls to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel____ANON__">POE::Kernel::__ANON__</a>, avg 400ns/call</div></div></td></tr>
<tr><td class="h"><a name="345"></a>345</td><td></td><td></td><td></td><td></td><td class="s">      my $assert_name  = &quot;ASSERT_$name&quot;;</td></tr>
<tr><td class="h"><a name="346"></a>346</td><td></td><td></td><td></td><td></td><td class="s">      *$assert_name = sub () { $assert_value };</td></tr>
<tr><td class="h"><a name="347"></a>347</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="348"></a>348</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="349"></a>349</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="350"></a>350</td><td></td><td></td><td></td><td></td><td class="s">  # Assimilate POE_TRACE_* and POE_ASSERT_* environment variables.</td></tr>
<tr><td class="h"><a name="351"></a>351</td><td></td><td></td><td></td><td></td><td class="s">  # Environment variables override everything else.</td></tr>
<tr><td class="h"><a name="352"></a>352</td><td class="c0">63</td><td class="c1"><span title="Avg 2Âµs">129Âµs</span></td><td></td><td></td><td class="s">  while (my ($var, $val) = each %ENV) {</td></tr>
<tr><td class="h"><a name="353"></a>353</td><td></td><td></td><td class="c0">55</td><td class="c3">12Âµs</td><td class="s">    next unless $var =~ /^POE_([A-Z_]+)$/;<div class="calls"><div class="calls_out">    # spent    12Âµs making 55 calls to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_match">POE::Kernel::CORE:match</a>, avg 213ns/call</div></div></td></tr>
<tr><td class="h"><a name="354"></a>354</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="355"></a>355</td><td></td><td></td><td></td><td></td><td class="s">    my $const = $1;</td></tr>
<tr><td class="h"><a name="356"></a>356</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="357"></a>357</td><td class="c3">2</td><td class="c3"><span title="Avg 33Âµs">66Âµs</span></td><td class="c3">2</td><td class="c3">20Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 13Âµs (5+7) within POE::Kernel::BEGIN@357 which was called:
#    once (5Âµs+7Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#357">line 357</a></div></div>    next unless $const =~ /^(?:TRACE|ASSERT)_/ or do { no strict 'refs'; defined &amp;$const };<div class="calls"><div class="calls_out">    # spent    13Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#357">POE::Kernel::BEGIN@357</a>
    # spent     8Âµs making 1 call to <a href="strict-pm-2-sub.html#47">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="358"></a>358</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="359"></a>359</td><td></td><td></td><td></td><td></td><td class="s">    # Copy so we don't hurt our environment.</td></tr>
<tr><td class="h"><a name="360"></a>360</td><td></td><td></td><td></td><td></td><td class="s">    my $value = $val;</td></tr>
<tr><td class="h"><a name="361"></a>361</td><td></td><td></td><td></td><td></td><td class="s">    ($value) = ($value =~ /^([-\@\w.]+)$/); # Untaint per rt.cpan.org 81550</td></tr>
<tr><td class="h"><a name="362"></a>362</td><td></td><td></td><td></td><td></td><td class="s">    $value =~ tr['&quot;][]d;</td></tr>
<tr><td class="h"><a name="363"></a>363</td><td></td><td></td><td></td><td></td><td class="s">    $value = 0 + $value if $value =~ /^\s*-?\d+(?:\.\d+)?\s*$/;</td></tr>
<tr><td class="h"><a name="364"></a>364</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="365"></a>365</td><td class="c3">2</td><td class="c3"><span title="Avg 31Âµs">62Âµs</span></td><td class="c3">2</td><td class="c3">21Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 14Âµs (7+7) within POE::Kernel::BEGIN@365 which was called:
#    once (7Âµs+7Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#365">line 365</a></div></div>    no strict 'refs';<div class="calls"><div class="calls_out">    # spent    14Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#365">POE::Kernel::BEGIN@365</a>
    # spent     7Âµs making 1 call to <a href="strict-pm-2-sub.html#47">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="366"></a>366</td><td></td><td></td><td></td><td></td><td class="s">    local $^W = 0;</td></tr>
<tr><td class="h"><a name="367"></a>367</td><td></td><td></td><td></td><td></td><td class="s">    local $SIG{__WARN__} = sub { }; # redefine</td></tr>
<tr><td class="h"><a name="368"></a>368</td><td></td><td></td><td></td><td></td><td class="s">    *$const = sub () { $value };</td></tr>
<tr><td class="h"><a name="369"></a>369</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="370"></a>370</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="371"></a>371</td><td></td><td></td><td></td><td></td><td class="s">  # TRACE_FILENAME is special.</td></tr>
<tr><td class="h"><a name="372"></a>372</td><td></td><td></td><td></td><td></td><td class="s">  {</td></tr>
<tr><td class="h"><a name="373"></a>373</td><td class="c3">2</td><td class="c1"><span title="Avg 66Âµs">132Âµs</span></td><td class="c3">2</td><td class="c3">19Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 12Âµs (5+7) within POE::Kernel::BEGIN@373 which was called:
#    once (5Âµs+7Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#373">line 373</a></div></div>    no strict 'refs';<div class="calls"><div class="calls_out">    # spent    12Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#373">POE::Kernel::BEGIN@373</a>
    # spent     7Âµs making 1 call to <a href="strict-pm-2-sub.html#47">strict::unimport</a></div></div></td></tr>
<tr><td class="h"><a name="374"></a>374</td><td></td><td></td><td></td><td></td><td class="s">    my $trace_filename = TRACE_FILENAME() if defined &amp;TRACE_FILENAME;</td></tr>
<tr><td class="h"><a name="375"></a>375</td><td></td><td></td><td></td><td></td><td class="s">    if (defined $trace_filename) {</td></tr>
<tr><td class="h"><a name="376"></a>376</td><td></td><td></td><td></td><td></td><td class="s">      open $trace_file_handle, &quot;&gt;$trace_filename&quot;</td></tr>
<tr><td class="h"><a name="377"></a>377</td><td></td><td></td><td></td><td></td><td class="s">        or die &quot;can't open trace file `$trace_filename': $!&quot;;</td></tr>
<tr><td class="h"><a name="378"></a>378</td><td></td><td></td><td></td><td></td><td class="s">      CORE::select((CORE::select($trace_file_handle), $| = 1)[0]);</td></tr>
<tr><td class="h"><a name="379"></a>379</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="380"></a>380</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="381"></a>381</td><td></td><td></td><td></td><td></td><td class="s">  # TRACE_DEFAULT changes the default value for other TRACE_*</td></tr>
<tr><td class="h"><a name="382"></a>382</td><td></td><td></td><td></td><td></td><td class="s">  # constants.  Since define_trace() uses TRACE_DEFAULT internally, it</td></tr>
<tr><td class="h"><a name="383"></a>383</td><td></td><td></td><td></td><td></td><td class="s">  # can't be used to define TRACE_DEFAULT itself.</td></tr>
<tr><td class="h"><a name="384"></a>384</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="385"></a>385</td><td></td><td></td><td></td><td></td><td class="s">  defined &amp;TRACE_DEFAULT or *TRACE_DEFAULT = sub () { 0 };</td></tr>
<tr><td class="h"><a name="386"></a>386</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="387"></a>387</td><td></td><td></td><td class="c3">1</td><td class="c1">59Âµs</td><td class="s">  _define_trace qw(<div class="calls"><div class="calls_out">  # spent    59Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#321">POE::Kernel::_define_trace</a></div></div></td></tr>
<tr><td class="h"><a name="388"></a>388</td><td></td><td></td><td></td><td></td><td class="s">    EVENTS FILES PROFILE REFCNT RETVALS SESSIONS SIGNALS STATISTICS</td></tr>
<tr><td class="h"><a name="389"></a>389</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="390"></a>390</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="391"></a>391</td><td></td><td></td><td></td><td></td><td class="s">  # See the notes for TRACE_DEFAULT, except read ASSERT and assert</td></tr>
<tr><td class="h"><a name="392"></a>392</td><td></td><td></td><td></td><td></td><td class="s">  # where you see TRACE and trace.</td></tr>
<tr><td class="h"><a name="393"></a>393</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="394"></a>394</td><td></td><td></td><td></td><td></td><td class="s">  defined &amp;ASSERT_DEFAULT or *ASSERT_DEFAULT = sub () { 0 };</td></tr>
<tr><td class="h"><a name="395"></a>395</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="396"></a>396</td><td></td><td></td><td class="c3">1</td><td class="c3">35Âµs</td><td class="s">  _define_assert qw(DATA EVENTS FILES RETVALS USAGE);<div class="calls"><div class="calls_out">  # spent    35Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#340">POE::Kernel::_define_assert</a></div></div></td></tr>
<tr><td class="h"><a name="397"></a>397</td><td class="c3">1</td><td class="c0"><span title="Avg 745Âµs">745Âµs</span></td><td class="c3">1</td><td class="c0">227Âµs</td><td class="s">}<div class="calls"><div class="calls_out"># spent   227Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#338">POE::Kernel::BEGIN@338</a></div></div></td></tr>
<tr><td class="h"><a name="398"></a>398</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="399"></a>399</td><td></td><td></td><td></td><td></td><td class="s"># An &quot;idle&quot; POE::Kernel may still have events enqueued.  These events</td></tr>
<tr><td class="h"><a name="400"></a>400</td><td></td><td></td><td></td><td></td><td class="s"># regulate polling for signals, profiling, and perhaps other aspects of</td></tr>
<tr><td class="h"><a name="401"></a>401</td><td></td><td></td><td></td><td></td><td class="s"># POE::Kernel's internal workings.</td></tr>
<tr><td class="h"><a name="402"></a>402</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="403"></a>403</td><td></td><td></td><td></td><td></td><td class="s"># XXX - There must be a better mechanism.</td></tr>
<tr><td class="h"><a name="404"></a>404</td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h"><a name="405"></a>405</td><td class="c3">1</td><td class="c3"><span title="Avg 100ns">100ns</span></td><td></td><td></td><td class="s">my $idle_queue_size;</td></tr>
<tr><td class="h"><a name="406"></a>406</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="407"></a>407</td><td></td><td></td><td></td><td></td><td class="s">sub _idle_queue_grow   { $idle_queue_size++;   }</td></tr>
<tr><td class="h"><a name="408"></a>408</td><td></td><td></td><td></td><td></td><td class="s">sub _idle_queue_shrink { $idle_queue_size--;   }</td></tr>
<tr><td class="h"><a name="409"></a>409</td><td></td><td></td><td></td><td></td><td class="s">sub _idle_queue_size   { $idle_queue_size;     }</td></tr>
<tr><td class="h"><a name="410"></a>410</td><td class="c3">1</td><td class="c3"><span title="Avg 2Âµs">2Âµs</span></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1Âµs within POE::Kernel::_idle_queue_reset which was called:
#    once (1Âµs+0s) by POE::Kernel::new at <a href="POE-Kernel-pm-54-sub.html#854">line 854</a></div></div>sub _idle_queue_reset  { $idle_queue_size = 0; }</td></tr>
<tr><td class="h"><a name="411"></a>411</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="412"></a>412</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="413"></a>413</td><td></td><td></td><td></td><td></td><td class="s"># Helpers to carp, croak, confess, cluck, warn and die with whatever</td></tr>
<tr><td class="h"><a name="414"></a>414</td><td></td><td></td><td></td><td></td><td class="s"># trace file we're using today.  _trap is reserved for internal</td></tr>
<tr><td class="h"><a name="415"></a>415</td><td></td><td></td><td></td><td></td><td class="s"># errors.</td></tr>
<tr><td class="h"><a name="416"></a>416</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="417"></a>417</td><td></td><td></td><td></td><td></td><td class="s">sub _trap {</td></tr>
<tr><td class="h"><a name="418"></a>418</td><td></td><td></td><td></td><td></td><td class="s">  local $Carp::CarpLevel = $Carp::CarpLevel + 1;</td></tr>
<tr><td class="h"><a name="419"></a>419</td><td></td><td></td><td></td><td></td><td class="s">  local *STDERR = $trace_file_handle || *STDERR;</td></tr>
<tr><td class="h"><a name="420"></a>420</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="421"></a>421</td><td></td><td></td><td></td><td></td><td class="s">  confess(</td></tr>
<tr><td class="h"><a name="422"></a>422</td><td></td><td></td><td></td><td></td><td class="s">    &quot;=== $$ === Please address any warnings or errors above this message,\n&quot;,</td></tr>
<tr><td class="h"><a name="423"></a>423</td><td></td><td></td><td></td><td></td><td class="s">    &quot;=== $$ === and try again.  If there are no previous messages, or they\n&quot;,</td></tr>
<tr><td class="h"><a name="424"></a>424</td><td></td><td></td><td></td><td></td><td class="s">    &quot;=== $$ === are from within POE, then please mail them along with the\n&quot;,</td></tr>
<tr><td class="h"><a name="425"></a>425</td><td></td><td></td><td></td><td></td><td class="s">    &quot;=== $$ === following information to bug-POE\@rt.cpan.org:\n&quot;,</td></tr>
<tr><td class="h"><a name="426"></a>426</td><td></td><td></td><td></td><td></td><td class="s">    &quot;---\n@_\n-----\n&quot;</td></tr>
<tr><td class="h"><a name="427"></a>427</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="428"></a>428</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="429"></a>429</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="430"></a>430</td><td></td><td></td><td></td><td></td><td class="s">sub _croak {</td></tr>
<tr><td class="h"><a name="431"></a>431</td><td></td><td></td><td></td><td></td><td class="s">  local $Carp::CarpLevel = $Carp::CarpLevel + 1;</td></tr>
<tr><td class="h"><a name="432"></a>432</td><td></td><td></td><td></td><td></td><td class="s">  local *STDERR = $trace_file_handle || *STDERR;</td></tr>
<tr><td class="h"><a name="433"></a>433</td><td></td><td></td><td></td><td></td><td class="s">  my $message = join(&quot;&quot;, @_);</td></tr>
<tr><td class="h"><a name="434"></a>434</td><td></td><td></td><td></td><td></td><td class="s">  $message =~ s/^/=== $$ === /mg;</td></tr>
<tr><td class="h"><a name="435"></a>435</td><td></td><td></td><td></td><td></td><td class="s">  croak $message;</td></tr>
<tr><td class="h"><a name="436"></a>436</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="437"></a>437</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="438"></a>438</td><td></td><td></td><td></td><td></td><td class="s">sub _confess {</td></tr>
<tr><td class="h"><a name="439"></a>439</td><td></td><td></td><td></td><td></td><td class="s">  local $Carp::CarpLevel = $Carp::CarpLevel + 1;</td></tr>
<tr><td class="h"><a name="440"></a>440</td><td></td><td></td><td></td><td></td><td class="s">  local *STDERR = $trace_file_handle || *STDERR;</td></tr>
<tr><td class="h"><a name="441"></a>441</td><td></td><td></td><td></td><td></td><td class="s">  my $message = join(&quot;&quot;, @_);</td></tr>
<tr><td class="h"><a name="442"></a>442</td><td></td><td></td><td></td><td></td><td class="s">  $message =~ s/^/=== $$ === /mg;</td></tr>
<tr><td class="h"><a name="443"></a>443</td><td></td><td></td><td></td><td></td><td class="s">  confess $message;</td></tr>
<tr><td class="h"><a name="444"></a>444</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="445"></a>445</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="446"></a>446</td><td></td><td></td><td></td><td></td><td class="s">sub _cluck {</td></tr>
<tr><td class="h"><a name="447"></a>447</td><td></td><td></td><td></td><td></td><td class="s">  local $Carp::CarpLevel = $Carp::CarpLevel + 1;</td></tr>
<tr><td class="h"><a name="448"></a>448</td><td></td><td></td><td></td><td></td><td class="s">  local *STDERR = $trace_file_handle || *STDERR;</td></tr>
<tr><td class="h"><a name="449"></a>449</td><td></td><td></td><td></td><td></td><td class="s">  my $message = join(&quot;&quot;, @_);</td></tr>
<tr><td class="h"><a name="450"></a>450</td><td></td><td></td><td></td><td></td><td class="s">  $message =~ s/^/=== $$ === /mg;</td></tr>
<tr><td class="h"><a name="451"></a>451</td><td></td><td></td><td></td><td></td><td class="s">  cluck $message;</td></tr>
<tr><td class="h"><a name="452"></a>452</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="453"></a>453</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="454"></a>454</td><td></td><td></td><td></td><td></td><td class="s">sub _carp {</td></tr>
<tr><td class="h"><a name="455"></a>455</td><td></td><td></td><td></td><td></td><td class="s">  local $Carp::CarpLevel = $Carp::CarpLevel + 1;</td></tr>
<tr><td class="h"><a name="456"></a>456</td><td></td><td></td><td></td><td></td><td class="s">  local *STDERR = $trace_file_handle || *STDERR;</td></tr>
<tr><td class="h"><a name="457"></a>457</td><td></td><td></td><td></td><td></td><td class="s">  my $message = join(&quot;&quot;, @_);</td></tr>
<tr><td class="h"><a name="458"></a>458</td><td></td><td></td><td></td><td></td><td class="s">  $message =~ s/^/=== $$ === /mg;</td></tr>
<tr><td class="h"><a name="459"></a>459</td><td></td><td></td><td></td><td></td><td class="s">  carp $message;</td></tr>
<tr><td class="h"><a name="460"></a>460</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="461"></a>461</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="462"></a>462</td><td></td><td></td><td></td><td></td><td class="s">sub _warn {</td></tr>
<tr><td class="h"><a name="463"></a>463</td><td></td><td></td><td></td><td></td><td class="s">  my ($package, $file, $line) = caller();</td></tr>
<tr><td class="h"><a name="464"></a>464</td><td></td><td></td><td></td><td></td><td class="s">  my $message = join(&quot;&quot;, @_);</td></tr>
<tr><td class="h"><a name="465"></a>465</td><td></td><td></td><td></td><td></td><td class="s">  $message .= &quot; at $file line $line\n&quot; unless $message =~ /\n$/;</td></tr>
<tr><td class="h"><a name="466"></a>466</td><td></td><td></td><td></td><td></td><td class="s">  $message =~ s/^/=== $$ === /mg;</td></tr>
<tr><td class="h"><a name="467"></a>467</td><td></td><td></td><td></td><td></td><td class="s">  warn $message;</td></tr>
<tr><td class="h"><a name="468"></a>468</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="469"></a>469</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="470"></a>470</td><td></td><td></td><td></td><td></td><td class="s">sub _die {</td></tr>
<tr><td class="h"><a name="471"></a>471</td><td></td><td></td><td></td><td></td><td class="s">  my ($package, $file, $line) = caller();</td></tr>
<tr><td class="h"><a name="472"></a>472</td><td></td><td></td><td></td><td></td><td class="s">  my $message = join(&quot;&quot;, @_);</td></tr>
<tr><td class="h"><a name="473"></a>473</td><td></td><td></td><td></td><td></td><td class="s">  $message .= &quot; at $file line $line\n&quot; unless $message =~ /\n$/;</td></tr>
<tr><td class="h"><a name="474"></a>474</td><td></td><td></td><td></td><td></td><td class="s">  $message =~ s/^/=== $$ === /mg;</td></tr>
<tr><td class="h"><a name="475"></a>475</td><td></td><td></td><td></td><td></td><td class="s">  local *STDERR = $trace_file_handle || *STDERR;</td></tr>
<tr><td class="h"><a name="476"></a>476</td><td></td><td></td><td></td><td></td><td class="s">  die $message;</td></tr>
<tr><td class="h"><a name="477"></a>477</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="478"></a>478</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="479"></a>479</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="480"></a>480</td><td></td><td></td><td></td><td></td><td class="s"># Adapt POE::Kernel's personality to whichever event loop is present.</td></tr>
<tr><td class="h"><a name="481"></a>481</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="482"></a>482</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 2.46ms (1.46+1.01) within POE::Kernel::_find_loop which was called 91 times, avg 27Âµs/call:
# 45 times (733Âµs+495Âµs) by POE::Kernel::_test_loop at <a href="POE-Kernel-pm-54-sub.html#537">line 537</a>, avg 27Âµs/call
# 45 times (708Âµs+502Âµs) by POE::Kernel::_test_loop at <a href="POE-Kernel-pm-54-sub.html#539">line 539</a>, avg 27Âµs/call
#     once (15Âµs+11Âµs) by POE::Kernel::_test_loop at <a href="POE-Kernel-pm-54-sub.html#561">line 561</a></div></div>sub _find_loop {</td></tr>
<tr><td class="h"><a name="483"></a>483</td><td class="c0">1092</td><td class="c0"><span title="Avg 2Âµs">2.53ms</span></td><td></td><td></td><td class="s">  my ($mod) = @_;</td></tr>
<tr><td class="h"><a name="484"></a>484</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="485"></a>485</td><td></td><td></td><td></td><td></td><td class="s">  foreach my $dir (@INC) {</td></tr>
<tr><td class="h"><a name="486"></a>486</td><td></td><td></td><td class="c0">819</td><td class="c0">1.01ms</td><td class="s">    return 1 if (-r &quot;$dir/$mod&quot;);<div class="calls"><div class="calls_out">    # spent  1.01ms making 819 calls to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_fteread">POE::Kernel::CORE:fteread</a>, avg 1Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="487"></a>487</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="488"></a>488</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="489"></a>489</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="490"></a>490</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="491"></a>491</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.97ms (1.17+802Âµs) within POE::Kernel::_load_loop which was called:
#    once (1.17ms+802Âµs) by POE::Kernel::_test_loop at <a href="POE-Kernel-pm-54-sub.html#568">line 568</a></div></div>sub _load_loop {</td></tr>
<tr><td class="h"><a name="492"></a>492</td><td class="c3">4</td><td class="c3"><span title="Avg 6Âµs">22Âµs</span></td><td></td><td></td><td class="s">  my $loop = shift;</td></tr>
<tr><td class="h"><a name="493"></a>493</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="494"></a>494</td><td></td><td></td><td></td><td></td><td class="s">  *poe_kernel_loop = sub { return &quot;$loop&quot; };</td></tr>
<tr><td class="h"><a name="495"></a>495</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="496"></a>496</td><td></td><td></td><td></td><td></td><td class="s">  # Modules can die with &quot;not really dying&quot; if they've loaded</td></tr>
<tr><td class="h"><a name="497"></a>497</td><td></td><td></td><td></td><td></td><td class="s">  # something else.  This exception prevents the rest of the</td></tr>
<tr><td class="h"><a name="498"></a>498</td><td></td><td></td><td></td><td></td><td class="s">  # originally used module from being parsed, so the module it's</td></tr>
<tr><td class="h"><a name="499"></a>499</td><td></td><td></td><td></td><td></td><td class="s">  # handed off to takes over.</td></tr>
<tr><td class="h"><a name="500"></a>500</td><td></td><td></td><td></td><td></td><td class="s">  eval &quot;require $loop&quot;;<div class="calls"><div class="calls_out">  # spent    52Âµs executing statements in <a href="(eval 16)[POE-Kernel-pm-500]-58-line.html">string eval</a></div></div></td></tr>
<tr><td class="h"><a name="501"></a>501</td><td></td><td></td><td></td><td></td><td class="s">  if ($@ and $@ !~ /not really dying/) {</td></tr>
<tr><td class="h"><a name="502"></a>502</td><td></td><td></td><td></td><td></td><td class="s">    die(</td></tr>
<tr><td class="h"><a name="503"></a>503</td><td></td><td></td><td></td><td></td><td class="s">      &quot;*\n&quot;,</td></tr>
<tr><td class="h"><a name="504"></a>504</td><td></td><td></td><td></td><td></td><td class="s">      &quot;* POE can't use $loop:\n&quot;,</td></tr>
<tr><td class="h"><a name="505"></a>505</td><td></td><td></td><td></td><td></td><td class="s">      &quot;* $@\n&quot;,</td></tr>
<tr><td class="h"><a name="506"></a>506</td><td></td><td></td><td></td><td></td><td class="s">      &quot;*\n&quot;,</td></tr>
<tr><td class="h"><a name="507"></a>507</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="508"></a>508</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="509"></a>509</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="510"></a>510</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="511"></a>511</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 5.01ms (464Âµs+4.54) within POE::Kernel::_test_loop which was called:
#    once (464Âµs+4.54ms) by POE::Kernel::import at <a href="POE-Kernel-pm-54-sub.html#74">line 74</a></div></div>sub _test_loop {</td></tr>
<tr><td class="h"><a name="512"></a>512</td><td class="c0">416</td><td class="c0"><span title="Avg 1Âµs">431Âµs</span></td><td></td><td></td><td class="s">  my $used_first = shift;</td></tr>
<tr><td class="h"><a name="513"></a>513</td><td></td><td></td><td></td><td></td><td class="s">  local $SIG{__DIE__};</td></tr>
<tr><td class="h"><a name="514"></a>514</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="515"></a>515</td><td></td><td></td><td></td><td></td><td class="s">  # First see if someone wants to load a POE::Loop or XS version</td></tr>
<tr><td class="h"><a name="516"></a>516</td><td></td><td></td><td></td><td></td><td class="s">  # explicitly.</td></tr>
<tr><td class="h"><a name="517"></a>517</td><td></td><td></td><td></td><td></td><td class="s">  if (defined $used_first) {</td></tr>
<tr><td class="h"><a name="518"></a>518</td><td></td><td></td><td></td><td></td><td class="s">    _load_loop($used_first);</td></tr>
<tr><td class="h"><a name="519"></a>519</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="520"></a>520</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="521"></a>521</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="522"></a>522</td><td></td><td></td><td></td><td></td><td class="s">  foreach my $file (keys %INC) {</td></tr>
<tr><td class="h"><a name="523"></a>523</td><td></td><td></td><td></td><td></td><td class="s">    next if (substr ($file, -3) ne '.pm');</td></tr>
<tr><td class="h"><a name="524"></a>524</td><td></td><td></td><td class="c0">45</td><td class="c2">53Âµs</td><td class="s">    my @split_dirs = File::Spec-&gt;splitdir($file);<div class="calls"><div class="calls_out">    # spent    53Âµs making 45 calls to <a href="File-Spec-Unix-pm-19-sub.html#346">File::Spec::Unix::splitdir</a>, avg 1Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="525"></a>525</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="526"></a>526</td><td></td><td></td><td></td><td></td><td class="s">    # Create a module name by replacing the path separators with</td></tr>
<tr><td class="h"><a name="527"></a>527</td><td></td><td></td><td></td><td></td><td class="s">    # underscores and removing &quot;.pm&quot;</td></tr>
<tr><td class="h"><a name="528"></a>528</td><td></td><td></td><td></td><td></td><td class="s">    my $module = join(&quot;_&quot;, @split_dirs);</td></tr>
<tr><td class="h"><a name="529"></a>529</td><td></td><td></td><td></td><td></td><td class="s">    substr($module, -3) = &quot;&quot;;</td></tr>
<tr><td class="h"><a name="530"></a>530</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="531"></a>531</td><td></td><td></td><td></td><td></td><td class="s">    # Skip the module name if it isn't legal.</td></tr>
<tr><td class="h"><a name="532"></a>532</td><td></td><td></td><td class="c0">45</td><td class="c3">18Âµs</td><td class="s">    next if $module =~ /[^\w\.]/;<div class="calls"><div class="calls_out">    # spent    18Âµs making 45 calls to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_match">POE::Kernel::CORE:match</a>, avg 400ns/call</div></div></td></tr>
<tr><td class="h"><a name="533"></a>533</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="534"></a>534</td><td></td><td></td><td></td><td></td><td class="s">    # Try for the XS version first.  If it fails, try the plain</td></tr>
<tr><td class="h"><a name="535"></a>535</td><td></td><td></td><td></td><td></td><td class="s">    # version.  If that fails, we're up a creek.</td></tr>
<tr><td class="h"><a name="536"></a>536</td><td></td><td></td><td></td><td></td><td class="s">    $module = &quot;POE/XS/Loop/$module.pm&quot;;</td></tr>
<tr><td class="h"><a name="537"></a>537</td><td></td><td></td><td class="c0">45</td><td class="c0">1.23ms</td><td class="s">    unless (_find_loop($module)) {<div class="calls"><div class="calls_out">    # spent  1.23ms making 45 calls to <a href="POE-Kernel-pm-54-sub.html#482">POE::Kernel::_find_loop</a>, avg 27Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="538"></a>538</td><td></td><td></td><td class="c0">45</td><td class="c3">34Âµs</td><td class="s">      $module =~ s|XS/||;<div class="calls"><div class="calls_out">      # spent    34Âµs making 45 calls to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_subst">POE::Kernel::CORE:subst</a>, avg 753ns/call</div></div></td></tr>
<tr><td class="h"><a name="539"></a>539</td><td></td><td></td><td class="c0">45</td><td class="c0">1.21ms</td><td class="s">      next unless (_find_loop($module));<div class="calls"><div class="calls_out">      # spent  1.21ms making 45 calls to <a href="POE-Kernel-pm-54-sub.html#482">POE::Kernel::_find_loop</a>, avg 27Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="540"></a>540</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="541"></a>541</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="542"></a>542</td><td></td><td></td><td></td><td></td><td class="s">    if (defined $used_first and $used_first ne $module) {</td></tr>
<tr><td class="h"><a name="543"></a>543</td><td></td><td></td><td></td><td></td><td class="s">      die(</td></tr>
<tr><td class="h"><a name="544"></a>544</td><td></td><td></td><td></td><td></td><td class="s">        &quot;*\n&quot;,</td></tr>
<tr><td class="h"><a name="545"></a>545</td><td></td><td></td><td></td><td></td><td class="s">        &quot;* POE can't use multiple event loops at once.\n&quot;,</td></tr>
<tr><td class="h"><a name="546"></a>546</td><td></td><td></td><td></td><td></td><td class="s">        &quot;* You used $used_first and $module.\n&quot;,</td></tr>
<tr><td class="h"><a name="547"></a>547</td><td></td><td></td><td></td><td></td><td class="s">        &quot;* Specify the loop you want as an argument to POE\n&quot;,</td></tr>
<tr><td class="h"><a name="548"></a>548</td><td></td><td></td><td></td><td></td><td class="s">        &quot;*  use POE qw(Loop::Select);\n&quot;,</td></tr>
<tr><td class="h"><a name="549"></a>549</td><td></td><td></td><td></td><td></td><td class="s">        &quot;* or;\n&quot;,</td></tr>
<tr><td class="h"><a name="550"></a>550</td><td></td><td></td><td></td><td></td><td class="s">        &quot;*  use POE::Kernel { loop =&gt; 'Select' };\n&quot;,</td></tr>
<tr><td class="h"><a name="551"></a>551</td><td></td><td></td><td></td><td></td><td class="s">        &quot;*\n&quot;,</td></tr>
<tr><td class="h"><a name="552"></a>552</td><td></td><td></td><td></td><td></td><td class="s">      );</td></tr>
<tr><td class="h"><a name="553"></a>553</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="554"></a>554</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="555"></a>555</td><td></td><td></td><td></td><td></td><td class="s">    $used_first = $module;</td></tr>
<tr><td class="h"><a name="556"></a>556</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="557"></a>557</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="558"></a>558</td><td></td><td></td><td></td><td></td><td class="s">  # No loop found.  Default to our internal select() loop.</td></tr>
<tr><td class="h"><a name="559"></a>559</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $used_first) {</td></tr>
<tr><td class="h"><a name="560"></a>560</td><td></td><td></td><td></td><td></td><td class="s">    $used_first = &quot;POE/XS/Loop/Select.pm&quot;;</td></tr>
<tr><td class="h"><a name="561"></a>561</td><td></td><td></td><td class="c3">1</td><td class="c3">26Âµs</td><td class="s">    unless (_find_loop($used_first)) {<div class="calls"><div class="calls_out">    # spent    26Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#482">POE::Kernel::_find_loop</a></div></div></td></tr>
<tr><td class="h"><a name="562"></a>562</td><td></td><td></td><td class="c3">1</td><td class="c3">700ns</td><td class="s">      $used_first =~ s/XS\///;<div class="calls"><div class="calls_out">      # spent   700ns making 1 call to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_subst">POE::Kernel::CORE:subst</a></div></div></td></tr>
<tr><td class="h"><a name="563"></a>563</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="564"></a>564</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="565"></a>565</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="566"></a>566</td><td></td><td></td><td></td><td></td><td class="s">  substr($used_first, -3) = &quot;&quot;;</td></tr>
<tr><td class="h"><a name="567"></a>567</td><td></td><td></td><td class="c3">1</td><td class="c3">2Âµs</td><td class="s">  $used_first =~ s|/|::|g;<div class="calls"><div class="calls_out">  # spent     2Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_subst">POE::Kernel::CORE:subst</a></div></div></td></tr>
<tr><td class="h"><a name="568"></a>568</td><td></td><td></td><td class="c3">1</td><td class="c0">1.97ms</td><td class="s">  _load_loop($used_first);<div class="calls"><div class="calls_out">  # spent  1.97ms making 1 call to <a href="POE-Kernel-pm-54-sub.html#491">POE::Kernel::_load_loop</a></div></div></td></tr>
<tr><td class="h"><a name="569"></a>569</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="570"></a>570</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="571"></a>571</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="572"></a>572</td><td></td><td></td><td></td><td></td><td class="s"># Include resource modules here.  Later, when we have the option of XS</td></tr>
<tr><td class="h"><a name="573"></a>573</td><td></td><td></td><td></td><td></td><td class="s"># versions, we'll adapt this to include them if they're available.</td></tr>
<tr><td class="h"><a name="574"></a>574</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="575"></a>575</td><td class="c3">2</td><td class="c0"><span title="Avg 3.09ms">6.17ms</span></td><td class="c3">1</td><td class="c0">253Âµs</td><td class="s"><div class="calls"><div class="calls_in"># spent 253Âµs (186+67) within POE::Kernel::BEGIN@575 which was called:
#    once (186Âµs+67Âµs) by main::BEGIN@1.7 at <a href="POE-Kernel-pm-54-sub.html#575">line 575</a></div></div>use POE::Resources;<div class="calls"><div class="calls_out"># spent   253Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#575">POE::Kernel::BEGIN@575</a></div></div></td></tr>
<tr><td class="h"><a name="576"></a>576</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="577"></a>577</td><td></td><td></td><td></td><td></td><td class="s">###############################################################################</td></tr>
<tr><td class="h"><a name="578"></a>578</td><td></td><td></td><td></td><td></td><td class="s"># Helpers.</td></tr>
<tr><td class="h"><a name="579"></a>579</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="580"></a>580</td><td></td><td></td><td></td><td></td><td class="s">### Resolve $whatever into a session reference, trying every method we</td></tr>
<tr><td class="h"><a name="581"></a>581</td><td></td><td></td><td></td><td></td><td class="s">### can until something succeeds.</td></tr>
<tr><td class="h"><a name="582"></a>582</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="583"></a>583</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 844Âµs (512+332) within POE::Kernel::_resolve_session which was called 82 times, avg 10Âµs/call:
# 80 times (492Âµs+323Âµs) by POE::Kernel::call at <a href="POE-Kernel-pm-54-sub.html#1726">line 1726</a>, avg 10Âµs/call
#  2 times (20Âµs+9Âµs) by POE::Kernel::post at <a href="POE-Kernel-pm-54-sub.html#1666">line 1666</a>, avg 15Âµs/call</div></div>sub _resolve_session {</td></tr>
<tr><td class="h"><a name="584"></a>584</td><td class="c0">358</td><td class="c0"><span title="Avg 1Âµs">430Âµs</span></td><td></td><td></td><td class="s">  my ($self, $whatever) = @_;</td></tr>
<tr><td class="h"><a name="585"></a>585</td><td></td><td></td><td></td><td></td><td class="s">  my $session;</td></tr>
<tr><td class="h"><a name="586"></a>586</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="587"></a>587</td><td></td><td></td><td></td><td></td><td class="s">  # Resolve against sessions.</td></tr>
<tr><td class="h"><a name="588"></a>588</td><td></td><td></td><td class="c0">82</td><td class="c0">308Âµs</td><td class="s">  $session = $self-&gt;_data_ses_resolve($whatever);<div class="calls"><div class="calls_out">  # spent   308Âµs making 82 calls to <a href="POE-Resource-Sessions-pm-82-sub.html#359">POE::Kernel::_data_ses_resolve</a>, avg 4Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="589"></a>589</td><td></td><td></td><td></td><td></td><td class="s">  return $session if defined $session;</td></tr>
<tr><td class="h"><a name="590"></a>590</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="591"></a>591</td><td></td><td></td><td></td><td></td><td class="s">  # Resolve against IDs.</td></tr>
<tr><td class="h"><a name="592"></a>592</td><td></td><td></td><td class="c0">12</td><td class="c3">21Âµs</td><td class="s">  $session = $self-&gt;_data_sid_resolve($whatever);<div class="calls"><div class="calls_out">  # spent    21Âµs making 12 calls to <a href="POE-Resource-SIDs-pm-79-sub.html#75">POE::Kernel::_data_sid_resolve</a>, avg 2Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="593"></a>593</td><td></td><td></td><td></td><td></td><td class="s">  return $session if defined $session;</td></tr>
<tr><td class="h"><a name="594"></a>594</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="595"></a>595</td><td></td><td></td><td></td><td></td><td class="s">  # Resolve against aliases.</td></tr>
<tr><td class="h"><a name="596"></a>596</td><td></td><td></td><td class="c3">2</td><td class="c3">3Âµs</td><td class="s">  $session = $self-&gt;_data_alias_resolve($whatever);<div class="calls"><div class="calls_out">  # spent     3Âµs making 2 calls to <a href="POE-Resource-Aliases-pm-63-sub.html#102">POE::Kernel::_data_alias_resolve</a>, avg 1Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="597"></a>597</td><td></td><td></td><td></td><td></td><td class="s">  return $session if defined $session;</td></tr>
<tr><td class="h"><a name="598"></a>598</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="599"></a>599</td><td></td><td></td><td></td><td></td><td class="s">  # Resolve against the Kernel itself.  Use &quot;eq&quot; instead of &quot;==&quot; here</td></tr>
<tr><td class="h"><a name="600"></a>600</td><td></td><td></td><td></td><td></td><td class="s">  # because $whatever is often a string.</td></tr>
<tr><td class="h"><a name="601"></a>601</td><td></td><td></td><td></td><td></td><td class="s">  return $whatever if $whatever eq $self;</td></tr>
<tr><td class="h"><a name="602"></a>602</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="603"></a>603</td><td></td><td></td><td></td><td></td><td class="s">  # We don't know what it is.</td></tr>
<tr><td class="h"><a name="604"></a>604</td><td></td><td></td><td></td><td></td><td class="s">  return undef;</td></tr>
<tr><td class="h"><a name="605"></a>605</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="606"></a>606</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="607"></a>607</td><td></td><td></td><td></td><td></td><td class="s">### Test whether POE has become idle.</td></tr>
<tr><td class="h"><a name="608"></a>608</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="609"></a>609</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 5.36ms (4.74+621Âµs) within POE::Kernel::_test_if_kernel_is_idle which was called 398 times, avg 13Âµs/call:
# 398 times (4.74ms+621Âµs) by POE::Kernel::loop_do_timeslice at <a href="POE-Loop-Select-pm-59-sub.html#149">line 149 of POE/Loop/Select.pm</a>, avg 13Âµs/call</div></div>sub _test_if_kernel_is_idle {</td></tr>
<tr><td class="h"><a name="610"></a>610</td><td class="c0">1195</td><td class="c0"><span title="Avg 1Âµs">1.45ms</span></td><td></td><td></td><td class="s">  my $self = shift;</td></tr>
<tr><td class="h"><a name="611"></a>611</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="612"></a>612</td><td></td><td></td><td></td><td></td><td class="s">  if (TRACE_REFCNT) {</td></tr>
<tr><td class="h"><a name="613"></a>613</td><td></td><td></td><td></td><td></td><td class="s">    _warn(</td></tr>
<tr><td class="h"><a name="614"></a>614</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;rc&gt; ,----- Kernel Activity -----\n&quot;,</td></tr>
<tr><td class="h"><a name="615"></a>615</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;rc&gt; | Events : &quot;, $kr_queue-&gt;get_item_count(),</td></tr>
<tr><td class="h"><a name="616"></a>616</td><td></td><td></td><td></td><td></td><td class="s">      &quot; (vs. idle size = &quot;, $idle_queue_size, &quot;)\n&quot;,</td></tr>
<tr><td class="h"><a name="617"></a>617</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;rc&gt; | Files  : &quot;, $self-&gt;_data_handle_count(), &quot;\n&quot;,</td></tr>
<tr><td class="h"><a name="618"></a>618</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;rc&gt; | Extra  : &quot;, $self-&gt;_data_extref_count(), &quot;\n&quot;,</td></tr>
<tr><td class="h"><a name="619"></a>619</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;rc&gt; | Procs  : &quot;, $self-&gt;_data_sig_kernel_awaits_pids(), &quot;\n&quot;,</td></tr>
<tr><td class="h"><a name="620"></a>620</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;rc&gt; | Sess   : &quot;, $self-&gt;_data_ses_count(), &quot;\n&quot;,</td></tr>
<tr><td class="h"><a name="621"></a>621</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;rc&gt; `---------------------------\n&quot;,</td></tr>
<tr><td class="h"><a name="622"></a>622</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;rc&gt; ...&quot;</td></tr>
<tr><td class="h"><a name="623"></a>623</td><td></td><td></td><td></td><td></td><td class="s">     );</td></tr>
<tr><td class="h"><a name="624"></a>624</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="625"></a>625</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="626"></a>626</td><td></td><td></td><td></td><td></td><td class="s">  if( ASSERT_DATA ) {</td></tr>
<tr><td class="h"><a name="627"></a>627</td><td></td><td></td><td></td><td></td><td class="s">    if( $kr_pid != $$ ) {</td></tr>
<tr><td class="h"><a name="628"></a>628</td><td></td><td></td><td></td><td></td><td class="s">      _trap(</td></tr>
<tr><td class="h"><a name="629"></a>629</td><td></td><td></td><td></td><td></td><td class="s">        &quot;New process detected. &quot; .</td></tr>
<tr><td class="h"><a name="630"></a>630</td><td></td><td></td><td></td><td></td><td class="s">        &quot;You must call -&gt;has_forked() in the child process.&quot;</td></tr>
<tr><td class="h"><a name="631"></a>631</td><td></td><td></td><td></td><td></td><td class="s">      );</td></tr>
<tr><td class="h"><a name="632"></a>632</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="633"></a>633</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="634"></a>634</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="635"></a>635</td><td></td><td></td><td></td><td></td><td class="s">  # Not yet idle, or SO idle that there's nothing to receive the</td></tr>
<tr><td class="h"><a name="636"></a>636</td><td></td><td></td><td></td><td></td><td class="s">  # event.  Try to order these from most to least likely to be true so</td></tr>
<tr><td class="h"><a name="637"></a>637</td><td></td><td></td><td></td><td></td><td class="s">  # that the tests short-circuit quickly.</td></tr>
<tr><td class="h"><a name="638"></a>638</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="639"></a>639</td><td></td><td></td><td></td><td></td><td class="s">  return if (</td></tr>
<tr><td class="h"><a name="640"></a>640</td><td></td><td></td><td class="c0">402</td><td class="c0">518Âµs</td><td class="s">    $kr_queue-&gt;get_item_count() &gt; $idle_queue_size or<div class="calls"><div class="calls_out">    # spent   460Âµs making 398 calls to <a href="POE-Queue-Array-pm-56-sub.html#121">POE::Queue::Array::get_item_count</a>, avg 1Âµs/call
    # spent    49Âµs making   1 call to <a href="POE-Resource-Signals-pm-85-sub.html#752">POE::Kernel::_data_sig_kernel_awaits_pids</a>
    # spent     4Âµs making   1 call to <a href="POE-Resource-FileHandles-pm-72-sub.html#658">POE::Kernel::_data_handle_count</a>
    # spent     3Âµs making   1 call to <a href="POE-Resource-Extrefs-pm-69-sub.html#162">POE::Kernel::_data_extref_count</a>
    # spent     2Âµs making   1 call to <a href="POE-Resource-Sessions-pm-82-sub.html#513">POE::Kernel::_data_ses_count</a></div></div></td></tr>
<tr><td class="h"><a name="641"></a>641</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_handle_count() or</td></tr>
<tr><td class="h"><a name="642"></a>642</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_extref_count() or</td></tr>
<tr><td class="h"><a name="643"></a>643</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_sig_kernel_awaits_pids() or</td></tr>
<tr><td class="h"><a name="644"></a>644</td><td></td><td></td><td></td><td></td><td class="s">    !$self-&gt;_data_ses_count()</td></tr>
<tr><td class="h"><a name="645"></a>645</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="646"></a>646</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="647"></a>647</td><td></td><td></td><td class="c3">1</td><td class="c0">103Âµs</td><td class="s">  $self-&gt;_data_ev_enqueue(<div class="calls"><div class="calls_out">  # spent   103Âµs making 1 call to <a href="POE-Resource-Events-pm-66-sub.html#63">POE::Kernel::_data_ev_enqueue</a></div></div></td></tr>
<tr><td class="h"><a name="648"></a>648</td><td></td><td></td><td></td><td></td><td class="s">    $self, $self, EN_SIGNAL, ET_SIGNAL, [ 'IDLE' ],</td></tr>
<tr><td class="h"><a name="649"></a>649</td><td></td><td></td><td></td><td></td><td class="s">    __FILE__, __LINE__, undef</td></tr>
<tr><td class="h"><a name="650"></a>650</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="651"></a>651</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="652"></a>652</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="653"></a>653</td><td></td><td></td><td></td><td></td><td class="s">### Explain why a session could not be resolved.</td></tr>
<tr><td class="h"><a name="654"></a>654</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="655"></a>655</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 3Âµs within POE::Kernel::_explain_resolve_failure which was called:
#    once (3Âµs+0s) by POE::Kernel::post at <a href="POE-Kernel-pm-54-sub.html#1668">line 1668</a></div></div>sub _explain_resolve_failure {</td></tr>
<tr><td class="h"><a name="656"></a>656</td><td class="c3">4</td><td class="c3"><span title="Avg 1Âµs">4Âµs</span></td><td></td><td></td><td class="s">  my ($self, $whatever, $nonfatal) = @_;</td></tr>
<tr><td class="h"><a name="657"></a>657</td><td></td><td></td><td></td><td></td><td class="s">  local $Carp::CarpLevel = 2;</td></tr>
<tr><td class="h"><a name="658"></a>658</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="659"></a>659</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_DATA and !$nonfatal) {</td></tr>
<tr><td class="h"><a name="660"></a>660</td><td></td><td></td><td></td><td></td><td class="s">    _trap &quot;&lt;dt&gt; Cannot resolve ``$whatever'' into a session reference&quot;;</td></tr>
<tr><td class="h"><a name="661"></a>661</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="662"></a>662</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="663"></a>663</td><td></td><td></td><td></td><td></td><td class="s">  $! = ESRCH;</td></tr>
<tr><td class="h"><a name="664"></a>664</td><td></td><td></td><td></td><td></td><td class="s">  TRACE_RETVALS  and _carp &quot;&lt;rv&gt; session not resolved: $!&quot;;</td></tr>
<tr><td class="h"><a name="665"></a>665</td><td></td><td></td><td></td><td></td><td class="s">  ASSERT_RETVALS and _carp &quot;&lt;rv&gt; session not resolved: $!&quot;;</td></tr>
<tr><td class="h"><a name="666"></a>666</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="667"></a>667</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="668"></a>668</td><td></td><td></td><td></td><td></td><td class="s">### Explain why a function is returning unsuccessfully.</td></tr>
<tr><td class="h"><a name="669"></a>669</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="670"></a>670</td><td></td><td></td><td></td><td></td><td class="s">sub _explain_return {</td></tr>
<tr><td class="h"><a name="671"></a>671</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $message) = @_;</td></tr>
<tr><td class="h"><a name="672"></a>672</td><td></td><td></td><td></td><td></td><td class="s">  local $Carp::CarpLevel = 2;</td></tr>
<tr><td class="h"><a name="673"></a>673</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="674"></a>674</td><td></td><td></td><td></td><td></td><td class="s">  ASSERT_RETVALS and _confess &quot;&lt;rv&gt; $message&quot;;</td></tr>
<tr><td class="h"><a name="675"></a>675</td><td></td><td></td><td></td><td></td><td class="s">  TRACE_RETVALS  and _carp    &quot;&lt;rv&gt; $message&quot;;</td></tr>
<tr><td class="h"><a name="676"></a>676</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="677"></a>677</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="678"></a>678</td><td></td><td></td><td></td><td></td><td class="s">### Explain how the user made a mistake calling a function.</td></tr>
<tr><td class="h"><a name="679"></a>679</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="680"></a>680</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 47Âµs within POE::Kernel::_explain_usage which was called 27 times, avg 2Âµs/call:
# 18 times (25Âµs+0s) by POE::Kernel::alias_set at <a href="POE-Kernel-pm-54-sub.html#2381">line 2381</a>, avg 1Âµs/call
#  8 times (20Âµs+0s) by POE::Kernel::alias_remove at <a href="POE-Kernel-pm-54-sub.html#2403">line 2403</a>, avg 2Âµs/call
#     once (2Âµs+0s) by POE::Kernel::alias_remove at <a href="POE-Kernel-pm-54-sub.html#2408">line 2408</a></div></div>sub _explain_usage {</td></tr>
<tr><td class="h"><a name="681"></a>681</td><td class="c0">108</td><td class="c3"><span title="Avg 655ns">71Âµs</span></td><td></td><td></td><td class="s">  my ($self, $message) = @_;</td></tr>
<tr><td class="h"><a name="682"></a>682</td><td></td><td></td><td></td><td></td><td class="s">  local $Carp::CarpLevel = 2;</td></tr>
<tr><td class="h"><a name="683"></a>683</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="684"></a>684</td><td></td><td></td><td></td><td></td><td class="s">  ASSERT_USAGE   and _confess &quot;&lt;us&gt; $message&quot;;</td></tr>
<tr><td class="h"><a name="685"></a>685</td><td></td><td></td><td></td><td></td><td class="s">  ASSERT_RETVALS and _confess &quot;&lt;rv&gt; $message&quot;;</td></tr>
<tr><td class="h"><a name="686"></a>686</td><td></td><td></td><td></td><td></td><td class="s">  TRACE_RETVALS  and _carp    &quot;&lt;rv&gt; $message&quot;;</td></tr>
<tr><td class="h"><a name="687"></a>687</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="688"></a>688</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="689"></a>689</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="690"></a>690</td><td></td><td></td><td></td><td></td><td class="s"># SIGNALS</td></tr>
<tr><td class="h"><a name="691"></a>691</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="692"></a>692</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="693"></a>693</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="694"></a>694</td><td></td><td></td><td></td><td></td><td class="s"># Register or remove signals.</td></tr>
<tr><td class="h"><a name="695"></a>695</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="696"></a>696</td><td></td><td></td><td></td><td></td><td class="s"># Public interface for adding or removing signal handlers.</td></tr>
<tr><td class="h"><a name="697"></a>697</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="698"></a>698</td><td></td><td></td><td></td><td></td><td class="s">sub sig {</td></tr>
<tr><td class="h"><a name="699"></a>699</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $signal, $event_name, @args) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="700"></a>700</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="701"></a>701</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="702"></a>702</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call sig() from a running session&quot;</td></tr>
<tr><td class="h"><a name="703"></a>703</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="704"></a>704</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined signal in sig()&quot; unless defined $signal;</td></tr>
<tr><td class="h"><a name="705"></a>705</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="706"></a>706</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="707"></a>707</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved assigning it to a signal&quot;</td></tr>
<tr><td class="h"><a name="708"></a>708</td><td></td><td></td><td></td><td></td><td class="s">    ) if defined($event_name) and exists($poes_own_events{$event_name});</td></tr>
<tr><td class="h"><a name="709"></a>709</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="710"></a>710</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="711"></a>711</td><td></td><td></td><td></td><td></td><td class="s">  if (defined $event_name) {</td></tr>
<tr><td class="h"><a name="712"></a>712</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_sig_add($kr_active_session, $signal, $event_name, \@args);</td></tr>
<tr><td class="h"><a name="713"></a>713</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="714"></a>714</td><td></td><td></td><td></td><td></td><td class="s">  else {</td></tr>
<tr><td class="h"><a name="715"></a>715</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_sig_remove($kr_active_session-&gt;ID, $signal);</td></tr>
<tr><td class="h"><a name="716"></a>716</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="717"></a>717</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="718"></a>718</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="719"></a>719</td><td></td><td></td><td></td><td></td><td class="s"># Public interface for posting signal events.</td></tr>
<tr><td class="h"><a name="720"></a>720</td><td></td><td></td><td></td><td></td><td class="s"># TODO - Like post(), signal() should return</td></tr>
<tr><td class="h"><a name="721"></a>721</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="722"></a>722</td><td></td><td></td><td></td><td></td><td class="s">sub signal {</td></tr>
<tr><td class="h"><a name="723"></a>723</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $dest_session, $signal, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="724"></a>724</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="725"></a>725</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="726"></a>726</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined destination in signal()&quot;</td></tr>
<tr><td class="h"><a name="727"></a>727</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $dest_session;</td></tr>
<tr><td class="h"><a name="728"></a>728</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined signal in signal()&quot; unless defined $signal;</td></tr>
<tr><td class="h"><a name="729"></a>729</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="730"></a>730</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="731"></a>731</td><td></td><td></td><td></td><td></td><td class="s">  my $session = $self-&gt;_resolve_session($dest_session);</td></tr>
<tr><td class="h"><a name="732"></a>732</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $session) {</td></tr>
<tr><td class="h"><a name="733"></a>733</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_resolve_failure($dest_session);</td></tr>
<tr><td class="h"><a name="734"></a>734</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="735"></a>735</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="736"></a>736</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="737"></a>737</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_ev_enqueue(</td></tr>
<tr><td class="h"><a name="738"></a>738</td><td></td><td></td><td></td><td></td><td class="s">    $session, $kr_active_session,</td></tr>
<tr><td class="h"><a name="739"></a>739</td><td></td><td></td><td></td><td></td><td class="s">    EN_SIGNAL, ET_SIGNAL, [ $signal, @etc ],</td></tr>
<tr><td class="h"><a name="740"></a>740</td><td></td><td></td><td></td><td></td><td class="s">    (caller)[1,2], $kr_active_event</td></tr>
<tr><td class="h"><a name="741"></a>741</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="742"></a>742</td><td></td><td></td><td></td><td></td><td class="s">  return 1;</td></tr>
<tr><td class="h"><a name="743"></a>743</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="744"></a>744</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="745"></a>745</td><td></td><td></td><td></td><td></td><td class="s"># Public interface for flagging signals as handled.  This will replace</td></tr>
<tr><td class="h"><a name="746"></a>746</td><td></td><td></td><td></td><td></td><td class="s"># the handlers' return values as an implicit flag.  Returns undef so</td></tr>
<tr><td class="h"><a name="747"></a>747</td><td></td><td></td><td></td><td></td><td class="s"># it may be used as the last function in an event handler.</td></tr>
<tr><td class="h"><a name="748"></a>748</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="749"></a>749</td><td></td><td></td><td></td><td></td><td class="s">sub sig_handled {</td></tr>
<tr><td class="h"><a name="750"></a>750</td><td></td><td></td><td></td><td></td><td class="s">  my $self = $poe_kernel;</td></tr>
<tr><td class="h"><a name="751"></a>751</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_sig_handled();</td></tr>
<tr><td class="h"><a name="752"></a>752</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="753"></a>753</td><td></td><td></td><td></td><td></td><td class="s">  if ($kr_active_event eq EN_SIGNAL) {</td></tr>
<tr><td class="h"><a name="754"></a>754</td><td></td><td></td><td></td><td></td><td class="s">    _die(</td></tr>
<tr><td class="h"><a name="755"></a>755</td><td></td><td></td><td></td><td></td><td class="s">      &quot;,----- DEPRECATION ERROR -----\n&quot;,</td></tr>
<tr><td class="h"><a name="756"></a>756</td><td></td><td></td><td></td><td></td><td class="s">      &quot;| &quot;, $self-&gt;_data_alias_loggable($kr_active_session-&gt;ID), &quot;:\n&quot;,</td></tr>
<tr><td class="h"><a name="757"></a>757</td><td></td><td></td><td></td><td></td><td class="s">      &quot;| handled a _signal event.  You must register a handler with sig().\n&quot;,</td></tr>
<tr><td class="h"><a name="758"></a>758</td><td></td><td></td><td></td><td></td><td class="s">      &quot;`-----------------------------\n&quot;,</td></tr>
<tr><td class="h"><a name="759"></a>759</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="760"></a>760</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="761"></a>761</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="762"></a>762</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="763"></a>763</td><td></td><td></td><td></td><td></td><td class="s"># Attach a window or widget's destroy/closure to the UIDESTROY signal.</td></tr>
<tr><td class="h"><a name="764"></a>764</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="765"></a>765</td><td></td><td></td><td></td><td></td><td class="s">sub signal_ui_destroy {</td></tr>
<tr><td class="h"><a name="766"></a>766</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $window) = @_;</td></tr>
<tr><td class="h"><a name="767"></a>767</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;loop_attach_uidestroy($window);</td></tr>
<tr><td class="h"><a name="768"></a>768</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="769"></a>769</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="770"></a>770</td><td></td><td></td><td></td><td></td><td class="s"># Handle child PIDs being reaped.  Added 2006-09-15.</td></tr>
<tr><td class="h"><a name="771"></a>771</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="772"></a>772</td><td></td><td></td><td></td><td></td><td class="s">sub sig_child {</td></tr>
<tr><td class="h"><a name="773"></a>773</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $pid, $event_name, @args) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="774"></a>774</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="775"></a>775</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="776"></a>776</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call sig_chld() from a running session&quot;</td></tr>
<tr><td class="h"><a name="777"></a>777</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="778"></a>778</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined process ID in sig_chld()&quot; unless defined $pid;</td></tr>
<tr><td class="h"><a name="779"></a>779</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="780"></a>780</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="781"></a>781</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved assigning it to a signal&quot;</td></tr>
<tr><td class="h"><a name="782"></a>782</td><td></td><td></td><td></td><td></td><td class="s">    ) if defined($event_name) and exists($poes_own_events{$event_name});</td></tr>
<tr><td class="h"><a name="783"></a>783</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="784"></a>784</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="785"></a>785</td><td></td><td></td><td></td><td></td><td class="s">  if (defined $event_name) {</td></tr>
<tr><td class="h"><a name="786"></a>786</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_sig_pid_watch($kr_active_session, $pid, $event_name, \@args);</td></tr>
<tr><td class="h"><a name="787"></a>787</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="788"></a>788</td><td></td><td></td><td></td><td></td><td class="s">  elsif ($self-&gt;_data_sig_pids_is_ses_watching($kr_active_session-&gt;ID, $pid)) {</td></tr>
<tr><td class="h"><a name="789"></a>789</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_sig_pid_ignore($kr_active_session-&gt;ID, $pid);</td></tr>
<tr><td class="h"><a name="790"></a>790</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="791"></a>791</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="792"></a>792</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="793"></a>793</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="794"></a>794</td><td></td><td></td><td></td><td></td><td class="s"># KERNEL</td></tr>
<tr><td class="h"><a name="795"></a>795</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="796"></a>796</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="797"></a>797</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 16.7ms (34Âµs+16.6) within POE::Kernel::new which was called:
#    once (34Âµs+16.6ms) by POE::Kernel::import at <a href="POE-Kernel-pm-54-sub.html#77">line 77</a></div></div>sub new {</td></tr>
<tr><td class="h"><a name="798"></a>798</td><td class="c0">15</td><td class="c3"><span title="Avg 2Âµs">23Âµs</span></td><td></td><td></td><td class="s">  my $type = shift;</td></tr>
<tr><td class="h"><a name="799"></a>799</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="800"></a>800</td><td></td><td></td><td></td><td></td><td class="s">  # Prevent multiple instances, no matter how many times it's called.</td></tr>
<tr><td class="h"><a name="801"></a>801</td><td></td><td></td><td></td><td></td><td class="s">  # This is a backward-compatibility enhancement for programs that</td></tr>
<tr><td class="h"><a name="802"></a>802</td><td></td><td></td><td></td><td></td><td class="s">  # have used versions prior to 0.06.  It also provides a convenient</td></tr>
<tr><td class="h"><a name="803"></a>803</td><td></td><td></td><td></td><td></td><td class="s">  # single entry point into the entirety of POE's state: point a</td></tr>
<tr><td class="h"><a name="804"></a>804</td><td></td><td></td><td></td><td></td><td class="s">  # Dumper module at it, and you'll see a hideous tree of knowledge.</td></tr>
<tr><td class="h"><a name="805"></a>805</td><td></td><td></td><td></td><td></td><td class="s">  # Be careful, though.  Its apples bite back.</td></tr>
<tr><td class="h"><a name="806"></a>806</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $poe_kernel) {</td></tr>
<tr><td class="h"><a name="807"></a>807</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="808"></a>808</td><td></td><td></td><td></td><td></td><td class="s">    # Create our master queue.</td></tr>
<tr><td class="h"><a name="809"></a>809</td><td></td><td></td><td class="c3">1</td><td class="c3">2Âµs</td><td class="s">    $kr_queue = $queue_class-&gt;new();<div class="calls"><div class="calls_out">    # spent     2Âµs making 1 call to <a href="POE-Queue-Array-pm-56-sub.html#37">POE::Queue::Array::new</a></div></div></td></tr>
<tr><td class="h"><a name="810"></a>810</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="811"></a>811</td><td></td><td></td><td></td><td></td><td class="s">    # Remember the PID</td></tr>
<tr><td class="h"><a name="812"></a>812</td><td></td><td></td><td></td><td></td><td class="s">    $kr_pid = $$;</td></tr>
<tr><td class="h"><a name="813"></a>813</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="814"></a>814</td><td></td><td></td><td></td><td></td><td class="s">    # TODO - Should KR_ACTIVE_SESSIONS and KR_ACTIVE_EVENT be handled</td></tr>
<tr><td class="h"><a name="815"></a>815</td><td></td><td></td><td></td><td></td><td class="s">    # by POE::Resource::Sessions?</td></tr>
<tr><td class="h"><a name="816"></a>816</td><td></td><td></td><td></td><td></td><td class="s">    # TODO - Should the subsystems be split off into separate real</td></tr>
<tr><td class="h"><a name="817"></a>817</td><td></td><td></td><td></td><td></td><td class="s">    # objects, such as KR_QUEUE is?</td></tr>
<tr><td class="h"><a name="818"></a>818</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="819"></a>819</td><td></td><td></td><td></td><td></td><td class="s">    my $self = $poe_kernel = bless [</td></tr>
<tr><td class="h"><a name="820"></a>820</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_SESSIONS - from POE::Resource::Sessions</td></tr>
<tr><td class="h"><a name="821"></a>821</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_FILENOS - from POE::Resource::FileHandles</td></tr>
<tr><td class="h"><a name="822"></a>822</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_SIGNALS - from POE::Resource::Signals</td></tr>
<tr><td class="h"><a name="823"></a>823</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_ALIASES - from POE::Resource::Aliases</td></tr>
<tr><td class="h"><a name="824"></a>824</td><td></td><td></td><td></td><td></td><td class="s">      \$kr_active_session,    # KR_ACTIVE_SESSION</td></tr>
<tr><td class="h"><a name="825"></a>825</td><td></td><td></td><td></td><td></td><td class="s">      $kr_queue,              # KR_QUEUE - reference to an object</td></tr>
<tr><td class="h"><a name="826"></a>826</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_ID</td></tr>
<tr><td class="h"><a name="827"></a>827</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_SESSION_IDS - from POE::Resource::SIDS</td></tr>
<tr><td class="h"><a name="828"></a>828</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_SID_SEQ - from POE::Resource::SIDS</td></tr>
<tr><td class="h"><a name="829"></a>829</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_EXTRA_REFS</td></tr>
<tr><td class="h"><a name="830"></a>830</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_SIZE</td></tr>
<tr><td class="h"><a name="831"></a>831</td><td></td><td></td><td></td><td></td><td class="s">      \$kr_run_warning,       # KR_RUN</td></tr>
<tr><td class="h"><a name="832"></a>832</td><td></td><td></td><td></td><td></td><td class="s">      \$kr_active_event,      # KR_ACTIVE_EVENT</td></tr>
<tr><td class="h"><a name="833"></a>833</td><td></td><td></td><td></td><td></td><td class="s">      undef,                  # KR_PIDS</td></tr>
<tr><td class="h"><a name="834"></a>834</td><td></td><td></td><td></td><td></td><td class="s">      \$kr_active_event_type, # KR_ACTIVE_EVENT_TYPE</td></tr>
<tr><td class="h"><a name="835"></a>835</td><td></td><td></td><td></td><td></td><td class="s">    ], $type;</td></tr>
<tr><td class="h"><a name="836"></a>836</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="837"></a>837</td><td></td><td></td><td class="c3">1</td><td class="c0">16.1ms</td><td class="s">    POE::Resources-&gt;load();<div class="calls"><div class="calls_out">    # spent  16.1ms making 1 call to <a href="POE-Resources-pm-57-sub.html#18">POE::Resources::load</a></div></div></td></tr>
<tr><td class="h"><a name="838"></a>838</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="839"></a>839</td><td></td><td></td><td class="c3">1</td><td class="c2">49Âµs</td><td class="s">    $self-&gt;_recalc_id();<div class="calls"><div class="calls_out">    # spent    49Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#2457">POE::Kernel::_recalc_id</a></div></div></td></tr>
<tr><td class="h"><a name="840"></a>840</td><td></td><td></td><td class="c3">1</td><td class="c3">2Âµs</td><td class="s">    $self-&gt;_data_sid_set($self-&gt;[KR_ID], $self);<div class="calls"><div class="calls_out">    # spent     2Âµs making 1 call to <a href="POE-Resource-SIDs-pm-79-sub.html#56">POE::Kernel::_data_sid_set</a></div></div></td></tr>
<tr><td class="h"><a name="841"></a>841</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="842"></a>842</td><td></td><td></td><td></td><td></td><td class="s">    # Initialize subsystems.  The order is important.</td></tr>
<tr><td class="h"><a name="843"></a>843</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="844"></a>844</td><td></td><td></td><td></td><td></td><td class="s">    # We need events before sessions, and the kernel's session before</td></tr>
<tr><td class="h"><a name="845"></a>845</td><td></td><td></td><td></td><td></td><td class="s">    # it can start polling for signals.</td></tr>
<tr><td class="h"><a name="846"></a>846</td><td></td><td></td><td class="c3">1</td><td class="c3">1Âµs</td><td class="s">    $self-&gt;_data_ev_initialize($kr_queue);<div class="calls"><div class="calls_out">    # spent     1Âµs making 1 call to <a href="POE-Resource-Events-pm-66-sub.html#28">POE::Kernel::_data_ev_initialize</a></div></div></td></tr>
<tr><td class="h"><a name="847"></a>847</td><td></td><td></td><td class="c3">1</td><td class="c3">27Âµs</td><td class="s">    $self-&gt;_initialize_kernel_session();<div class="calls"><div class="calls_out">    # spent    27Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#1193">POE::Kernel::_initialize_kernel_session</a></div></div></td></tr>
<tr><td class="h"><a name="848"></a>848</td><td></td><td></td><td class="c3">1</td><td class="c0">459Âµs</td><td class="s">    $self-&gt;_data_sig_initialize();<div class="calls"><div class="calls_out">    # spent   459Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#141">POE::Kernel::_data_sig_initialize</a></div></div></td></tr>
<tr><td class="h"><a name="849"></a>849</td><td></td><td></td><td class="c3">1</td><td class="c3">1Âµs</td><td class="s">    $self-&gt;_data_alias_initialize();<div class="calls"><div class="calls_out">    # spent     1Âµs making 1 call to <a href="POE-Resource-Aliases-pm-63-sub.html#29">POE::Kernel::_data_alias_initialize</a></div></div></td></tr>
<tr><td class="h"><a name="850"></a>850</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="851"></a>851</td><td></td><td></td><td></td><td></td><td class="s">    # These other subsystems don't have strange interactions.</td></tr>
<tr><td class="h"><a name="852"></a>852</td><td></td><td></td><td class="c3">1</td><td class="c3">1Âµs</td><td class="s">    $self-&gt;_data_handle_initialize($kr_queue);<div class="calls"><div class="calls_out">    # spent     1Âµs making 1 call to <a href="POE-Resource-FileHandles-pm-72-sub.html#118">POE::Kernel::_data_handle_initialize</a></div></div></td></tr>
<tr><td class="h"><a name="853"></a>853</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="854"></a>854</td><td></td><td></td><td class="c3">1</td><td class="c3">1Âµs</td><td class="s">    _idle_queue_reset();<div class="calls"><div class="calls_out">    # spent     1Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#410">POE::Kernel::_idle_queue_reset</a></div></div></td></tr>
<tr><td class="h"><a name="855"></a>855</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="856"></a>856</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="857"></a>857</td><td></td><td></td><td></td><td></td><td class="s">  # Return the global instance.</td></tr>
<tr><td class="h"><a name="858"></a>858</td><td></td><td></td><td></td><td></td><td class="s">  $poe_kernel;</td></tr>
<tr><td class="h"><a name="859"></a>859</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="860"></a>860</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="861"></a>861</td><td></td><td></td><td></td><td></td><td class="s">sub CLONE {</td></tr>
<tr><td class="h"><a name="862"></a>862</td><td></td><td></td><td></td><td></td><td class="s">  _data_ses_clone();</td></tr>
<tr><td class="h"><a name="863"></a>863</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="864"></a>864</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="865"></a>865</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="866"></a>866</td><td></td><td></td><td></td><td></td><td class="s"># Send an event to a session right now.  Used by _disp_select to</td></tr>
<tr><td class="h"><a name="867"></a>867</td><td></td><td></td><td></td><td></td><td class="s"># expedite select() events, and used by run() to deliver posted events</td></tr>
<tr><td class="h"><a name="868"></a>868</td><td></td><td></td><td></td><td></td><td class="s"># from the queue.</td></tr>
<tr><td class="h"><a name="869"></a>869</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="870"></a>870</td><td></td><td></td><td></td><td></td><td class="s"># Dispatch an event to its session.  A lot of work goes on here.</td></tr>
<tr><td class="h"><a name="871"></a>871</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="872"></a>872</td><td></td><td></td><td></td><td></td><td class="s">sub _dummy_sigdie_handler { 1 }</td></tr>
<tr><td class="h"><a name="873"></a>873</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="874"></a>874</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 734Âµs (163+571) within POE::Kernel::_dispatch_signal_event which was called:
#    once (163Âµs+571Âµs) by POE::Kernel::_data_ev_dispatch_due at <a href="POE-Resource-Events-pm-66-sub.html#381">line 381 of POE/Resource/Events.pm</a></div></div>sub _dispatch_signal_event {</td></tr>
<tr><td class="h"><a name="875"></a>875</td><td></td><td></td><td></td><td></td><td class="s">  my (</td></tr>
<tr><td class="h"><a name="876"></a>876</td><td class="c0">28</td><td class="c2"><span title="Avg 3Âµs">90Âµs</span></td><td></td><td></td><td class="s">    $self,</td></tr>
<tr><td class="h"><a name="877"></a>877</td><td></td><td></td><td></td><td></td><td class="s">    $session, $source_session, $event, $type, $etc,</td></tr>
<tr><td class="h"><a name="878"></a>878</td><td></td><td></td><td></td><td></td><td class="s">    $file, $line, $fromstate, $priority, $seq</td></tr>
<tr><td class="h"><a name="879"></a>879</td><td></td><td></td><td></td><td></td><td class="s">  ) = @_;</td></tr>
<tr><td class="h"><a name="880"></a>880</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="881"></a>881</td><td></td><td></td><td></td><td></td><td class="s">  # TODO - Regrettably, duplicate checking code in:</td></tr>
<tr><td class="h"><a name="882"></a>882</td><td></td><td></td><td></td><td></td><td class="s">  # _dispatch_signal_event(), _dispatch_event().</td></tr>
<tr><td class="h"><a name="883"></a>883</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="884"></a>884</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_EVENTS) {</td></tr>
<tr><td class="h"><a name="885"></a>885</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;ev&gt; undefined dest session&quot; unless defined $session;</td></tr>
<tr><td class="h"><a name="886"></a>886</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;ev&gt; undefined source session&quot; unless defined $source_session;</td></tr>
<tr><td class="h"><a name="887"></a>887</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="888"></a>888</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="889"></a>889</td><td></td><td></td><td></td><td></td><td class="s">  if (TRACE_EVENTS) {</td></tr>
<tr><td class="h"><a name="890"></a>890</td><td></td><td></td><td></td><td></td><td class="s">    my $log_session = $session;</td></tr>
<tr><td class="h"><a name="891"></a>891</td><td></td><td></td><td></td><td></td><td class="s">    $log_session =  $self-&gt;_data_alias_loggable($session-&gt;ID) unless (</td></tr>
<tr><td class="h"><a name="892"></a>892</td><td></td><td></td><td></td><td></td><td class="s">      $type &amp; ET_START</td></tr>
<tr><td class="h"><a name="893"></a>893</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="894"></a>894</td><td></td><td></td><td></td><td></td><td class="s">    my $string_etc = join(&quot; &quot;, map { defined() ? $_ : &quot;(undef)&quot; } @$etc);</td></tr>
<tr><td class="h"><a name="895"></a>895</td><td></td><td></td><td></td><td></td><td class="s">    _warn(</td></tr>
<tr><td class="h"><a name="896"></a>896</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;ev&gt; Dispatching event $seq ``$event'' ($string_etc) from &quot;,</td></tr>
<tr><td class="h"><a name="897"></a>897</td><td></td><td></td><td></td><td></td><td class="s">      $self-&gt;_data_alias_loggable($source_session-&gt;ID), &quot; to $log_session&quot;</td></tr>
<tr><td class="h"><a name="898"></a>898</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="899"></a>899</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="900"></a>900</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="901"></a>901</td><td></td><td></td><td></td><td></td><td class="s">  my $signal = $etc-&gt;[0];</td></tr>
<tr><td class="h"><a name="902"></a>902</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="903"></a>903</td><td></td><td></td><td></td><td></td><td class="s">  if (TRACE_SIGNALS) {</td></tr>
<tr><td class="h"><a name="904"></a>904</td><td></td><td></td><td></td><td></td><td class="s">    _warn(</td></tr>
<tr><td class="h"><a name="905"></a>905</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;sg&gt; dispatching ET_SIGNAL ($signal) to &quot;,</td></tr>
<tr><td class="h"><a name="906"></a>906</td><td></td><td></td><td></td><td></td><td class="s">      $self-&gt;_data_alias_loggable($session-&gt;ID)</td></tr>
<tr><td class="h"><a name="907"></a>907</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="908"></a>908</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="909"></a>909</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="910"></a>910</td><td></td><td></td><td></td><td></td><td class="s">  # Step 1a: Reset the handled-signal flags.</td></tr>
<tr><td class="h"><a name="911"></a>911</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="912"></a>912</td><td></td><td></td><td></td><td></td><td class="s">  local @POE::Kernel::kr_signaled_sessions;</td></tr>
<tr><td class="h"><a name="913"></a>913</td><td></td><td></td><td></td><td></td><td class="s">  local $POE::Kernel::kr_signal_total_handled;</td></tr>
<tr><td class="h"><a name="914"></a>914</td><td></td><td></td><td></td><td></td><td class="s">  local $POE::Kernel::kr_signal_type;</td></tr>
<tr><td class="h"><a name="915"></a>915</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="916"></a>916</td><td></td><td></td><td class="c3">1</td><td class="c3">20Âµs</td><td class="s">  $self-&gt;_data_sig_reset_handled($signal);<div class="calls"><div class="calls_out">  # spent    20Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#476">POE::Kernel::_data_sig_reset_handled</a></div></div></td></tr>
<tr><td class="h"><a name="917"></a>917</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="918"></a>918</td><td></td><td></td><td></td><td></td><td class="s">  # Step 1b: Collect a list of sessions to receive the signal.</td></tr>
<tr><td class="h"><a name="919"></a>919</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="920"></a>920</td><td></td><td></td><td></td><td></td><td class="s">  my @touched_sessions = ($session);</td></tr>
<tr><td class="h"><a name="921"></a>921</td><td></td><td></td><td></td><td></td><td class="s">  my $touched_index = 0;</td></tr>
<tr><td class="h"><a name="922"></a>922</td><td></td><td></td><td></td><td></td><td class="s">  while ($touched_index &lt; @touched_sessions) {</td></tr>
<tr><td class="h"><a name="923"></a>923</td><td></td><td></td><td class="c3">1</td><td class="c3">3Âµs</td><td class="s">    my $next_target = $touched_sessions[$touched_index]-&gt;ID;<div class="calls"><div class="calls_out">    # spent     3Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#2482">POE::Kernel::ID</a></div></div></td></tr>
<tr><td class="h"><a name="924"></a>924</td><td></td><td></td><td class="c3">1</td><td class="c3">6Âµs</td><td class="s">    push @touched_sessions, $self-&gt;_data_ses_get_children($next_target);<div class="calls"><div class="calls_out">    # spent     6Âµs making 1 call to <a href="POE-Resource-Sessions-pm-82-sub.html#325">POE::Kernel::_data_ses_get_children</a></div></div></td></tr>
<tr><td class="h"><a name="925"></a>925</td><td></td><td></td><td></td><td></td><td class="s">    $touched_index++;</td></tr>
<tr><td class="h"><a name="926"></a>926</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="927"></a>927</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="928"></a>928</td><td></td><td></td><td></td><td></td><td class="s">  # Step 1c: The DIE signal propagates up through parents, too.</td></tr>
<tr><td class="h"><a name="929"></a>929</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="930"></a>930</td><td></td><td></td><td></td><td></td><td class="s">  if ($signal eq &quot;DIE&quot;) {</td></tr>
<tr><td class="h"><a name="931"></a>931</td><td></td><td></td><td></td><td></td><td class="s">    my $next_target = $self-&gt;_data_ses_get_parent($session-&gt;ID);</td></tr>
<tr><td class="h"><a name="932"></a>932</td><td></td><td></td><td></td><td></td><td class="s">    while (defined($next_target) and $next_target != $self) {</td></tr>
<tr><td class="h"><a name="933"></a>933</td><td></td><td></td><td></td><td></td><td class="s">      unshift @touched_sessions, $next_target;</td></tr>
<tr><td class="h"><a name="934"></a>934</td><td></td><td></td><td></td><td></td><td class="s">      $next_target = $self-&gt;_data_ses_get_parent($next_target-&gt;ID);</td></tr>
<tr><td class="h"><a name="935"></a>935</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="936"></a>936</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="937"></a>937</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="938"></a>938</td><td></td><td></td><td></td><td></td><td class="s">  # Step 2: Propagate the signal to the explicit watchers in the</td></tr>
<tr><td class="h"><a name="939"></a>939</td><td></td><td></td><td></td><td></td><td class="s">  # child tree.  Ensure the full tree is touched regardless</td></tr>
<tr><td class="h"><a name="940"></a>940</td><td></td><td></td><td></td><td></td><td class="s">  # whether there are explicit watchers.</td></tr>
<tr><td class="h"><a name="941"></a>941</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="942"></a>942</td><td></td><td></td><td class="c3">1</td><td class="c3">5Âµs</td><td class="s">  if ($self-&gt;_data_sig_explicitly_watched($signal)) {<div class="calls"><div class="calls_out">  # spent     5Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#485">POE::Kernel::_data_sig_explicitly_watched</a></div></div></td></tr>
<tr><td class="h"><a name="943"></a>943</td><td></td><td></td><td class="c3">1</td><td class="c3">7Âµs</td><td class="s">    my %signal_watchers = $self-&gt;_data_sig_watchers($signal);<div class="calls"><div class="calls_out">    # spent     7Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#502">POE::Kernel::_data_sig_watchers</a></div></div></td></tr>
<tr><td class="h"><a name="944"></a>944</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="945"></a>945</td><td></td><td></td><td></td><td></td><td class="s">    $touched_index = @touched_sessions;</td></tr>
<tr><td class="h"><a name="946"></a>946</td><td></td><td></td><td></td><td></td><td class="s">    while ($touched_index--) {</td></tr>
<tr><td class="h"><a name="947"></a>947</td><td></td><td></td><td></td><td></td><td class="s">      my $target_session = $touched_sessions[$touched_index];</td></tr>
<tr><td class="h"><a name="948"></a>948</td><td></td><td></td><td class="c3">1</td><td class="c3">5Âµs</td><td class="s">      $self-&gt;_data_sig_touched_session($target_session);<div class="calls"><div class="calls_out">      # spent     5Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#563">POE::Kernel::_data_sig_touched_session</a></div></div></td></tr>
<tr><td class="h"><a name="949"></a>949</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="950"></a>950</td><td></td><td></td><td class="c3">1</td><td class="c3">3Âµs</td><td class="s">      my $target_sid = $target_session-&gt;ID;<div class="calls"><div class="calls_out">      # spent     3Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#2482">POE::Kernel::ID</a></div></div></td></tr>
<tr><td class="h"><a name="951"></a>951</td><td></td><td></td><td></td><td></td><td class="s">      next unless exists $signal_watchers{$target_sid};</td></tr>
<tr><td class="h"><a name="952"></a>952</td><td></td><td></td><td></td><td></td><td class="s">      my ($target_event, $target_etc) = @{$signal_watchers{$target_sid}};</td></tr>
<tr><td class="h"><a name="953"></a>953</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="954"></a>954</td><td></td><td></td><td></td><td></td><td class="s">      if (TRACE_SIGNALS) {</td></tr>
<tr><td class="h"><a name="955"></a>955</td><td></td><td></td><td></td><td></td><td class="s">        _warn(</td></tr>
<tr><td class="h"><a name="956"></a>956</td><td></td><td></td><td></td><td></td><td class="s">          &quot;&lt;sg&gt; propagating explicit signal $target_event ($signal) &quot;,</td></tr>
<tr><td class="h"><a name="957"></a>957</td><td></td><td></td><td></td><td></td><td class="s">          &quot;(@$target_etc) to &quot;, $self-&gt;_data_alias_loggable($target_sid)</td></tr>
<tr><td class="h"><a name="958"></a>958</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="959"></a>959</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="960"></a>960</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="961"></a>961</td><td></td><td></td><td></td><td></td><td class="s">      # ET_SIGNAL_RECURSIVE is used here to avoid repropagating</td></tr>
<tr><td class="h"><a name="962"></a>962</td><td></td><td></td><td></td><td></td><td class="s">      # the signal ad nauseam.</td></tr>
<tr><td class="h"><a name="963"></a>963</td><td></td><td></td><td></td><td></td><td class="s">      $self-&gt;_dispatch_event(</td></tr>
<tr><td class="h"><a name="964"></a>964</td><td></td><td></td><td class="c3">2</td><td class="c0">144Âµs</td><td class="s">        $target_session, $self,<div class="calls"><div class="calls_out">        # spent   142Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#996">POE::Kernel::_dispatch_event</a>
        # spent     2Âµs making 1 call to <a href="Time-HiRes-pm-50-sub.html#Time__HiRes__time">Time::HiRes::time</a></div></div></td></tr>
<tr><td class="h"><a name="965"></a>965</td><td></td><td></td><td></td><td></td><td class="s">        $target_event, ET_SIGNAL_RECURSIVE | $type, [ @$etc, @$target_etc ],</td></tr>
<tr><td class="h"><a name="966"></a>966</td><td></td><td></td><td></td><td></td><td class="s">        $file, $line, $fromstate, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="967"></a>967</td><td></td><td></td><td></td><td></td><td class="s">      );</td></tr>
<tr><td class="h"><a name="968"></a>968</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="969"></a>969</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="970"></a>970</td><td></td><td></td><td></td><td></td><td class="s">  else {</td></tr>
<tr><td class="h"><a name="971"></a>971</td><td></td><td></td><td></td><td></td><td class="s">    $touched_index = @touched_sessions;</td></tr>
<tr><td class="h"><a name="972"></a>972</td><td></td><td></td><td></td><td></td><td class="s">    while ($touched_index--) {</td></tr>
<tr><td class="h"><a name="973"></a>973</td><td></td><td></td><td></td><td></td><td class="s">      $self-&gt;_data_sig_touched_session($touched_sessions[$touched_index]);</td></tr>
<tr><td class="h"><a name="974"></a>974</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="975"></a>975</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="976"></a>976</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="977"></a>977</td><td></td><td></td><td></td><td></td><td class="s">  # Step 3: Check to see if the signal was handled.</td></tr>
<tr><td class="h"><a name="978"></a>978</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="979"></a>979</td><td></td><td></td><td class="c3">1</td><td class="c0">373Âµs</td><td class="s">  $self-&gt;_data_sig_free_terminated_sessions();<div class="calls"><div class="calls_out">  # spent   373Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#534">POE::Kernel::_data_sig_free_terminated_sessions</a></div></div></td></tr>
<tr><td class="h"><a name="980"></a>980</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="981"></a>981</td><td></td><td></td><td></td><td></td><td class="s">  # If the signal was SIGDIE, then propagate the exception.</td></tr>
<tr><td class="h"><a name="982"></a>982</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="983"></a>983</td><td></td><td></td><td class="c3">1</td><td class="c3">5Âµs</td><td class="s">  my $handled_session_count = (_data_sig_handled_status())[0];<div class="calls"><div class="calls_out">  # spent     5Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#510">POE::Kernel::_data_sig_handled_status</a></div></div></td></tr>
<tr><td class="h"><a name="984"></a>984</td><td></td><td></td><td></td><td></td><td class="s">  if ($signal eq &quot;DIE&quot; and !$handled_session_count) {</td></tr>
<tr><td class="h"><a name="985"></a>985</td><td></td><td></td><td></td><td></td><td class="s">    $kr_exception = $etc-&gt;[1]{error_str} . (</td></tr>
<tr><td class="h"><a name="986"></a>986</td><td></td><td></td><td></td><td></td><td class="s">      (defined $kr_exception)</td></tr>
<tr><td class="h"><a name="987"></a>987</td><td></td><td></td><td></td><td></td><td class="s">      ? &quot;Additional error thrown in handler for previous error:\n$kr_exception&quot;</td></tr>
<tr><td class="h"><a name="988"></a>988</td><td></td><td></td><td></td><td></td><td class="s">      : ''</td></tr>
<tr><td class="h"><a name="989"></a>989</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="990"></a>990</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="991"></a>991</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="992"></a>992</td><td></td><td></td><td></td><td></td><td class="s">  # Signal completely dispatched.  Thanks for flying!</td></tr>
<tr><td class="h"><a name="993"></a>993</td><td></td><td></td><td></td><td></td><td class="s">  return;</td></tr>
<tr><td class="h"><a name="994"></a>994</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="995"></a>995</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="996"></a>996</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 9.04s (48.6ms+9.00) within POE::Kernel::_dispatch_event which was called 4091 times, avg 2.21ms/call:
# 3927 times (47.1ms+8.97s) by POE::Kernel::_data_handle_enqueue_ready at <a href="POE-Resource-FileHandles-pm-72-sub.html#238">line 238 of POE/Resource/FileHandles.pm</a>, avg 2.30ms/call
#   64 times (471Âµs+19.1ms) by POE::Kernel::_data_ev_dispatch_due at <a href="POE-Resource-Events-pm-66-sub.html#385">line 385 of POE/Resource/Events.pm</a>, avg 306Âµs/call
#   23 times (236Âµs+619Âµs) by POE::Kernel::_data_ses_stop at <a href="POE-Resource-Sessions-pm-82-sub.html#568">line 568 of POE/Resource/Sessions.pm</a>, avg 37Âµs/call
#   22 times (251Âµs+4.84ms) by POE::Kernel::session_alloc at <a href="POE-Kernel-pm-54-sub.html#1481">line 1481</a>, avg 231Âµs/call
#   22 times (202Âµs+95Âµs) by POE::Kernel::_data_ses_stop at <a href="POE-Resource-Sessions-pm-82-sub.html#577">line 577 of POE/Resource/Sessions.pm</a>, avg 14Âµs/call
#   22 times (190Âµs+-72Âµs) by POE::Kernel::session_alloc at <a href="POE-Kernel-pm-54-sub.html#1499">line 1499</a>, avg 5Âµs/call
#   10 times (90Âµs+-90Âµs) by POE::Kernel::call at <a href="POE-Kernel-pm-54-sub.html#1789">line 1789</a>, avg 0s/call
#       once (25Âµs+117Âµs) by POE::Kernel::_dispatch_signal_event at <a href="POE-Kernel-pm-54-sub.html#964">line 964</a></div></div>sub _dispatch_event {</td></tr>
<tr><td class="h"><a name="997"></a>997</td><td></td><td></td><td></td><td></td><td class="s">  my (</td></tr>
<tr><td class="h"><a name="998"></a>998</td><td class="c0">77387</td><td class="c0"><span title="Avg 626ns">48.4ms</span></td><td></td><td></td><td class="s">    $self,</td></tr>
<tr><td class="h"><a name="999"></a>999</td><td></td><td></td><td></td><td></td><td class="s">    $session, $source_session, $event, $type, $etc,</td></tr>
<tr><td class="h"><a name="1000"></a>1000</td><td></td><td></td><td></td><td></td><td class="s">    $file, $line, $fromstate, $priority, $seq</td></tr>
<tr><td class="h"><a name="1001"></a>1001</td><td></td><td></td><td></td><td></td><td class="s">  ) = @_;</td></tr>
<tr><td class="h"><a name="1002"></a>1002</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1003"></a>1003</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_EVENTS) {</td></tr>
<tr><td class="h"><a name="1004"></a>1004</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;ev&gt; undefined dest session&quot; unless defined $session;</td></tr>
<tr><td class="h"><a name="1005"></a>1005</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;ev&gt; undefined source session&quot; unless defined $source_session;</td></tr>
<tr><td class="h"><a name="1006"></a>1006</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="1007"></a>1007</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1008"></a>1008</td><td></td><td></td><td></td><td></td><td class="s">  if (TRACE_EVENTS) {</td></tr>
<tr><td class="h"><a name="1009"></a>1009</td><td></td><td></td><td></td><td></td><td class="s">    my $log_session = $session;</td></tr>
<tr><td class="h"><a name="1010"></a>1010</td><td></td><td></td><td></td><td></td><td class="s">    $log_session =  $self-&gt;_data_alias_loggable($session-&gt;ID) unless (</td></tr>
<tr><td class="h"><a name="1011"></a>1011</td><td></td><td></td><td></td><td></td><td class="s">      $type &amp; ET_START</td></tr>
<tr><td class="h"><a name="1012"></a>1012</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1013"></a>1013</td><td></td><td></td><td></td><td></td><td class="s">    my $string_etc = join(&quot; &quot;, map { defined() ? $_ : &quot;(undef)&quot; } @$etc);</td></tr>
<tr><td class="h"><a name="1014"></a>1014</td><td></td><td></td><td></td><td></td><td class="s">    _warn(</td></tr>
<tr><td class="h"><a name="1015"></a>1015</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;ev&gt; Dispatching event $seq ``$event'' ($string_etc) from &quot;,</td></tr>
<tr><td class="h"><a name="1016"></a>1016</td><td></td><td></td><td></td><td></td><td class="s">      $self-&gt;_data_alias_loggable($source_session-&gt;ID), &quot; to $log_session&quot;</td></tr>
<tr><td class="h"><a name="1017"></a>1017</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1018"></a>1018</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1019"></a>1019</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1020"></a>1020</td><td></td><td></td><td></td><td></td><td class="s">  ### Pre-dispatch processing.</td></tr>
<tr><td class="h"><a name="1021"></a>1021</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1022"></a>1022</td><td></td><td></td><td></td><td></td><td class="s">  # Some sessions don't do anything in _start and expect their</td></tr>
<tr><td class="h"><a name="1023"></a>1023</td><td></td><td></td><td></td><td></td><td class="s">  # creators to provide a start-up event.  This means we can't</td></tr>
<tr><td class="h"><a name="1024"></a>1024</td><td></td><td></td><td></td><td></td><td class="s">  # &amp;_collect_garbage at _start time.  Instead, an ET_GC event is</td></tr>
<tr><td class="h"><a name="1025"></a>1025</td><td></td><td></td><td></td><td></td><td class="s">  # posted as part of session allocation.  Simply dispatching it</td></tr>
<tr><td class="h"><a name="1026"></a>1026</td><td></td><td></td><td></td><td></td><td class="s">  # will trigger a GC sweep.</td></tr>
<tr><td class="h"><a name="1027"></a>1027</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1028"></a>1028</td><td></td><td></td><td></td><td></td><td class="s">  return 0 if $type &amp; ET_GC;</td></tr>
<tr><td class="h"><a name="1029"></a>1029</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1030"></a>1030</td><td></td><td></td><td></td><td></td><td class="s">  # Preprocess signals.  This is where _signal is translated into</td></tr>
<tr><td class="h"><a name="1031"></a>1031</td><td></td><td></td><td></td><td></td><td class="s">  # its registered handler's event name, if there is one.</td></tr>
<tr><td class="h"><a name="1032"></a>1032</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1033"></a>1033</td><td></td><td></td><td></td><td></td><td class="s">  if (TRACE_EVENTS) {</td></tr>
<tr><td class="h"><a name="1034"></a>1034</td><td></td><td></td><td></td><td></td><td class="s">    _warn(</td></tr>
<tr><td class="h"><a name="1035"></a>1035</td><td></td><td></td><td></td><td></td><td class="s">    &quot;&lt;ev&gt; dispatching event $seq ``$event'' to &quot;,</td></tr>
<tr><td class="h"><a name="1036"></a>1036</td><td></td><td></td><td></td><td></td><td class="s">      $self-&gt;_data_alias_loggable($session-&gt;ID)</td></tr>
<tr><td class="h"><a name="1037"></a>1037</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1038"></a>1038</td><td></td><td></td><td></td><td></td><td class="s">    if ($event eq EN_SIGNAL) {</td></tr>
<tr><td class="h"><a name="1039"></a>1039</td><td></td><td></td><td></td><td></td><td class="s">      _warn(&quot;&lt;ev&gt;     signal($etc-&gt;[0])&quot;);</td></tr>
<tr><td class="h"><a name="1040"></a>1040</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1041"></a>1041</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1042"></a>1042</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1043"></a>1043</td><td></td><td></td><td></td><td></td><td class="s">  # Prepare to call the appropriate handler.  Push the current active</td></tr>
<tr><td class="h"><a name="1044"></a>1044</td><td></td><td></td><td></td><td></td><td class="s">  # session on Perl's call stack.</td></tr>
<tr><td class="h"><a name="1045"></a>1045</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1046"></a>1046</td><td></td><td></td><td></td><td></td><td class="s">  my ($hold_active_session, $hold_active_event, $hold_active_event_type) = (</td></tr>
<tr><td class="h"><a name="1047"></a>1047</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $kr_active_event, $kr_active_event_type</td></tr>
<tr><td class="h"><a name="1048"></a>1048</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1049"></a>1049</td><td></td><td></td><td></td><td></td><td class="s">  (</td></tr>
<tr><td class="h"><a name="1050"></a>1050</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $kr_active_event, $kr_active_event_type</td></tr>
<tr><td class="h"><a name="1051"></a>1051</td><td></td><td></td><td></td><td></td><td class="s">  ) = ($session, $event, $type);</td></tr>
<tr><td class="h"><a name="1052"></a>1052</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1053"></a>1053</td><td></td><td></td><td></td><td></td><td class="s">  # We only care about the return value and calling context if it's</td></tr>
<tr><td class="h"><a name="1054"></a>1054</td><td></td><td></td><td></td><td></td><td class="s">  # ET_CALL.</td></tr>
<tr><td class="h"><a name="1055"></a>1055</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1056"></a>1056</td><td></td><td></td><td></td><td></td><td class="s">  my $return;</td></tr>
<tr><td class="h"><a name="1057"></a>1057</td><td></td><td></td><td></td><td></td><td class="s">  my $wantarray = wantarray();</td></tr>
<tr><td class="h"><a name="1058"></a>1058</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1059"></a>1059</td><td></td><td></td><td></td><td></td><td class="s">  confess 'please report this stacktrace to bug-poe@rt.cpan.org' unless (</td></tr>
<tr><td class="h"><a name="1060"></a>1060</td><td></td><td></td><td></td><td></td><td class="s">    defined $session</td></tr>
<tr><td class="h"><a name="1061"></a>1061</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1062"></a>1062</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1063"></a>1063</td><td></td><td></td><td></td><td></td><td class="s">  # Quiet SIGDIE if it's DEFAULT.  If it's something special, then</td></tr>
<tr><td class="h"><a name="1064"></a>1064</td><td></td><td></td><td></td><td></td><td class="s">  # someone had better know what they're doing.</td></tr>
<tr><td class="h"><a name="1065"></a>1065</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1066"></a>1066</td><td></td><td></td><td></td><td></td><td class="s">  my $old_sig_die = $SIG{__DIE__};</td></tr>
<tr><td class="h"><a name="1067"></a>1067</td><td></td><td></td><td></td><td></td><td class="s">  $SIG{__DIE__} = \&amp;_dummy_sigdie_handler if (</td></tr>
<tr><td class="h"><a name="1068"></a>1068</td><td></td><td></td><td></td><td></td><td class="s">    not defined $old_sig_die or $old_sig_die eq 'DEFAULT'</td></tr>
<tr><td class="h"><a name="1069"></a>1069</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1070"></a>1070</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1071"></a>1071</td><td></td><td></td><td></td><td></td><td class="s">  eval {</td></tr>
<tr><td class="h"><a name="1072"></a>1072</td><td></td><td></td><td class="c0">45</td><td class="c0">5.59ms</td><td class="s">    if ($wantarray) {<div class="calls"><div class="calls_out">    # spent  24.2ms making 44 calls to <a href="POE-Session-pm-87-sub.html#405">POE::Session::_invoke_state</a>, avg 551Âµs/call, recursion: max depth 2, sum of overlapping time 18.6ms
    # spent     4Âµs making  1 call to <a href="POE-Kernel-pm-54-sub.html#1406">POE::Kernel::_invoke_state</a></div></div></td></tr>
<tr><td class="h"><a name="1073"></a>1073</td><td></td><td></td><td></td><td></td><td class="s">      $return = [</td></tr>
<tr><td class="h"><a name="1074"></a>1074</td><td></td><td></td><td></td><td></td><td class="s">        $session-&gt;_invoke_state(</td></tr>
<tr><td class="h"><a name="1075"></a>1075</td><td></td><td></td><td></td><td></td><td class="s">          $source_session, $event, $etc, $file, $line, $fromstate</td></tr>
<tr><td class="h"><a name="1076"></a>1076</td><td></td><td></td><td></td><td></td><td class="s">        )</td></tr>
<tr><td class="h"><a name="1077"></a>1077</td><td></td><td></td><td></td><td></td><td class="s">      ];</td></tr>
<tr><td class="h"><a name="1078"></a>1078</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1079"></a>1079</td><td></td><td></td><td></td><td></td><td class="s">    elsif (defined $wantarray) {</td></tr>
<tr><td class="h"><a name="1080"></a>1080</td><td></td><td></td><td></td><td></td><td class="s">      $return = $session-&gt;_invoke_state(</td></tr>
<tr><td class="h"><a name="1081"></a>1081</td><td></td><td></td><td></td><td></td><td class="s">        $source_session, $event, $etc, $file, $line, $fromstate</td></tr>
<tr><td class="h"><a name="1082"></a>1082</td><td></td><td></td><td></td><td></td><td class="s">      );</td></tr>
<tr><td class="h"><a name="1083"></a>1083</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1084"></a>1084</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="1085"></a>1085</td><td></td><td></td><td class="c0">4024</td><td class="c0">8.99s</td><td class="s">      $session-&gt;_invoke_state(<div class="calls"><div class="calls_out">      # spent  8.99s making 3999 calls to <a href="POE-Session-pm-87-sub.html#405">POE::Session::_invoke_state</a>, avg 2.25ms/call, recursion: max depth 2, sum of overlapping time 169Âµs
      # spent   169Âµs making   25 calls to <a href="POE-Kernel-pm-54-sub.html#1406">POE::Kernel::_invoke_state</a>, avg 7Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1086"></a>1086</td><td></td><td></td><td></td><td></td><td class="s">        $source_session, $event, $etc, $file, $line, $fromstate</td></tr>
<tr><td class="h"><a name="1087"></a>1087</td><td></td><td></td><td></td><td></td><td class="s">      );</td></tr>
<tr><td class="h"><a name="1088"></a>1088</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1089"></a>1089</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="1090"></a>1090</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1091"></a>1091</td><td></td><td></td><td></td><td></td><td class="s">  # An exception happened?</td></tr>
<tr><td class="h"><a name="1092"></a>1092</td><td></td><td></td><td></td><td></td><td class="s">  # It was intially thrown under the $SIG{__DIE__} conditions that the</td></tr>
<tr><td class="h"><a name="1093"></a>1093</td><td></td><td></td><td></td><td></td><td class="s">  # user wanted.  Any formatting, logging, etc. is already done.</td></tr>
<tr><td class="h"><a name="1094"></a>1094</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1095"></a>1095</td><td></td><td></td><td></td><td></td><td class="s">  if (ref($@) or $@ ne '') {</td></tr>
<tr><td class="h"><a name="1096"></a>1096</td><td></td><td></td><td></td><td></td><td class="s">    if (CATCH_EXCEPTIONS) {</td></tr>
<tr><td class="h"><a name="1097"></a>1097</td><td></td><td></td><td></td><td></td><td class="s">      if (TRACE_EVENTS) {</td></tr>
<tr><td class="h"><a name="1098"></a>1098</td><td></td><td></td><td></td><td></td><td class="s">        _warn(</td></tr>
<tr><td class="h"><a name="1099"></a>1099</td><td></td><td></td><td></td><td></td><td class="s">          &quot;&lt;ev&gt; exception occurred in $event when invoked on &quot;,</td></tr>
<tr><td class="h"><a name="1100"></a>1100</td><td></td><td></td><td></td><td></td><td class="s">          $self-&gt;_data_alias_loggable($session-&gt;ID)</td></tr>
<tr><td class="h"><a name="1101"></a>1101</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="1102"></a>1102</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="1103"></a>1103</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1104"></a>1104</td><td></td><td></td><td></td><td></td><td class="s">      # Exceptions in _stop are rethrown unconditionally.</td></tr>
<tr><td class="h"><a name="1105"></a>1105</td><td></td><td></td><td></td><td></td><td class="s">      # We can't enqueue them--the session is about to go away.</td></tr>
<tr><td class="h"><a name="1106"></a>1106</td><td></td><td></td><td></td><td></td><td class="s">      # Also if the active session has been forced back to $self via</td></tr>
<tr><td class="h"><a name="1107"></a>1107</td><td></td><td></td><td></td><td></td><td class="s">      # POE::Kernel-&gt;stop().</td></tr>
<tr><td class="h"><a name="1108"></a>1108</td><td></td><td></td><td></td><td></td><td class="s">      if ($type &amp; (ET_STOP | ET_SIGDIE) or $kr_active_session eq $self) {</td></tr>
<tr><td class="h"><a name="1109"></a>1109</td><td></td><td></td><td></td><td></td><td class="s">        # Propagate the exception up to the safe rethrow point.</td></tr>
<tr><td class="h"><a name="1110"></a>1110</td><td></td><td></td><td></td><td></td><td class="s">        $kr_exception = $@;</td></tr>
<tr><td class="h"><a name="1111"></a>1111</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="1112"></a>1112</td><td></td><td></td><td></td><td></td><td class="s">      else {</td></tr>
<tr><td class="h"><a name="1113"></a>1113</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;_data_ev_enqueue(</td></tr>
<tr><td class="h"><a name="1114"></a>1114</td><td></td><td></td><td></td><td></td><td class="s">          $session, $self, EN_SIGNAL, ET_SIGDIE, [</td></tr>
<tr><td class="h"><a name="1115"></a>1115</td><td></td><td></td><td></td><td></td><td class="s">            'DIE' =&gt; {</td></tr>
<tr><td class="h"><a name="1116"></a>1116</td><td></td><td></td><td></td><td></td><td class="s">              source_session =&gt; $source_session,</td></tr>
<tr><td class="h"><a name="1117"></a>1117</td><td></td><td></td><td></td><td></td><td class="s">              dest_session =&gt; $session,</td></tr>
<tr><td class="h"><a name="1118"></a>1118</td><td></td><td></td><td></td><td></td><td class="s">              event =&gt; $event,</td></tr>
<tr><td class="h"><a name="1119"></a>1119</td><td></td><td></td><td></td><td></td><td class="s">              file =&gt; $file,</td></tr>
<tr><td class="h"><a name="1120"></a>1120</td><td></td><td></td><td></td><td></td><td class="s">              line =&gt; $line,</td></tr>
<tr><td class="h"><a name="1121"></a>1121</td><td></td><td></td><td></td><td></td><td class="s">              from_state =&gt; $fromstate,</td></tr>
<tr><td class="h"><a name="1122"></a>1122</td><td></td><td></td><td></td><td></td><td class="s">              error_str =&gt; $@,</td></tr>
<tr><td class="h"><a name="1123"></a>1123</td><td></td><td></td><td></td><td></td><td class="s">            },</td></tr>
<tr><td class="h"><a name="1124"></a>1124</td><td></td><td></td><td></td><td></td><td class="s">          ], __FILE__, __LINE__, undef</td></tr>
<tr><td class="h"><a name="1125"></a>1125</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="1126"></a>1126</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="1127"></a>1127</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1128"></a>1128</td><td></td><td></td><td></td><td></td><td class="s">    else {</td></tr>
<tr><td class="h"><a name="1129"></a>1129</td><td></td><td></td><td></td><td></td><td class="s">      # Propagate the exception up to the safe rethrow point.</td></tr>
<tr><td class="h"><a name="1130"></a>1130</td><td></td><td></td><td></td><td></td><td class="s">      $kr_exception = $@;</td></tr>
<tr><td class="h"><a name="1131"></a>1131</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1132"></a>1132</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1133"></a>1133</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1134"></a>1134</td><td></td><td></td><td></td><td></td><td class="s">  # Global $sig{__DIE__} changed?  For shame!</td></tr>
<tr><td class="h"><a name="1135"></a>1135</td><td></td><td></td><td></td><td></td><td class="s">  # TODO - This warning is only needed if a SIGDIE handler is active.</td></tr>
<tr><td class="h"><a name="1136"></a>1136</td><td></td><td></td><td></td><td></td><td class="s">  # TODO - Likewise, setting a SIGDIE with a __DIE__ handler in play</td></tr>
<tr><td class="h"><a name="1137"></a>1137</td><td></td><td></td><td></td><td></td><td class="s">  # will be tricky or impossible.  There should be some message.</td></tr>
<tr><td class="h"><a name="1138"></a>1138</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1139"></a>1139</td><td></td><td></td><td></td><td></td><td class="s">  if (</td></tr>
<tr><td class="h"><a name="1140"></a>1140</td><td></td><td></td><td></td><td></td><td class="s">    (not defined $old_sig_die or $old_sig_die eq 'DEFAULT') and</td></tr>
<tr><td class="h"><a name="1141"></a>1141</td><td></td><td></td><td></td><td></td><td class="s">    $SIG{__DIE__} ne \&amp;_dummy_sigdie_handler</td></tr>
<tr><td class="h"><a name="1142"></a>1142</td><td></td><td></td><td></td><td></td><td class="s">  ) {</td></tr>
<tr><td class="h"><a name="1143"></a>1143</td><td></td><td></td><td></td><td></td><td class="s">    _warn(</td></tr>
<tr><td class="h"><a name="1144"></a>1144</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;sg&gt; Event handler redefined global __DIE__ signal handler.\n&quot;,</td></tr>
<tr><td class="h"><a name="1145"></a>1145</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;sg&gt; This may conflict with CATCH_EXCEPTIONS handling.\n&quot;,</td></tr>
<tr><td class="h"><a name="1146"></a>1146</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;sg&gt; If global redefinition is necessary, do it in global code.\n&quot;,</td></tr>
<tr><td class="h"><a name="1147"></a>1147</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1148"></a>1148</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1149"></a>1149</td><td></td><td></td><td></td><td></td><td class="s">    $SIG{__DIE__} = $old_sig_die;</td></tr>
<tr><td class="h"><a name="1150"></a>1150</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1151"></a>1151</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1152"></a>1152</td><td></td><td></td><td></td><td></td><td class="s">  # Clear out the event arguments list, in case there are POE-ish</td></tr>
<tr><td class="h"><a name="1153"></a>1153</td><td></td><td></td><td></td><td></td><td class="s">  # things in it. This allows them to destruct happily before we set</td></tr>
<tr><td class="h"><a name="1154"></a>1154</td><td></td><td></td><td></td><td></td><td class="s">  # the current session back.</td></tr>
<tr><td class="h"><a name="1155"></a>1155</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1156"></a>1156</td><td></td><td></td><td></td><td></td><td class="s">  @$etc = ( );</td></tr>
<tr><td class="h"><a name="1157"></a>1157</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1158"></a>1158</td><td></td><td></td><td></td><td></td><td class="s">  # Stringify the handler's return value if it belongs in the POE</td></tr>
<tr><td class="h"><a name="1159"></a>1159</td><td></td><td></td><td></td><td></td><td class="s">  # namespace.  $return's scope exists beyond the post-dispatch</td></tr>
<tr><td class="h"><a name="1160"></a>1160</td><td></td><td></td><td></td><td></td><td class="s">  # processing, which includes POE's garbage collection.  The scope</td></tr>
<tr><td class="h"><a name="1161"></a>1161</td><td></td><td></td><td></td><td></td><td class="s">  # bleed was known to break determinism in surprising ways.</td></tr>
<tr><td class="h"><a name="1162"></a>1162</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1163"></a>1163</td><td></td><td></td><td></td><td></td><td class="s">  if (defined $return and substr(ref($return), 0, 5) eq 'POE::') {</td></tr>
<tr><td class="h"><a name="1164"></a>1164</td><td></td><td></td><td></td><td></td><td class="s">    $return = &quot;$return&quot;;</td></tr>
<tr><td class="h"><a name="1165"></a>1165</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1166"></a>1166</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1167"></a>1167</td><td></td><td></td><td></td><td></td><td class="s">  # Pop the active session and event, now that they're no longer</td></tr>
<tr><td class="h"><a name="1168"></a>1168</td><td></td><td></td><td></td><td></td><td class="s">  # active.</td></tr>
<tr><td class="h"><a name="1169"></a>1169</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1170"></a>1170</td><td></td><td></td><td></td><td></td><td class="s">  ($kr_active_session, $kr_active_event, $kr_active_event_type) = (</td></tr>
<tr><td class="h"><a name="1171"></a>1171</td><td></td><td></td><td></td><td></td><td class="s">    $hold_active_session, $hold_active_event, $hold_active_event_type</td></tr>
<tr><td class="h"><a name="1172"></a>1172</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1173"></a>1173</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1174"></a>1174</td><td></td><td></td><td></td><td></td><td class="s">  if (TRACE_EVENTS) {</td></tr>
<tr><td class="h"><a name="1175"></a>1175</td><td></td><td></td><td></td><td></td><td class="s">    my $string_ret = $return;</td></tr>
<tr><td class="h"><a name="1176"></a>1176</td><td></td><td></td><td></td><td></td><td class="s">    $string_ret = &quot;undef&quot; unless defined $string_ret;</td></tr>
<tr><td class="h"><a name="1177"></a>1177</td><td></td><td></td><td></td><td></td><td class="s">    _warn(&quot;&lt;ev&gt; event $seq ``$event'' returns ($string_ret)\n&quot;);</td></tr>
<tr><td class="h"><a name="1178"></a>1178</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1179"></a>1179</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1180"></a>1180</td><td></td><td></td><td></td><td></td><td class="s">  # Return doesn't matter unless ET_CALL, ET_START or ET_STOP.</td></tr>
<tr><td class="h"><a name="1181"></a>1181</td><td></td><td></td><td></td><td></td><td class="s">  return unless $type &amp; (ET_CALL | ET_START | ET_STOP);</td></tr>
<tr><td class="h"><a name="1182"></a>1182</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1183"></a>1183</td><td></td><td></td><td></td><td></td><td class="s">  # Return what the handler did.  This is used for call().</td></tr>
<tr><td class="h"><a name="1184"></a>1184</td><td></td><td></td><td></td><td></td><td class="s">  return( $wantarray ? @$return : $return );</td></tr>
<tr><td class="h"><a name="1185"></a>1185</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1186"></a>1186</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1187"></a>1187</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="1188"></a>1188</td><td></td><td></td><td></td><td></td><td class="s"># POE's main loop!  Now with Tk and Event support!</td></tr>
<tr><td class="h"><a name="1189"></a>1189</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1190"></a>1190</td><td></td><td></td><td></td><td></td><td class="s"># Do pre-run start-up.  Initialize the event loop, and allocate a</td></tr>
<tr><td class="h"><a name="1191"></a>1191</td><td></td><td></td><td></td><td></td><td class="s"># session structure to represent the Kernel.</td></tr>
<tr><td class="h"><a name="1192"></a>1192</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1193"></a>1193</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 27Âµs (10+18) within POE::Kernel::_initialize_kernel_session which was called:
#    once (10Âµs+18Âµs) by POE::Kernel::new at <a href="POE-Kernel-pm-54-sub.html#847">line 847</a></div></div>sub _initialize_kernel_session {</td></tr>
<tr><td class="h"><a name="1194"></a>1194</td><td class="c3">5</td><td class="c3"><span title="Avg 1Âµs">6Âµs</span></td><td></td><td></td><td class="s">  my $self = shift;</td></tr>
<tr><td class="h"><a name="1195"></a>1195</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1196"></a>1196</td><td></td><td></td><td class="c3">1</td><td class="c3">5Âµs</td><td class="s">  $self-&gt;loop_initialize();<div class="calls"><div class="calls_out">  # spent     5Âµs making 1 call to <a href="POE-Loop-Select-pm-59-sub.html#45">POE::Kernel::loop_initialize</a></div></div></td></tr>
<tr><td class="h"><a name="1197"></a>1197</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1198"></a>1198</td><td></td><td></td><td></td><td></td><td class="s">  $kr_exception = undef;</td></tr>
<tr><td class="h"><a name="1199"></a>1199</td><td></td><td></td><td></td><td></td><td class="s">  $kr_active_session = $self;</td></tr>
<tr><td class="h"><a name="1200"></a>1200</td><td></td><td></td><td class="c3">1</td><td class="c3">13Âµs</td><td class="s">  $self-&gt;_data_ses_allocate($self, $self-&gt;[KR_ID], undef);<div class="calls"><div class="calls_out">  # spent    13Âµs making 1 call to <a href="POE-Resource-Sessions-pm-82-sub.html#93">POE::Kernel::_data_ses_allocate</a></div></div></td></tr>
<tr><td class="h"><a name="1201"></a>1201</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1202"></a>1202</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1203"></a>1203</td><td></td><td></td><td></td><td></td><td class="s"># Do post-run cleanup.</td></tr>
<tr><td class="h"><a name="1204"></a>1204</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1205"></a>1205</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.10ms (346Âµs+754Âµs) within POE::Kernel::_finalize_kernel which was called:
#    once (346Âµs+754Âµs) by POE::Kernel::run at <a href="POE-Kernel-pm-54-sub.html#1281">line 1281</a></div></div>sub _finalize_kernel {</td></tr>
<tr><td class="h"><a name="1206"></a>1206</td><td class="c0">45</td><td class="c1"><span title="Avg 4Âµs">164Âµs</span></td><td></td><td></td><td class="s">  my $self = shift;</td></tr>
<tr><td class="h"><a name="1207"></a>1207</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1208"></a>1208</td><td></td><td></td><td></td><td></td><td class="s">  # Disable signal watching since there's now no place for them to go.</td></tr>
<tr><td class="h"><a name="1209"></a>1209</td><td></td><td></td><td class="c3">1</td><td class="c3">12Âµs</td><td class="s">  foreach ($self-&gt;_data_sig_get_safe_signals()) {<div class="calls"><div class="calls_out">  # spent    12Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#210">POE::Kernel::_data_sig_get_safe_signals</a></div></div></td></tr>
<tr><td class="h"><a name="1210"></a>1210</td><td></td><td></td><td class="c0">34</td><td class="c0">417Âµs</td><td class="s">    $self-&gt;loop_ignore_signal($_);<div class="calls"><div class="calls_out">    # spent   417Âµs making 34 calls to <a href="POE-Loop-PerlSignals-pm-60-sub.html#126">POE::Kernel::loop_ignore_signal</a>, avg 12Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1211"></a>1211</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1212"></a>1212</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1213"></a>1213</td><td></td><td></td><td></td><td></td><td class="s">  # Remove the kernel session's signal watcher.</td></tr>
<tr><td class="h"><a name="1214"></a>1214</td><td></td><td></td><td class="c3">2</td><td class="c3">26Âµs</td><td class="s">  $self-&gt;_data_sig_remove($self-&gt;ID, &quot;IDLE&quot;);<div class="calls"><div class="calls_out">  # spent    23Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#352">POE::Kernel::_data_sig_remove</a>
  # spent     3Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#2482">POE::Kernel::ID</a></div></div></td></tr>
<tr><td class="h"><a name="1215"></a>1215</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1216"></a>1216</td><td></td><td></td><td></td><td></td><td class="s">  # The main loop is done, no matter which event library ran it.</td></tr>
<tr><td class="h"><a name="1217"></a>1217</td><td></td><td></td><td></td><td></td><td class="s">  # sig before loop so that it clears the signal_pipe file handler</td></tr>
<tr><td class="h"><a name="1218"></a>1218</td><td></td><td></td><td class="c3">1</td><td class="c0">192Âµs</td><td class="s">  $self-&gt;_data_sig_finalize();<div class="calls"><div class="calls_out">  # spent   192Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#217">POE::Kernel::_data_sig_finalize</a></div></div></td></tr>
<tr><td class="h"><a name="1219"></a>1219</td><td></td><td></td><td class="c3">1</td><td class="c1">64Âµs</td><td class="s">  $self-&gt;loop_finalize();<div class="calls"><div class="calls_out">  # spent    64Âµs making 1 call to <a href="POE-Loop-Select-pm-59-sub.html#55">POE::Kernel::loop_finalize</a></div></div></td></tr>
<tr><td class="h"><a name="1220"></a>1220</td><td></td><td></td><td class="c3">1</td><td class="c3">6Âµs</td><td class="s">  $self-&gt;_data_extref_finalize();<div class="calls"><div class="calls_out">  # spent     6Âµs making 1 call to <a href="POE-Resource-Extrefs-pm-69-sub.html#33">POE::Kernel::_data_extref_finalize</a></div></div></td></tr>
<tr><td class="h"><a name="1221"></a>1221</td><td></td><td></td><td class="c3">1</td><td class="c3">6Âµs</td><td class="s">  $self-&gt;_data_sid_finalize();<div class="calls"><div class="calls_out">  # spent     6Âµs making 1 call to <a href="POE-Resource-SIDs-pm-79-sub.html#37">POE::Kernel::_data_sid_finalize</a></div></div></td></tr>
<tr><td class="h"><a name="1222"></a>1222</td><td></td><td></td><td class="c3">1</td><td class="c3">8Âµs</td><td class="s">  $self-&gt;_data_alias_finalize();<div class="calls"><div class="calls_out">  # spent     8Âµs making 1 call to <a href="POE-Resource-Aliases-pm-63-sub.html#42">POE::Kernel::_data_alias_finalize</a></div></div></td></tr>
<tr><td class="h"><a name="1223"></a>1223</td><td></td><td></td><td class="c3">1</td><td class="c3">8Âµs</td><td class="s">  $self-&gt;_data_handle_finalize();<div class="calls"><div class="calls_out">  # spent     8Âµs making 1 call to <a href="POE-Resource-FileHandles-pm-72-sub.html#125">POE::Kernel::_data_handle_finalize</a></div></div></td></tr>
<tr><td class="h"><a name="1224"></a>1224</td><td></td><td></td><td class="c3">1</td><td class="c3">8Âµs</td><td class="s">  $self-&gt;_data_ev_finalize();<div class="calls"><div class="calls_out">  # spent     8Âµs making 1 call to <a href="POE-Resource-Events-pm-66-sub.html#44">POE::Kernel::_data_ev_finalize</a></div></div></td></tr>
<tr><td class="h"><a name="1225"></a>1225</td><td></td><td></td><td class="c3">1</td><td class="c3">7Âµs</td><td class="s">  $self-&gt;_data_ses_finalize();<div class="calls"><div class="calls_out">  # spent     7Âµs making 1 call to <a href="POE-Resource-Sessions-pm-82-sub.html#63">POE::Kernel::_data_ses_finalize</a></div></div></td></tr>
<tr><td class="h"><a name="1226"></a>1226</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1227"></a>1227</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1228"></a>1228</td><td></td><td></td><td></td><td></td><td class="s">sub run_while {</td></tr>
<tr><td class="h"><a name="1229"></a>1229</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $scalar_ref) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1230"></a>1230</td><td></td><td></td><td></td><td></td><td class="s">  1 while $$scalar_ref and $self-&gt;run_one_timeslice();</td></tr>
<tr><td class="h"><a name="1231"></a>1231</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1232"></a>1232</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1233"></a>1233</td><td></td><td></td><td></td><td></td><td class="s">sub run_one_timeslice {</td></tr>
<tr><td class="h"><a name="1234"></a>1234</td><td></td><td></td><td></td><td></td><td class="s">  my $self = $poe_kernel;</td></tr>
<tr><td class="h"><a name="1235"></a>1235</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1236"></a>1236</td><td></td><td></td><td></td><td></td><td class="s">  unless ($self-&gt;_data_ses_count()) {</td></tr>
<tr><td class="h"><a name="1237"></a>1237</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_finalize_kernel();</td></tr>
<tr><td class="h"><a name="1238"></a>1238</td><td></td><td></td><td></td><td></td><td class="s">    $kr_run_warning |= KR_RUN_DONE;</td></tr>
<tr><td class="h"><a name="1239"></a>1239</td><td></td><td></td><td></td><td></td><td class="s">    $kr_exception and $self-&gt;_rethrow_kr_exception();</td></tr>
<tr><td class="h"><a name="1240"></a>1240</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1241"></a>1241</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1242"></a>1242</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1243"></a>1243</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;loop_do_timeslice();</td></tr>
<tr><td class="h"><a name="1244"></a>1244</td><td></td><td></td><td></td><td></td><td class="s">  $kr_exception and $self-&gt;_rethrow_kr_exception();</td></tr>
<tr><td class="h"><a name="1245"></a>1245</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1246"></a>1246</td><td></td><td></td><td></td><td></td><td class="s">  return 1;</td></tr>
<tr><td class="h"><a name="1247"></a>1247</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1248"></a>1248</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1249"></a>1249</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 9.94s (29Âµs+9.94) within POE::Kernel::run which was called:
#    once (29Âµs+9.94s) by main::RUNTIME at <a href="t-simple_parallel_superbig-t-1-sub.html#165">line 165 of t/simple_parallel_superbig.t</a></div></div>sub run {</td></tr>
<tr><td class="h"><a name="1250"></a>1250</td><td></td><td></td><td></td><td></td><td class="s">  # So run() can be called as a class method.</td></tr>
<tr><td class="h"><a name="1251"></a>1251</td><td class="c0">10</td><td class="c3"><span title="Avg 2Âµs">22Âµs</span></td><td></td><td></td><td class="s">  POE::Kernel-&gt;new unless defined $poe_kernel;</td></tr>
<tr><td class="h"><a name="1252"></a>1252</td><td></td><td></td><td></td><td></td><td class="s">  my $self = $poe_kernel;</td></tr>
<tr><td class="h"><a name="1253"></a>1253</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1254"></a>1254</td><td></td><td></td><td></td><td></td><td class="s">  # Flag that run() was called.</td></tr>
<tr><td class="h"><a name="1255"></a>1255</td><td></td><td></td><td></td><td></td><td class="s">  $kr_run_warning |= KR_RUN_CALLED;</td></tr>
<tr><td class="h"><a name="1256"></a>1256</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1257"></a>1257</td><td></td><td></td><td></td><td></td><td class="s">  # TODO is this check expensive? ( do people run() more than 1 time? )</td></tr>
<tr><td class="h"><a name="1258"></a>1258</td><td></td><td></td><td></td><td></td><td class="s">  if( $kr_pid != $$ ) {</td></tr>
<tr><td class="h"><a name="1259"></a>1259</td><td></td><td></td><td></td><td></td><td class="s">    if ( ASSERT_USAGE ) {</td></tr>
<tr><td class="h"><a name="1260"></a>1260</td><td></td><td></td><td></td><td></td><td class="s">      _warn &quot;Detected a fork, automatically calling -&gt;has_forked()&quot;;</td></tr>
<tr><td class="h"><a name="1261"></a>1261</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1262"></a>1262</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;has_forked;</td></tr>
<tr><td class="h"><a name="1263"></a>1263</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1264"></a>1264</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1265"></a>1265</td><td></td><td></td><td></td><td></td><td class="s">  # Don't run the loop if we have no sessions</td></tr>
<tr><td class="h"><a name="1266"></a>1266</td><td></td><td></td><td></td><td></td><td class="s">  # Loop::Event will blow up, so we're doing this sanity check</td></tr>
<tr><td class="h"><a name="1267"></a>1267</td><td></td><td></td><td class="c3">1</td><td class="c3">2Âµs</td><td class="s">  if ( $self-&gt;_data_ses_count() == 0 ) {<div class="calls"><div class="calls_out">  # spent     2Âµs making 1 call to <a href="POE-Resource-Sessions-pm-82-sub.html#513">POE::Kernel::_data_ses_count</a></div></div></td></tr>
<tr><td class="h"><a name="1268"></a>1268</td><td></td><td></td><td></td><td></td><td class="s">    # Emit noise only if we are under debug mode</td></tr>
<tr><td class="h"><a name="1269"></a>1269</td><td></td><td></td><td></td><td></td><td class="s">    if ( ASSERT_DATA ) {</td></tr>
<tr><td class="h"><a name="1270"></a>1270</td><td></td><td></td><td></td><td></td><td class="s">      _warn(&quot;Not running the event loop because we have no sessions!\n&quot;);</td></tr>
<tr><td class="h"><a name="1271"></a>1271</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1272"></a>1272</td><td></td><td></td><td></td><td></td><td class="s">  } else {</td></tr>
<tr><td class="h"><a name="1273"></a>1273</td><td></td><td></td><td></td><td></td><td class="s">    # All signals must be explicitly watched now.  We do it here because</td></tr>
<tr><td class="h"><a name="1274"></a>1274</td><td></td><td></td><td></td><td></td><td class="s">    # it's too early in initialize_kernel_session.</td></tr>
<tr><td class="h"><a name="1275"></a>1275</td><td></td><td></td><td class="c3">1</td><td class="c3">17Âµs</td><td class="s">    $self-&gt;_data_sig_add($self, &quot;IDLE&quot;, EN_SIGNAL);<div class="calls"><div class="calls_out">    # spent    17Âµs making 1 call to <a href="POE-Resource-Signals-pm-85-sub.html#311">POE::Kernel::_data_sig_add</a></div></div></td></tr>
<tr><td class="h"><a name="1276"></a>1276</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1277"></a>1277</td><td></td><td></td><td></td><td></td><td class="s">    # Run the loop!</td></tr>
<tr><td class="h"><a name="1278"></a>1278</td><td></td><td></td><td class="c3">1</td><td class="c0">9.94s</td><td class="s">    $self-&gt;loop_run();<div class="calls"><div class="calls_out">    # spent  9.94s making 1 call to <a href="POE-Loop-Select-pm-59-sub.html#312">POE::Kernel::loop_run</a></div></div></td></tr>
<tr><td class="h"><a name="1279"></a>1279</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1280"></a>1280</td><td></td><td></td><td></td><td></td><td class="s">    # Cleanup</td></tr>
<tr><td class="h"><a name="1281"></a>1281</td><td></td><td></td><td class="c3">1</td><td class="c0">1.10ms</td><td class="s">    $self-&gt;_finalize_kernel();<div class="calls"><div class="calls_out">    # spent  1.10ms making 1 call to <a href="POE-Kernel-pm-54-sub.html#1205">POE::Kernel::_finalize_kernel</a></div></div></td></tr>
<tr><td class="h"><a name="1282"></a>1282</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1283"></a>1283</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1284"></a>1284</td><td></td><td></td><td></td><td></td><td class="s">  # Clean up afterwards.</td></tr>
<tr><td class="h"><a name="1285"></a>1285</td><td></td><td></td><td></td><td></td><td class="s">  $kr_run_warning |= KR_RUN_DONE;</td></tr>
<tr><td class="h"><a name="1286"></a>1286</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1287"></a>1287</td><td></td><td></td><td></td><td></td><td class="s">  $kr_exception and $self-&gt;_rethrow_kr_exception();</td></tr>
<tr><td class="h"><a name="1288"></a>1288</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1289"></a>1289</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1290"></a>1290</td><td></td><td></td><td></td><td></td><td class="s">sub _rethrow_kr_exception {</td></tr>
<tr><td class="h"><a name="1291"></a>1291</td><td></td><td></td><td></td><td></td><td class="s">  my $self = shift;</td></tr>
<tr><td class="h"><a name="1292"></a>1292</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1293"></a>1293</td><td></td><td></td><td></td><td></td><td class="s">  # It's quite common to see people wrap POE::Kernel-&gt;run() in an eval</td></tr>
<tr><td class="h"><a name="1294"></a>1294</td><td></td><td></td><td></td><td></td><td class="s">  # block and start things again if an exception is caught.</td></tr>
<tr><td class="h"><a name="1295"></a>1295</td><td></td><td></td><td></td><td></td><td class="s">  #</td></tr>
<tr><td class="h"><a name="1296"></a>1296</td><td></td><td></td><td></td><td></td><td class="s">  # This little lexical dance is actually important.  It allows</td></tr>
<tr><td class="h"><a name="1297"></a>1297</td><td></td><td></td><td></td><td></td><td class="s">  # $kr_exception to be cleared if the die() is caught.</td></tr>
<tr><td class="h"><a name="1298"></a>1298</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1299"></a>1299</td><td></td><td></td><td></td><td></td><td class="s">  my $exception = $kr_exception;</td></tr>
<tr><td class="h"><a name="1300"></a>1300</td><td></td><td></td><td></td><td></td><td class="s">  $kr_exception = undef;</td></tr>
<tr><td class="h"><a name="1301"></a>1301</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1302"></a>1302</td><td></td><td></td><td></td><td></td><td class="s">  # The die is cast.</td></tr>
<tr><td class="h"><a name="1303"></a>1303</td><td></td><td></td><td></td><td></td><td class="s">  die $exception;</td></tr>
<tr><td class="h"><a name="1304"></a>1304</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1305"></a>1305</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1306"></a>1306</td><td></td><td></td><td></td><td></td><td class="s"># Stops the kernel cold.  XXX Experimental!</td></tr>
<tr><td class="h"><a name="1307"></a>1307</td><td></td><td></td><td></td><td></td><td class="s"># No events happen as a result of this, all structures are cleaned up</td></tr>
<tr><td class="h"><a name="1308"></a>1308</td><td></td><td></td><td></td><td></td><td class="s"># except the kernel's.  Even the current session and POE::Kernel are</td></tr>
<tr><td class="h"><a name="1309"></a>1309</td><td></td><td></td><td></td><td></td><td class="s"># cleaned up, which may introduce inconsistencies in the current</td></tr>
<tr><td class="h"><a name="1310"></a>1310</td><td></td><td></td><td></td><td></td><td class="s"># session... as _dispatch_event() attempts to clean up for a defunct</td></tr>
<tr><td class="h"><a name="1311"></a>1311</td><td></td><td></td><td></td><td></td><td class="s"># session.</td></tr>
<tr><td class="h"><a name="1312"></a>1312</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1313"></a>1313</td><td></td><td></td><td></td><td></td><td class="s">sub stop {</td></tr>
<tr><td class="h"><a name="1314"></a>1314</td><td></td><td></td><td></td><td></td><td class="s">  # So stop() can be called as a class method.</td></tr>
<tr><td class="h"><a name="1315"></a>1315</td><td></td><td></td><td></td><td></td><td class="s">  my $self = $poe_kernel;</td></tr>
<tr><td class="h"><a name="1316"></a>1316</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1317"></a>1317</td><td></td><td></td><td></td><td></td><td class="s">  # May be called when the kernel's already stopped.  Avoid problems</td></tr>
<tr><td class="h"><a name="1318"></a>1318</td><td></td><td></td><td></td><td></td><td class="s">  # trying to find child sessions when the kernel isn't registered.</td></tr>
<tr><td class="h"><a name="1319"></a>1319</td><td></td><td></td><td></td><td></td><td class="s">  if ($self-&gt;_data_ses_exists($self-&gt;ID)) {</td></tr>
<tr><td class="h"><a name="1320"></a>1320</td><td></td><td></td><td></td><td></td><td class="s">    my @children = ($self);</td></tr>
<tr><td class="h"><a name="1321"></a>1321</td><td></td><td></td><td></td><td></td><td class="s">    foreach my $session (@children) {</td></tr>
<tr><td class="h"><a name="1322"></a>1322</td><td></td><td></td><td></td><td></td><td class="s">      push @children, $self-&gt;_data_ses_get_children($session-&gt;ID);</td></tr>
<tr><td class="h"><a name="1323"></a>1323</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1324"></a>1324</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1325"></a>1325</td><td></td><td></td><td></td><td></td><td class="s">    # Don't stop believin'.  Nor the POE::Kernel singleton.</td></tr>
<tr><td class="h"><a name="1326"></a>1326</td><td></td><td></td><td></td><td></td><td class="s">    shift @children;</td></tr>
<tr><td class="h"><a name="1327"></a>1327</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1328"></a>1328</td><td></td><td></td><td></td><td></td><td class="s">    # Walk backwards to avoid inconsistency errors.</td></tr>
<tr><td class="h"><a name="1329"></a>1329</td><td></td><td></td><td></td><td></td><td class="s">    foreach my $session (reverse @children) {</td></tr>
<tr><td class="h"><a name="1330"></a>1330</td><td></td><td></td><td></td><td></td><td class="s">      $self-&gt;_data_ses_free($session-&gt;ID);</td></tr>
<tr><td class="h"><a name="1331"></a>1331</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1332"></a>1332</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1333"></a>1333</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1334"></a>1334</td><td></td><td></td><td></td><td></td><td class="s">  # Roll back whether sessions were started.</td></tr>
<tr><td class="h"><a name="1335"></a>1335</td><td></td><td></td><td></td><td></td><td class="s">  $kr_run_warning &amp;= ~KR_RUN_SESSION;</td></tr>
<tr><td class="h"><a name="1336"></a>1336</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1337"></a>1337</td><td></td><td></td><td></td><td></td><td class="s">  # So new sessions will not be child of the current defunct session.</td></tr>
<tr><td class="h"><a name="1338"></a>1338</td><td></td><td></td><td></td><td></td><td class="s">  $kr_active_session = $self;</td></tr>
<tr><td class="h"><a name="1339"></a>1339</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1340"></a>1340</td><td></td><td></td><td></td><td></td><td class="s">  # The GC mark list may prevent sessions from DESTROYing.</td></tr>
<tr><td class="h"><a name="1341"></a>1341</td><td></td><td></td><td></td><td></td><td class="s">  # Clean it up.</td></tr>
<tr><td class="h"><a name="1342"></a>1342</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_ses_gc_sweep();</td></tr>
<tr><td class="h"><a name="1343"></a>1343</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1344"></a>1344</td><td></td><td></td><td></td><td></td><td class="s">  # Running stop() is recommended in a POE::Wheel::Run coderef</td></tr>
<tr><td class="h"><a name="1345"></a>1345</td><td></td><td></td><td></td><td></td><td class="s">  # Program, before setting up for the next POE::Kernel-&gt;run().  When</td></tr>
<tr><td class="h"><a name="1346"></a>1346</td><td></td><td></td><td></td><td></td><td class="s">  # the PID has changed, imply _data_sig_has_forked() during stop().</td></tr>
<tr><td class="h"><a name="1347"></a>1347</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1348"></a>1348</td><td></td><td></td><td></td><td></td><td class="s">  $poe_kernel-&gt;has_forked() if $kr_pid != $$;</td></tr>
<tr><td class="h"><a name="1349"></a>1349</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1350"></a>1350</td><td></td><td></td><td></td><td></td><td class="s">  # TODO - If we're polling for signals, then the reset gets it wrong.</td></tr>
<tr><td class="h"><a name="1351"></a>1351</td><td></td><td></td><td></td><td></td><td class="s">  # The reset doesn't count sigchld polling.  If we must put this</td></tr>
<tr><td class="h"><a name="1352"></a>1352</td><td></td><td></td><td></td><td></td><td class="s">  # back, it MUST account for all internal events currently in play,</td></tr>
<tr><td class="h"><a name="1353"></a>1353</td><td></td><td></td><td></td><td></td><td class="s">  # or the child process will stall if it reruns POE::Kernel's loop.</td></tr>
<tr><td class="h"><a name="1354"></a>1354</td><td></td><td></td><td></td><td></td><td class="s">  #_idle_queue_reset();</td></tr>
<tr><td class="h"><a name="1355"></a>1355</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1356"></a>1356</td><td></td><td></td><td></td><td></td><td class="s">  return;</td></tr>
<tr><td class="h"><a name="1357"></a>1357</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1358"></a>1358</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1359"></a>1359</td><td></td><td></td><td></td><td></td><td class="s"># Less invasive form of -&gt;stop() + -&gt;run()</td></tr>
<tr><td class="h"><a name="1360"></a>1360</td><td></td><td></td><td></td><td></td><td class="s">sub has_forked {</td></tr>
<tr><td class="h"><a name="1361"></a>1361</td><td></td><td></td><td></td><td></td><td class="s">  if( $kr_pid == $$ ) {</td></tr>
<tr><td class="h"><a name="1362"></a>1362</td><td></td><td></td><td></td><td></td><td class="s">    if ( ASSERT_USAGE ) {</td></tr>
<tr><td class="h"><a name="1363"></a>1363</td><td></td><td></td><td></td><td></td><td class="s">      _warn &quot;You should only call -&gt;has_forked() from the child process.&quot;;</td></tr>
<tr><td class="h"><a name="1364"></a>1364</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1365"></a>1365</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1366"></a>1366</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1367"></a>1367</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1368"></a>1368</td><td></td><td></td><td></td><td></td><td class="s">  # So has_forked() can be called as a class method.</td></tr>
<tr><td class="h"><a name="1369"></a>1369</td><td></td><td></td><td></td><td></td><td class="s">  my $self = $poe_kernel;</td></tr>
<tr><td class="h"><a name="1370"></a>1370</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1371"></a>1371</td><td></td><td></td><td></td><td></td><td class="s">  $kr_pid = $$;</td></tr>
<tr><td class="h"><a name="1372"></a>1372</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_recalc_id();</td></tr>
<tr><td class="h"><a name="1373"></a>1373</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1374"></a>1374</td><td></td><td></td><td></td><td></td><td class="s">  # reset some stuff for the signals</td></tr>
<tr><td class="h"><a name="1375"></a>1375</td><td></td><td></td><td></td><td></td><td class="s">  $poe_kernel-&gt;_data_sig_has_forked;</td></tr>
<tr><td class="h"><a name="1376"></a>1376</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1377"></a>1377</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1378"></a>1378</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="1379"></a>1379</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1380"></a>1380</td><td></td><td></td><td></td><td></td><td class="s">sub DESTROY {</td></tr>
<tr><td class="h"><a name="1381"></a>1381</td><td></td><td></td><td></td><td></td><td class="s">  my $self = shift;</td></tr>
<tr><td class="h"><a name="1382"></a>1382</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1383"></a>1383</td><td></td><td></td><td></td><td></td><td class="s">  # Warn that a session never had the opportunity to run if one was</td></tr>
<tr><td class="h"><a name="1384"></a>1384</td><td></td><td></td><td></td><td></td><td class="s">  # created but run() was never called.</td></tr>
<tr><td class="h"><a name="1385"></a>1385</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1386"></a>1386</td><td></td><td></td><td></td><td></td><td class="s">  unless ($kr_run_warning &amp; KR_RUN_CALLED) {</td></tr>
<tr><td class="h"><a name="1387"></a>1387</td><td></td><td></td><td></td><td></td><td class="s">    if ($kr_run_warning &amp; KR_RUN_SESSION) {</td></tr>
<tr><td class="h"><a name="1388"></a>1388</td><td></td><td></td><td></td><td></td><td class="s">      _warn(</td></tr>
<tr><td class="h"><a name="1389"></a>1389</td><td></td><td></td><td></td><td></td><td class="s">        &quot;Sessions were started, but POE::Kernel's run() method was never\n&quot;,</td></tr>
<tr><td class="h"><a name="1390"></a>1390</td><td></td><td></td><td></td><td></td><td class="s">        &quot;called to execute them.  This usually happens because an error\n&quot;,</td></tr>
<tr><td class="h"><a name="1391"></a>1391</td><td></td><td></td><td></td><td></td><td class="s">        &quot;occurred before POE::Kernel-&gt;run() could be called.  Please fix\n&quot;,</td></tr>
<tr><td class="h"><a name="1392"></a>1392</td><td></td><td></td><td></td><td></td><td class="s">        &quot;any errors above this notice, and be sure that POE::Kernel-&gt;run()\n&quot;,</td></tr>
<tr><td class="h"><a name="1393"></a>1393</td><td></td><td></td><td></td><td></td><td class="s">        &quot;is called.  See documentation for POE::Kernel's run() method for\n&quot;,</td></tr>
<tr><td class="h"><a name="1394"></a>1394</td><td></td><td></td><td></td><td></td><td class="s">        &quot;another way to disable this warning.\n&quot;,</td></tr>
<tr><td class="h"><a name="1395"></a>1395</td><td></td><td></td><td></td><td></td><td class="s">      );</td></tr>
<tr><td class="h"><a name="1396"></a>1396</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1397"></a>1397</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1398"></a>1398</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1399"></a>1399</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1400"></a>1400</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="1401"></a>1401</td><td></td><td></td><td></td><td></td><td class="s"># _invoke_state is what _dispatch_event calls to dispatch a transition</td></tr>
<tr><td class="h"><a name="1402"></a>1402</td><td></td><td></td><td></td><td></td><td class="s"># event.  This is the kernel's _invoke_state so it can receive events.</td></tr>
<tr><td class="h"><a name="1403"></a>1403</td><td></td><td></td><td></td><td></td><td class="s"># These are mostly signals, which are propagated down in</td></tr>
<tr><td class="h"><a name="1404"></a>1404</td><td></td><td></td><td></td><td></td><td class="s"># _dispatch_event.</td></tr>
<tr><td class="h"><a name="1405"></a>1405</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1406"></a>1406</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 173Âµs (86+87) within POE::Kernel::_invoke_state which was called 26 times, avg 7Âµs/call:
# 25 times (82Âµs+87Âµs) by POE::Kernel::_dispatch_event at <a href="POE-Kernel-pm-54-sub.html#1085">line 1085</a>, avg 7Âµs/call
#     once (4Âµs+0s) by POE::Kernel::_dispatch_event at <a href="POE-Kernel-pm-54-sub.html#1072">line 1072</a></div></div>sub _invoke_state {</td></tr>
<tr><td class="h"><a name="1407"></a>1407</td><td class="c0">78</td><td class="c2"><span title="Avg 1Âµs">92Âµs</span></td><td></td><td></td><td class="s">  my ($self, $source_session, $event, $etc) = @_;</td></tr>
<tr><td class="h"><a name="1408"></a>1408</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1409"></a>1409</td><td></td><td></td><td></td><td></td><td class="s">  # This is an event loop to poll for child processes without needing</td></tr>
<tr><td class="h"><a name="1410"></a>1410</td><td></td><td></td><td></td><td></td><td class="s">  # to catch SIGCHLD.</td></tr>
<tr><td class="h"><a name="1411"></a>1411</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1412"></a>1412</td><td></td><td></td><td class="c1">3</td><td class="c0">87Âµs</td><td class="s">  if ($event eq EN_SCPOLL) {<div class="calls"><div class="calls_out">  # spent    82Âµs making 1 call to <a href="POE-Resource-Events-pm-66-sub.html#63">POE::Kernel::_data_ev_enqueue</a>
  # spent     3Âµs making 1 call to <a href="POE-Queue-Array-pm-56-sub.html#121">POE::Queue::Array::get_item_count</a>
  # spent     2Âµs making 1 call to <a href="POE-Resource-FileHandles-pm-72-sub.html#658">POE::Kernel::_data_handle_count</a></div></div></td></tr>
<tr><td class="h"><a name="1413"></a>1413</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_sig_handle_poll_event($etc-&gt;[0]);</td></tr>
<tr><td class="h"><a name="1414"></a>1414</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1415"></a>1415</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1416"></a>1416</td><td></td><td></td><td></td><td></td><td class="s">  # A signal was posted.  Because signals propagate depth-first, this</td></tr>
<tr><td class="h"><a name="1417"></a>1417</td><td></td><td></td><td></td><td></td><td class="s">  # _invoke_state is called last in the dispatch.  If the signal was</td></tr>
<tr><td class="h"><a name="1418"></a>1418</td><td></td><td></td><td></td><td></td><td class="s">  # SIGIDLE, then post a SIGZOMBIE if the main queue is still idle.</td></tr>
<tr><td class="h"><a name="1419"></a>1419</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1420"></a>1420</td><td></td><td></td><td></td><td></td><td class="s">  elsif ($event eq EN_SIGNAL) {</td></tr>
<tr><td class="h"><a name="1421"></a>1421</td><td></td><td></td><td></td><td></td><td class="s">    if ($etc-&gt;[0] eq 'IDLE') {</td></tr>
<tr><td class="h"><a name="1422"></a>1422</td><td></td><td></td><td></td><td></td><td class="s">      unless (</td></tr>
<tr><td class="h"><a name="1423"></a>1423</td><td></td><td></td><td></td><td></td><td class="s">        $kr_queue-&gt;get_item_count() &gt; $idle_queue_size or</td></tr>
<tr><td class="h"><a name="1424"></a>1424</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;_data_handle_count()</td></tr>
<tr><td class="h"><a name="1425"></a>1425</td><td></td><td></td><td></td><td></td><td class="s">      ) {</td></tr>
<tr><td class="h"><a name="1426"></a>1426</td><td></td><td></td><td></td><td></td><td class="s">        $self-&gt;_data_ev_enqueue(</td></tr>
<tr><td class="h"><a name="1427"></a>1427</td><td></td><td></td><td></td><td></td><td class="s">          $self, $self, EN_SIGNAL, ET_SIGNAL, [ 'ZOMBIE' ],</td></tr>
<tr><td class="h"><a name="1428"></a>1428</td><td></td><td></td><td></td><td></td><td class="s">          __FILE__, __LINE__, undef</td></tr>
<tr><td class="h"><a name="1429"></a>1429</td><td></td><td></td><td></td><td></td><td class="s">        );</td></tr>
<tr><td class="h"><a name="1430"></a>1430</td><td></td><td></td><td></td><td></td><td class="s">      }</td></tr>
<tr><td class="h"><a name="1431"></a>1431</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1432"></a>1432</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1433"></a>1433</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1434"></a>1434</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="1435"></a>1435</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1436"></a>1436</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1437"></a>1437</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="1438"></a>1438</td><td></td><td></td><td></td><td></td><td class="s"># SESSIONS</td></tr>
<tr><td class="h"><a name="1439"></a>1439</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="1440"></a>1440</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1441"></a>1441</td><td></td><td></td><td></td><td></td><td class="s"># Dispatch _start to a session, allocating it in the kernel's data</td></tr>
<tr><td class="h"><a name="1442"></a>1442</td><td></td><td></td><td></td><td></td><td class="s"># structures as a side effect.</td></tr>
<tr><td class="h"><a name="1443"></a>1443</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1444"></a>1444</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 26.3ms (723Âµs+25.6) within POE::Kernel::session_alloc which was called 22 times, avg 1.20ms/call:
# 22 times (723Âµs+25.6ms) by POE::Session::try_alloc at <a href="POE-Session-pm-87-sub.html#192">line 192 of POE/Session.pm</a>, avg 1.20ms/call</div></div>sub session_alloc {</td></tr>
<tr><td class="h"><a name="1445"></a>1445</td><td class="c0">264</td><td class="c0"><span title="Avg 2Âµs">563Âµs</span></td><td></td><td></td><td class="s">  my ($self, $session, @args) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1446"></a>1446</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1447"></a>1447</td><td></td><td></td><td></td><td></td><td class="s">  # If we already returned, then we must reinitialize.  This is so</td></tr>
<tr><td class="h"><a name="1448"></a>1448</td><td></td><td></td><td></td><td></td><td class="s">  # $poe_kernel-&gt;run() will work correctly more than once.</td></tr>
<tr><td class="h"><a name="1449"></a>1449</td><td></td><td></td><td></td><td></td><td class="s">  if ($kr_run_warning &amp; KR_RUN_DONE) {</td></tr>
<tr><td class="h"><a name="1450"></a>1450</td><td></td><td></td><td></td><td></td><td class="s">    $kr_run_warning &amp;= ~KR_RUN_DONE;</td></tr>
<tr><td class="h"><a name="1451"></a>1451</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_initialize_kernel_session();</td></tr>
<tr><td class="h"><a name="1452"></a>1452</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_sig_initialize();</td></tr>
<tr><td class="h"><a name="1453"></a>1453</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1454"></a>1454</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1455"></a>1455</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_DATA) {</td></tr>
<tr><td class="h"><a name="1456"></a>1456</td><td></td><td></td><td></td><td></td><td class="s">    if (defined $session-&gt;ID) {</td></tr>
<tr><td class="h"><a name="1457"></a>1457</td><td></td><td></td><td></td><td></td><td class="s">      _trap(</td></tr>
<tr><td class="h"><a name="1458"></a>1458</td><td></td><td></td><td></td><td></td><td class="s">        &quot;&lt;ss&gt; &quot;, $self-&gt;_data_alias_loggable($session-&gt;ID),</td></tr>
<tr><td class="h"><a name="1459"></a>1459</td><td></td><td></td><td></td><td></td><td class="s">        &quot; already allocated\a&quot;</td></tr>
<tr><td class="h"><a name="1460"></a>1460</td><td></td><td></td><td></td><td></td><td class="s">      );</td></tr>
<tr><td class="h"><a name="1461"></a>1461</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1462"></a>1462</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1463"></a>1463</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1464"></a>1464</td><td></td><td></td><td></td><td></td><td class="s">  # Register that a session was created.</td></tr>
<tr><td class="h"><a name="1465"></a>1465</td><td></td><td></td><td></td><td></td><td class="s">  $kr_run_warning |= KR_RUN_SESSION;</td></tr>
<tr><td class="h"><a name="1466"></a>1466</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1467"></a>1467</td><td></td><td></td><td></td><td></td><td class="s">  # Allocate the session's data structure.  This must be done before</td></tr>
<tr><td class="h"><a name="1468"></a>1468</td><td></td><td></td><td></td><td></td><td class="s">  # we dispatch anything regarding the new session.</td></tr>
<tr><td class="h"><a name="1469"></a>1469</td><td></td><td></td><td class="c0">22</td><td class="c2">49Âµs</td><td class="s">  my $new_sid = $self-&gt;_data_sid_allocate();<div class="calls"><div class="calls_out">  # spent    49Âµs making 22 calls to <a href="POE-Resource-SIDs-pm-79-sub.html#48">POE::Kernel::_data_sid_allocate</a>, avg 2Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1470"></a>1470</td><td></td><td></td><td class="c0">22</td><td class="c3">37Âµs</td><td class="s">  $session-&gt;_set_id($new_sid);<div class="calls"><div class="calls_out">  # spent    37Âµs making 22 calls to <a href="POE-Session-pm-87-sub.html#593">POE::Session::_set_id</a>, avg 2Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1471"></a>1471</td><td></td><td></td><td class="c0">44</td><td class="c0">477Âµs</td><td class="s">  $self-&gt;_data_ses_allocate($session, $new_sid, $kr_active_session-&gt;ID);<div class="calls"><div class="calls_out">  # spent   455Âµs making 22 calls to <a href="POE-Resource-Sessions-pm-82-sub.html#93">POE::Kernel::_data_ses_allocate</a>, avg 21Âµs/call
  # spent    13Âµs making 12 calls to <a href="POE-Kernel-pm-54-sub.html#2482">POE::Kernel::ID</a>, avg 1Âµs/call
  # spent     9Âµs making 10 calls to <a href="POE-Session-pm-87-sub.html#598">POE::Session::ID</a>, avg 930ns/call</div></div></td></tr>
<tr><td class="h"><a name="1472"></a>1472</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1473"></a>1473</td><td></td><td></td><td class="c0">22</td><td class="c2">46Âµs</td><td class="s">  my $loggable = $self-&gt;_data_alias_loggable($new_sid);<div class="calls"><div class="calls_out">  # spent    46Âµs making 22 calls to <a href="POE-Resource-Aliases-pm-63-sub.html#126">POE::Kernel::_data_alias_loggable</a>, avg 2Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1474"></a>1474</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1475"></a>1475</td><td></td><td></td><td></td><td></td><td class="s">  # Tell the new session that it has been created.  Catch the _start</td></tr>
<tr><td class="h"><a name="1476"></a>1476</td><td></td><td></td><td></td><td></td><td class="s">  # state's return value so we can pass it to the parent with the</td></tr>
<tr><td class="h"><a name="1477"></a>1477</td><td></td><td></td><td></td><td></td><td class="s">  # _child create.</td></tr>
<tr><td class="h"><a name="1478"></a>1478</td><td></td><td></td><td></td><td></td><td class="s">  #</td></tr>
<tr><td class="h"><a name="1479"></a>1479</td><td></td><td></td><td></td><td></td><td class="s">  # TODO - Void the context if the parent has no _child handler?</td></tr>
<tr><td class="h"><a name="1480"></a>1480</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1481"></a>1481</td><td></td><td></td><td class="c0">44</td><td class="c0">5.10ms</td><td class="s">  my $return = $self-&gt;_dispatch_event(<div class="calls"><div class="calls_out">  # spent  23.9ms making 22 calls to <a href="POE-Kernel-pm-54-sub.html#996">POE::Kernel::_dispatch_event</a>, avg 1.08ms/call, recursion: max depth 1, sum of overlapping time 18.8ms
  # spent    16Âµs making 22 calls to <a href="Time-HiRes-pm-50-sub.html#Time__HiRes__time">Time::HiRes::time</a>, avg 723ns/call</div></div></td></tr>
<tr><td class="h"><a name="1482"></a>1482</td><td></td><td></td><td></td><td></td><td class="s">    $session, $kr_active_session,</td></tr>
<tr><td class="h"><a name="1483"></a>1483</td><td></td><td></td><td></td><td></td><td class="s">    EN_START, ET_START, \@args,</td></tr>
<tr><td class="h"><a name="1484"></a>1484</td><td></td><td></td><td></td><td></td><td class="s">    __FILE__, __LINE__, undef, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="1485"></a>1485</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1486"></a>1486</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1487"></a>1487</td><td></td><td></td><td class="c0">22</td><td class="c3">36Âµs</td><td class="s">  unless($self-&gt;_data_ses_exists($new_sid)) {<div class="calls"><div class="calls_out">  # spent    36Âµs making 22 calls to <a href="POE-Resource-Sessions-pm-82-sub.html#352">POE::Kernel::_data_ses_exists</a>, avg 2Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1488"></a>1488</td><td></td><td></td><td></td><td></td><td class="s">    if(TRACE_SESSIONS) {</td></tr>
<tr><td class="h"><a name="1489"></a>1489</td><td></td><td></td><td></td><td></td><td class="s">      _warn(&quot;&lt;ss&gt; &quot;, $loggable, &quot; disappeared during &quot;, EN_START);</td></tr>
<tr><td class="h"><a name="1490"></a>1490</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1491"></a>1491</td><td></td><td></td><td></td><td></td><td class="s">    return $return;</td></tr>
<tr><td class="h"><a name="1492"></a>1492</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1493"></a>1493</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1494"></a>1494</td><td></td><td></td><td></td><td></td><td class="s">  # If the child has not detached itself---that is, if its parent is</td></tr>
<tr><td class="h"><a name="1495"></a>1495</td><td></td><td></td><td></td><td></td><td class="s">  # the currently active session---then notify the parent with a</td></tr>
<tr><td class="h"><a name="1496"></a>1496</td><td></td><td></td><td></td><td></td><td class="s">  # _child create event.  Otherwise skip it, since we'd otherwise</td></tr>
<tr><td class="h"><a name="1497"></a>1497</td><td></td><td></td><td></td><td></td><td class="s">  # throw a create without a lose.</td></tr>
<tr><td class="h"><a name="1498"></a>1498</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_dispatch_event(</td></tr>
<tr><td class="h"><a name="1499"></a>1499</td><td></td><td></td><td class="c0">88</td><td class="c0">193Âµs</td><td class="s">    $self-&gt;_data_ses_get_parent($session-&gt;ID), $self,<div class="calls"><div class="calls_out">    # spent   286Âµs making 22 calls to <a href="POE-Kernel-pm-54-sub.html#996">POE::Kernel::_dispatch_event</a>, avg 13Âµs/call, recursion: max depth 1, sum of overlapping time 168Âµs
    # spent    38Âµs making 22 calls to <a href="POE-Resource-Sessions-pm-82-sub.html#313">POE::Kernel::_data_ses_get_parent</a>, avg 2Âµs/call
    # spent    19Âµs making 22 calls to <a href="POE-Session-pm-87-sub.html#598">POE::Session::ID</a>, avg 877ns/call
    # spent    17Âµs making 22 calls to <a href="Time-HiRes-pm-50-sub.html#Time__HiRes__time">Time::HiRes::time</a>, avg 764ns/call</div></div></td></tr>
<tr><td class="h"><a name="1500"></a>1500</td><td></td><td></td><td></td><td></td><td class="s">    EN_CHILD, ET_CHILD, [ CHILD_CREATE, $session, $return ],</td></tr>
<tr><td class="h"><a name="1501"></a>1501</td><td></td><td></td><td></td><td></td><td class="s">    __FILE__, __LINE__, undef, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="1502"></a>1502</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1503"></a>1503</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1504"></a>1504</td><td></td><td></td><td class="c0">22</td><td class="c3">29Âµs</td><td class="s">  unless ($self-&gt;_data_ses_exists($new_sid)) {<div class="calls"><div class="calls_out">  # spent    29Âµs making 22 calls to <a href="POE-Resource-Sessions-pm-82-sub.html#352">POE::Kernel::_data_ses_exists</a>, avg 1Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1505"></a>1505</td><td></td><td></td><td></td><td></td><td class="s">    if (TRACE_SESSIONS) {</td></tr>
<tr><td class="h"><a name="1506"></a>1506</td><td></td><td></td><td></td><td></td><td class="s">      _warn(&quot;&lt;ss&gt; &quot;, $loggable, &quot; disappeared during &quot;, EN_CHILD, &quot; dispatch&quot;);</td></tr>
<tr><td class="h"><a name="1507"></a>1507</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="1508"></a>1508</td><td></td><td></td><td></td><td></td><td class="s">    return $return;</td></tr>
<tr><td class="h"><a name="1509"></a>1509</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1510"></a>1510</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1511"></a>1511</td><td></td><td></td><td></td><td></td><td class="s">  # Enqueue a delayed garbage-collection event so the session has time</td></tr>
<tr><td class="h"><a name="1512"></a>1512</td><td></td><td></td><td></td><td></td><td class="s">  # to do its thing before it goes.</td></tr>
<tr><td class="h"><a name="1513"></a>1513</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_ev_enqueue(</td></tr>
<tr><td class="h"><a name="1514"></a>1514</td><td></td><td></td><td class="c0">22</td><td class="c0">685Âµs</td><td class="s">    $session, $session, EN_GC, ET_GC, [],<div class="calls"><div class="calls_out">    # spent   685Âµs making 22 calls to <a href="POE-Resource-Events-pm-66-sub.html#63">POE::Kernel::_data_ev_enqueue</a>, avg 31Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1515"></a>1515</td><td></td><td></td><td></td><td></td><td class="s">    __FILE__, __LINE__, undef</td></tr>
<tr><td class="h"><a name="1516"></a>1516</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1517"></a>1517</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1518"></a>1518</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1519"></a>1519</td><td></td><td></td><td></td><td></td><td class="s"># Detach a session from its parent.  This breaks the parent/child</td></tr>
<tr><td class="h"><a name="1520"></a>1520</td><td></td><td></td><td></td><td></td><td class="s"># relationship between the current session and its parent.  Basically,</td></tr>
<tr><td class="h"><a name="1521"></a>1521</td><td></td><td></td><td></td><td></td><td class="s"># the current session is given to the Kernel session.  Unlike with</td></tr>
<tr><td class="h"><a name="1522"></a>1522</td><td></td><td></td><td></td><td></td><td class="s"># _stop, the current session's children follow their parent.</td></tr>
<tr><td class="h"><a name="1523"></a>1523</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1524"></a>1524</td><td></td><td></td><td></td><td></td><td class="s">sub detach_myself {</td></tr>
<tr><td class="h"><a name="1525"></a>1525</td><td></td><td></td><td></td><td></td><td class="s">  my $self = $poe_kernel;</td></tr>
<tr><td class="h"><a name="1526"></a>1526</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1527"></a>1527</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1528"></a>1528</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call detach_myself() from a running session&quot;</td></tr>
<tr><td class="h"><a name="1529"></a>1529</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="1530"></a>1530</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1531"></a>1531</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1532"></a>1532</td><td></td><td></td><td></td><td></td><td class="s">  # Can't detach from the kernel.</td></tr>
<tr><td class="h"><a name="1533"></a>1533</td><td></td><td></td><td></td><td></td><td class="s">  if ($self-&gt;_data_ses_get_parent($kr_active_session-&gt;ID) == $self) {</td></tr>
<tr><td class="h"><a name="1534"></a>1534</td><td></td><td></td><td></td><td></td><td class="s">    $! = EPERM;</td></tr>
<tr><td class="h"><a name="1535"></a>1535</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1536"></a>1536</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1537"></a>1537</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1538"></a>1538</td><td></td><td></td><td></td><td></td><td class="s">  my $old_parent = $self-&gt;_data_ses_get_parent($kr_active_session-&gt;ID);</td></tr>
<tr><td class="h"><a name="1539"></a>1539</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1540"></a>1540</td><td></td><td></td><td></td><td></td><td class="s">  # Tell the old parent session that the child is departing.</td></tr>
<tr><td class="h"><a name="1541"></a>1541</td><td></td><td></td><td></td><td></td><td class="s">  # But not if the active event is ET_START, since that would generate</td></tr>
<tr><td class="h"><a name="1542"></a>1542</td><td></td><td></td><td></td><td></td><td class="s">  # a CHILD_LOSE without a CHILD_CREATE.</td></tr>
<tr><td class="h"><a name="1543"></a>1543</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_dispatch_event(</td></tr>
<tr><td class="h"><a name="1544"></a>1544</td><td></td><td></td><td></td><td></td><td class="s">    $old_parent, $self,</td></tr>
<tr><td class="h"><a name="1545"></a>1545</td><td></td><td></td><td></td><td></td><td class="s">    EN_CHILD, ET_CHILD, [ CHILD_LOSE, $kr_active_session, undef ],</td></tr>
<tr><td class="h"><a name="1546"></a>1546</td><td></td><td></td><td></td><td></td><td class="s">    (caller)[1,2], undef, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="1547"></a>1547</td><td></td><td></td><td></td><td></td><td class="s">  )</td></tr>
<tr><td class="h"><a name="1548"></a>1548</td><td></td><td></td><td></td><td></td><td class="s">  unless $kr_active_event_type &amp; ET_START;</td></tr>
<tr><td class="h"><a name="1549"></a>1549</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1550"></a>1550</td><td></td><td></td><td></td><td></td><td class="s">  # Tell the new parent (kernel) that it's gaining a child.</td></tr>
<tr><td class="h"><a name="1551"></a>1551</td><td></td><td></td><td></td><td></td><td class="s">  # (Actually it doesn't care, so we don't do that here, but this is</td></tr>
<tr><td class="h"><a name="1552"></a>1552</td><td></td><td></td><td></td><td></td><td class="s">  # where the code would go if it ever does in the future.)</td></tr>
<tr><td class="h"><a name="1553"></a>1553</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1554"></a>1554</td><td></td><td></td><td></td><td></td><td class="s">  # Tell the current session that its parentage is changing.</td></tr>
<tr><td class="h"><a name="1555"></a>1555</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_dispatch_event(</td></tr>
<tr><td class="h"><a name="1556"></a>1556</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $self,</td></tr>
<tr><td class="h"><a name="1557"></a>1557</td><td></td><td></td><td></td><td></td><td class="s">    EN_PARENT, ET_PARENT, [ $old_parent, $self ],</td></tr>
<tr><td class="h"><a name="1558"></a>1558</td><td></td><td></td><td></td><td></td><td class="s">    (caller)[1,2], undef, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="1559"></a>1559</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1560"></a>1560</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1561"></a>1561</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_ses_move_child($kr_active_session-&gt;ID, $self-&gt;ID);</td></tr>
<tr><td class="h"><a name="1562"></a>1562</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1563"></a>1563</td><td></td><td></td><td></td><td></td><td class="s">  # Success!</td></tr>
<tr><td class="h"><a name="1564"></a>1564</td><td></td><td></td><td></td><td></td><td class="s">  return 1;</td></tr>
<tr><td class="h"><a name="1565"></a>1565</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1566"></a>1566</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1567"></a>1567</td><td></td><td></td><td></td><td></td><td class="s"># Detach a child from this, the parent.  The session being detached</td></tr>
<tr><td class="h"><a name="1568"></a>1568</td><td></td><td></td><td></td><td></td><td class="s"># must be a child of the current session.</td></tr>
<tr><td class="h"><a name="1569"></a>1569</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1570"></a>1570</td><td></td><td></td><td></td><td></td><td class="s">sub detach_child {</td></tr>
<tr><td class="h"><a name="1571"></a>1571</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $child) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1572"></a>1572</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1573"></a>1573</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1574"></a>1574</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call detach_child() from a running session&quot;</td></tr>
<tr><td class="h"><a name="1575"></a>1575</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="1576"></a>1576</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1577"></a>1577</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1578"></a>1578</td><td></td><td></td><td></td><td></td><td class="s">  my $child_session = $self-&gt;_resolve_session($child);</td></tr>
<tr><td class="h"><a name="1579"></a>1579</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $child_session) {</td></tr>
<tr><td class="h"><a name="1580"></a>1580</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_resolve_failure($child);</td></tr>
<tr><td class="h"><a name="1581"></a>1581</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1582"></a>1582</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1583"></a>1583</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1584"></a>1584</td><td></td><td></td><td></td><td></td><td class="s">  # Can't detach if it belongs to the kernel.  TODO We shouldn't need</td></tr>
<tr><td class="h"><a name="1585"></a>1585</td><td></td><td></td><td></td><td></td><td class="s">  # to check for this.</td></tr>
<tr><td class="h"><a name="1586"></a>1586</td><td></td><td></td><td></td><td></td><td class="s">  if ($kr_active_session == $self) {</td></tr>
<tr><td class="h"><a name="1587"></a>1587</td><td></td><td></td><td></td><td></td><td class="s">    $! = EPERM;</td></tr>
<tr><td class="h"><a name="1588"></a>1588</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1589"></a>1589</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1590"></a>1590</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1591"></a>1591</td><td></td><td></td><td></td><td></td><td class="s">  # Can't detach if it's not a child of the current session.</td></tr>
<tr><td class="h"><a name="1592"></a>1592</td><td></td><td></td><td></td><td></td><td class="s">  unless (</td></tr>
<tr><td class="h"><a name="1593"></a>1593</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_ses_is_child($kr_active_session-&gt;ID, $child_session-&gt;ID)</td></tr>
<tr><td class="h"><a name="1594"></a>1594</td><td></td><td></td><td></td><td></td><td class="s">  ) {</td></tr>
<tr><td class="h"><a name="1595"></a>1595</td><td></td><td></td><td></td><td></td><td class="s">    $! = EPERM;</td></tr>
<tr><td class="h"><a name="1596"></a>1596</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1597"></a>1597</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1598"></a>1598</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1599"></a>1599</td><td></td><td></td><td></td><td></td><td class="s">  # Tell the current session that the child is departing.</td></tr>
<tr><td class="h"><a name="1600"></a>1600</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_dispatch_event(</td></tr>
<tr><td class="h"><a name="1601"></a>1601</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $self,</td></tr>
<tr><td class="h"><a name="1602"></a>1602</td><td></td><td></td><td></td><td></td><td class="s">    EN_CHILD, ET_CHILD, [ CHILD_LOSE, $child_session, undef ],</td></tr>
<tr><td class="h"><a name="1603"></a>1603</td><td></td><td></td><td></td><td></td><td class="s">    (caller)[1,2], undef, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="1604"></a>1604</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1605"></a>1605</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1606"></a>1606</td><td></td><td></td><td></td><td></td><td class="s">  # Tell the new parent (kernel) that it's gaining a child.</td></tr>
<tr><td class="h"><a name="1607"></a>1607</td><td></td><td></td><td></td><td></td><td class="s">  # (Actually it doesn't care, so we don't do that here, but this is</td></tr>
<tr><td class="h"><a name="1608"></a>1608</td><td></td><td></td><td></td><td></td><td class="s">  # where the code would go if it ever does in the future.)</td></tr>
<tr><td class="h"><a name="1609"></a>1609</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1610"></a>1610</td><td></td><td></td><td></td><td></td><td class="s">  # Tell the child session that its parentage is changing.</td></tr>
<tr><td class="h"><a name="1611"></a>1611</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_dispatch_event(</td></tr>
<tr><td class="h"><a name="1612"></a>1612</td><td></td><td></td><td></td><td></td><td class="s">    $child_session, $self,</td></tr>
<tr><td class="h"><a name="1613"></a>1613</td><td></td><td></td><td></td><td></td><td class="s">    EN_PARENT, ET_PARENT, [ $kr_active_session, $self ],</td></tr>
<tr><td class="h"><a name="1614"></a>1614</td><td></td><td></td><td></td><td></td><td class="s">    (caller)[1,2], undef, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="1615"></a>1615</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1616"></a>1616</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1617"></a>1617</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_ses_move_child($child_session-&gt;ID, $self-&gt;ID);</td></tr>
<tr><td class="h"><a name="1618"></a>1618</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1619"></a>1619</td><td></td><td></td><td></td><td></td><td class="s">  # Success!</td></tr>
<tr><td class="h"><a name="1620"></a>1620</td><td></td><td></td><td></td><td></td><td class="s">  return 1;</td></tr>
<tr><td class="h"><a name="1621"></a>1621</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1622"></a>1622</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1623"></a>1623</td><td></td><td></td><td></td><td></td><td class="s">### Helpful accessors.</td></tr>
<tr><td class="h"><a name="1624"></a>1624</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1625"></a>1625</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 22Âµs within POE::Kernel::get_active_session which was called 23 times, avg 974ns/call:
# 23 times (22Âµs+0s) by POE::Kernel::_data_ses_stop at <a href="POE-Resource-Sessions-pm-82-sub.html#568">line 568 of POE/Resource/Sessions.pm</a>, avg 974ns/call</div></div>sub get_active_session {</td></tr>
<tr><td class="h"><a name="1626"></a>1626</td><td class="c0">23</td><td class="c3"><span title="Avg 2Âµs">48Âµs</span></td><td></td><td></td><td class="s">  return $kr_active_session;</td></tr>
<tr><td class="h"><a name="1627"></a>1627</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1628"></a>1628</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1629"></a>1629</td><td></td><td></td><td></td><td></td><td class="s">sub get_active_event {</td></tr>
<tr><td class="h"><a name="1630"></a>1630</td><td></td><td></td><td></td><td></td><td class="s">  return $kr_active_event;</td></tr>
<tr><td class="h"><a name="1631"></a>1631</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1632"></a>1632</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1633"></a>1633</td><td></td><td></td><td></td><td></td><td class="s"># FIXME - Should this exist?</td></tr>
<tr><td class="h"><a name="1634"></a>1634</td><td></td><td></td><td></td><td></td><td class="s">sub get_event_count {</td></tr>
<tr><td class="h"><a name="1635"></a>1635</td><td></td><td></td><td></td><td></td><td class="s">  return $kr_queue-&gt;get_item_count();</td></tr>
<tr><td class="h"><a name="1636"></a>1636</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1637"></a>1637</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1638"></a>1638</td><td></td><td></td><td></td><td></td><td class="s"># FIXME - Should this exist?</td></tr>
<tr><td class="h"><a name="1639"></a>1639</td><td></td><td></td><td></td><td></td><td class="s">sub get_next_event_time {</td></tr>
<tr><td class="h"><a name="1640"></a>1640</td><td></td><td></td><td></td><td></td><td class="s">  return $kr_queue-&gt;get_next_priority();</td></tr>
<tr><td class="h"><a name="1641"></a>1641</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1642"></a>1642</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1643"></a>1643</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="1644"></a>1644</td><td></td><td></td><td></td><td></td><td class="s"># EVENTS</td></tr>
<tr><td class="h"><a name="1645"></a>1645</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="1646"></a>1646</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1647"></a>1647</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="1648"></a>1648</td><td></td><td></td><td></td><td></td><td class="s"># Post an event to the queue.</td></tr>
<tr><td class="h"><a name="1649"></a>1649</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1650"></a>1650</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 101Âµs (20+80) within POE::Kernel::post which was called 2 times, avg 50Âµs/call:
# 2 times (20Âµs+80Âµs) by main::__ANON__[t/simple_parallel_superbig.t:52] at <a href="t-simple_parallel_superbig-t-1-sub.html#51">line 51 of t/simple_parallel_superbig.t</a>, avg 50Âµs/call</div></div>sub post {</td></tr>
<tr><td class="h"><a name="1651"></a>1651</td><td class="c0">10</td><td class="c3"><span title="Avg 2Âµs">17Âµs</span></td><td></td><td></td><td class="s">  my ($self, $dest_session, $event_name, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1652"></a>1652</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1653"></a>1653</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1654"></a>1654</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; destination is undefined in post()&quot;</td></tr>
<tr><td class="h"><a name="1655"></a>1655</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $dest_session;</td></tr>
<tr><td class="h"><a name="1656"></a>1656</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; event is undefined in post()&quot; unless defined $event_name;</td></tr>
<tr><td class="h"><a name="1657"></a>1657</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="1658"></a>1658</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="1659"></a>1659</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by posting it&quot;</td></tr>
<tr><td class="h"><a name="1660"></a>1660</td><td></td><td></td><td></td><td></td><td class="s">    ) if exists $poes_own_events{$event_name};</td></tr>
<tr><td class="h"><a name="1661"></a>1661</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="1662"></a>1662</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1663"></a>1663</td><td></td><td></td><td></td><td></td><td class="s">  # Attempt to resolve the destination session reference against</td></tr>
<tr><td class="h"><a name="1664"></a>1664</td><td></td><td></td><td></td><td></td><td class="s">  # various things.</td></tr>
<tr><td class="h"><a name="1665"></a>1665</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1666"></a>1666</td><td></td><td></td><td class="c3">2</td><td class="c3">29Âµs</td><td class="s">  my $session = $self-&gt;_resolve_session($dest_session);<div class="calls"><div class="calls_out">  # spent    29Âµs making 2 calls to <a href="POE-Kernel-pm-54-sub.html#583">POE::Kernel::_resolve_session</a>, avg 15Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1667"></a>1667</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $session) {</td></tr>
<tr><td class="h"><a name="1668"></a>1668</td><td></td><td></td><td class="c3">1</td><td class="c3">3Âµs</td><td class="s">    $self-&gt;_explain_resolve_failure($dest_session);<div class="calls"><div class="calls_out">    # spent     3Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#655">POE::Kernel::_explain_resolve_failure</a></div></div></td></tr>
<tr><td class="h"><a name="1669"></a>1669</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1670"></a>1670</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1671"></a>1671</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1672"></a>1672</td><td></td><td></td><td></td><td></td><td class="s">  # Enqueue the event for &quot;now&quot;, which simulates FIFO in our</td></tr>
<tr><td class="h"><a name="1673"></a>1673</td><td></td><td></td><td></td><td></td><td class="s">  # time-ordered queue.</td></tr>
<tr><td class="h"><a name="1674"></a>1674</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1675"></a>1675</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_ev_enqueue(</td></tr>
<tr><td class="h"><a name="1676"></a>1676</td><td></td><td></td><td class="c3">1</td><td class="c2">48Âµs</td><td class="s">    $session, $kr_active_session, $event_name, ET_POST, \@etc,<div class="calls"><div class="calls_out">    # spent    48Âµs making 1 call to <a href="POE-Resource-Events-pm-66-sub.html#63">POE::Kernel::_data_ev_enqueue</a></div></div></td></tr>
<tr><td class="h"><a name="1677"></a>1677</td><td></td><td></td><td></td><td></td><td class="s">    (caller)[1,2], $kr_active_event</td></tr>
<tr><td class="h"><a name="1678"></a>1678</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1679"></a>1679</td><td></td><td></td><td></td><td></td><td class="s">  return 1;</td></tr>
<tr><td class="h"><a name="1680"></a>1680</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1681"></a>1681</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1682"></a>1682</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="1683"></a>1683</td><td></td><td></td><td></td><td></td><td class="s"># Post an event to the queue for the current session.</td></tr>
<tr><td class="h"><a name="1684"></a>1684</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1685"></a>1685</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 5.31ms (193Âµs+5.11) within POE::Kernel::yield which was called 31 times, avg 171Âµs/call:
# 10 times (49Âµs+4.09ms) by POE::Component::Client::TCP::__ANON__[/usr/local/share/perl/5.18.2/POE/Component/Client/TCP.pm:149] at <a href="POE-Component-Client-TCP-pm-88-sub.html#147">line 147 of POE/Component/Client/TCP.pm</a>, avg 414Âµs/call
# 10 times (80Âµs+562Âµs) by main::__ANON__[t/simple_parallel_superbig.t:138] at <a href="t-simple_parallel_superbig-t-1-sub.html#134">line 134 of t/simple_parallel_superbig.t</a>, avg 64Âµs/call
# 10 times (60Âµs+423Âµs) by POE::Component::Server::TCP::__ANON__[/usr/local/share/perl/5.18.2/POE/Component/Server/TCP.pm:364] at <a href="POE-Component-Server-TCP-pm-105-sub.html#361">line 361 of POE/Component/Server/TCP.pm</a>, avg 48Âµs/call
#     once (4Âµs+37Âµs) by main::__ANON__[t/simple_parallel_superbig.t:159] at <a href="t-simple_parallel_superbig-t-1-sub.html#159">line 159 of t/simple_parallel_superbig.t</a></div></div>sub yield {</td></tr>
<tr><td class="h"><a name="1686"></a>1686</td><td class="c0">93</td><td class="c0"><span title="Avg 2Âµs">202Âµs</span></td><td></td><td></td><td class="s">  my ($self, $event_name, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1687"></a>1687</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1688"></a>1688</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1689"></a>1689</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call yield() from a running session&quot;</td></tr>
<tr><td class="h"><a name="1690"></a>1690</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="1691"></a>1691</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; event name is undefined in yield()&quot;</td></tr>
<tr><td class="h"><a name="1692"></a>1692</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $event_name;</td></tr>
<tr><td class="h"><a name="1693"></a>1693</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="1694"></a>1694</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="1695"></a>1695</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by yielding it&quot;</td></tr>
<tr><td class="h"><a name="1696"></a>1696</td><td></td><td></td><td></td><td></td><td class="s">    ) if exists $poes_own_events{$event_name};</td></tr>
<tr><td class="h"><a name="1697"></a>1697</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="1698"></a>1698</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1699"></a>1699</td><td></td><td></td><td class="c0">31</td><td class="c0">5.11ms</td><td class="s">  $self-&gt;_data_ev_enqueue(<div class="calls"><div class="calls_out">  # spent  5.11ms making 31 calls to <a href="POE-Resource-Events-pm-66-sub.html#63">POE::Kernel::_data_ev_enqueue</a>, avg 165Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1700"></a>1700</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $kr_active_session, $event_name, ET_POST, \@etc,</td></tr>
<tr><td class="h"><a name="1701"></a>1701</td><td></td><td></td><td></td><td></td><td class="s">    (caller)[1,2], $kr_active_event</td></tr>
<tr><td class="h"><a name="1702"></a>1702</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="1703"></a>1703</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1704"></a>1704</td><td></td><td></td><td></td><td></td><td class="s">  undef;</td></tr>
<tr><td class="h"><a name="1705"></a>1705</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1706"></a>1706</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1707"></a>1707</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="1708"></a>1708</td><td></td><td></td><td></td><td></td><td class="s"># Call an event handler directly.</td></tr>
<tr><td class="h"><a name="1709"></a>1709</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1710"></a>1710</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 176ms (14.3+162) within POE::Kernel::call which was called 80 times, avg 2.20ms/call:
# 20 times (13.4ms+66.7ms) by POE::Wheel::ReadWrite::__ANON__[/usr/local/share/perl/5.18.2/POE/Wheel/ReadWrite.pm:293] at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#283">line 283 of POE/Wheel/ReadWrite.pm</a>, avg 4.01ms/call
# 20 times (332Âµs+451Âµs) by POE::Wheel::ReadWrite::__ANON__[/usr/local/share/perl/5.18.2/POE/Wheel/ReadWrite.pm:231] at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#229">line 229 of POE/Wheel/ReadWrite.pm</a>, avg 39Âµs/call
# 10 times (149Âµs+72.0ms) by POE::Wheel::SocketFactory::__ANON__[/usr/local/share/perl/5.18.2/POE/Wheel/SocketFactory.pm:320] at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#316">line 316 of POE/Wheel/SocketFactory.pm</a>, avg 7.22ms/call
# 10 times (138Âµs+21.5ms) by POE::Wheel::SocketFactory::__ANON__[/usr/local/share/perl/5.18.2/POE/Wheel/SocketFactory.pm:203] at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#190">line 190 of POE/Wheel/SocketFactory.pm</a>, avg 2.17ms/call
# 10 times (122Âµs+784Âµs) by POE::Wheel::ReadWrite::__ANON__[/usr/local/share/perl/5.18.2/POE/Wheel/ReadWrite.pm:293] at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#288">line 288 of POE/Wheel/ReadWrite.pm</a>, avg 91Âµs/call
# 10 times (117Âµs+295Âµs) by POE::Component::Server::TCP::__ANON__[/usr/local/share/perl/5.18.2/POE/Component/Server/TCP.pm:408] at <a href="POE-Component-Server-TCP-pm-105-sub.html#395">line 395 of POE/Component/Server/TCP.pm</a>, avg 41Âµs/call</div></div>sub call {</td></tr>
<tr><td class="h"><a name="1711"></a>1711</td><td class="c0">730</td><td class="c0"><span title="Avg 20Âµs">14.3ms</span></td><td></td><td></td><td class="s">  my ($self, $dest_session, $event_name, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1712"></a>1712</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1713"></a>1713</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1714"></a>1714</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; destination is undefined in call()&quot;</td></tr>
<tr><td class="h"><a name="1715"></a>1715</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $dest_session;</td></tr>
<tr><td class="h"><a name="1716"></a>1716</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; event is undefined in call()&quot; unless defined $event_name;</td></tr>
<tr><td class="h"><a name="1717"></a>1717</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="1718"></a>1718</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="1719"></a>1719</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by calling it&quot;</td></tr>
<tr><td class="h"><a name="1720"></a>1720</td><td></td><td></td><td></td><td></td><td class="s">    ) if exists $poes_own_events{$event_name};</td></tr>
<tr><td class="h"><a name="1721"></a>1721</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="1722"></a>1722</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1723"></a>1723</td><td></td><td></td><td></td><td></td><td class="s">  # Attempt to resolve the destination session reference against</td></tr>
<tr><td class="h"><a name="1724"></a>1724</td><td></td><td></td><td></td><td></td><td class="s">  # various things.</td></tr>
<tr><td class="h"><a name="1725"></a>1725</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1726"></a>1726</td><td></td><td></td><td class="c0">80</td><td class="c0">814Âµs</td><td class="s">  my $session = $self-&gt;_resolve_session($dest_session);<div class="calls"><div class="calls_out">  # spent   814Âµs making 80 calls to <a href="POE-Kernel-pm-54-sub.html#583">POE::Kernel::_resolve_session</a>, avg 10Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1727"></a>1727</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $session) {</td></tr>
<tr><td class="h"><a name="1728"></a>1728</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_resolve_failure($dest_session);</td></tr>
<tr><td class="h"><a name="1729"></a>1729</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1730"></a>1730</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1731"></a>1731</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1732"></a>1732</td><td></td><td></td><td></td><td></td><td class="s">  # Dispatch the event right now, bypassing the queue altogether.</td></tr>
<tr><td class="h"><a name="1733"></a>1733</td><td></td><td></td><td></td><td></td><td class="s">  # This tends to be a Bad Thing to Do.</td></tr>
<tr><td class="h"><a name="1734"></a>1734</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1735"></a>1735</td><td></td><td></td><td></td><td></td><td class="s">  # TODO The difference between synchronous and asynchronous events</td></tr>
<tr><td class="h"><a name="1736"></a>1736</td><td></td><td></td><td></td><td></td><td class="s">  # should be made more clear in the documentation, so that people</td></tr>
<tr><td class="h"><a name="1737"></a>1737</td><td></td><td></td><td></td><td></td><td class="s">  # have a tendency not to abuse them.  I discovered in xws that</td></tr>
<tr><td class="h"><a name="1738"></a>1738</td><td></td><td></td><td></td><td></td><td class="s">  # mixing the two types makes it harder than necessary to write</td></tr>
<tr><td class="h"><a name="1739"></a>1739</td><td></td><td></td><td></td><td></td><td class="s">  # deterministic programs, but the difficulty can be ameliorated if</td></tr>
<tr><td class="h"><a name="1740"></a>1740</td><td></td><td></td><td></td><td></td><td class="s">  # programmers set some base rules and stick to them.</td></tr>
<tr><td class="h"><a name="1741"></a>1741</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1742"></a>1742</td><td></td><td></td><td></td><td></td><td class="s">  if (wantarray) {</td></tr>
<tr><td class="h"><a name="1743"></a>1743</td><td></td><td></td><td></td><td></td><td class="s">    my @return_value = (</td></tr>
<tr><td class="h"><a name="1744"></a>1744</td><td></td><td></td><td></td><td></td><td class="s">      ($session == $kr_active_session)</td></tr>
<tr><td class="h"><a name="1745"></a>1745</td><td></td><td></td><td></td><td></td><td class="s">      ? $session-&gt;_invoke_state(</td></tr>
<tr><td class="h"><a name="1746"></a>1746</td><td></td><td></td><td></td><td></td><td class="s">        $session, $event_name, \@etc, (caller)[1,2],</td></tr>
<tr><td class="h"><a name="1747"></a>1747</td><td></td><td></td><td></td><td></td><td class="s">        $kr_active_event</td></tr>
<tr><td class="h"><a name="1748"></a>1748</td><td></td><td></td><td></td><td></td><td class="s">      )</td></tr>
<tr><td class="h"><a name="1749"></a>1749</td><td></td><td></td><td></td><td></td><td class="s">      : $self-&gt;_dispatch_event(</td></tr>
<tr><td class="h"><a name="1750"></a>1750</td><td></td><td></td><td></td><td></td><td class="s">        $session, $kr_active_session,</td></tr>
<tr><td class="h"><a name="1751"></a>1751</td><td></td><td></td><td></td><td></td><td class="s">        $event_name, ET_CALL, \@etc,</td></tr>
<tr><td class="h"><a name="1752"></a>1752</td><td></td><td></td><td></td><td></td><td class="s">        (caller)[1,2], $kr_active_event, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="1753"></a>1753</td><td></td><td></td><td></td><td></td><td class="s">      )</td></tr>
<tr><td class="h"><a name="1754"></a>1754</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1755"></a>1755</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1756"></a>1756</td><td></td><td></td><td></td><td></td><td class="s">    $kr_exception and $self-&gt;_rethrow_kr_exception();</td></tr>
<tr><td class="h"><a name="1757"></a>1757</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1758"></a>1758</td><td></td><td></td><td></td><td></td><td class="s">    $! = 0;</td></tr>
<tr><td class="h"><a name="1759"></a>1759</td><td></td><td></td><td></td><td></td><td class="s">    return @return_value;</td></tr>
<tr><td class="h"><a name="1760"></a>1760</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1761"></a>1761</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1762"></a>1762</td><td></td><td></td><td></td><td></td><td class="s">  if (defined wantarray) {</td></tr>
<tr><td class="h"><a name="1763"></a>1763</td><td></td><td></td><td></td><td></td><td class="s">    my $return_value = (</td></tr>
<tr><td class="h"><a name="1764"></a>1764</td><td></td><td></td><td></td><td></td><td class="s">      $session == $kr_active_session</td></tr>
<tr><td class="h"><a name="1765"></a>1765</td><td></td><td></td><td></td><td></td><td class="s">      ? $session-&gt;_invoke_state(</td></tr>
<tr><td class="h"><a name="1766"></a>1766</td><td></td><td></td><td></td><td></td><td class="s">        $session, $event_name, \@etc, (caller)[1,2],</td></tr>
<tr><td class="h"><a name="1767"></a>1767</td><td></td><td></td><td></td><td></td><td class="s">        $kr_active_event</td></tr>
<tr><td class="h"><a name="1768"></a>1768</td><td></td><td></td><td></td><td></td><td class="s">      )</td></tr>
<tr><td class="h"><a name="1769"></a>1769</td><td></td><td></td><td></td><td></td><td class="s">      : $self-&gt;_dispatch_event(</td></tr>
<tr><td class="h"><a name="1770"></a>1770</td><td></td><td></td><td></td><td></td><td class="s">        $session, $kr_active_session,</td></tr>
<tr><td class="h"><a name="1771"></a>1771</td><td></td><td></td><td></td><td></td><td class="s">        $event_name, ET_CALL, \@etc,</td></tr>
<tr><td class="h"><a name="1772"></a>1772</td><td></td><td></td><td></td><td></td><td class="s">        (caller)[1,2], $kr_active_event, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="1773"></a>1773</td><td></td><td></td><td></td><td></td><td class="s">      )</td></tr>
<tr><td class="h"><a name="1774"></a>1774</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1775"></a>1775</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1776"></a>1776</td><td></td><td></td><td></td><td></td><td class="s">    $kr_exception and $self-&gt;_rethrow_kr_exception();</td></tr>
<tr><td class="h"><a name="1777"></a>1777</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1778"></a>1778</td><td></td><td></td><td></td><td></td><td class="s">    $! = 0;</td></tr>
<tr><td class="h"><a name="1779"></a>1779</td><td></td><td></td><td></td><td></td><td class="s">    return $return_value;</td></tr>
<tr><td class="h"><a name="1780"></a>1780</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1781"></a>1781</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1782"></a>1782</td><td></td><td></td><td class="c0">70</td><td class="c3">0s</td><td class="s">  if ($session == $kr_active_session) {<div class="calls"><div class="calls_out">  # spent   161ms making 70 calls to <a href="POE-Session-pm-87-sub.html#405">POE::Session::_invoke_state</a>, avg 2.30ms/call, recursion: max depth 1, sum of overlapping time 161ms</div></div></td></tr>
<tr><td class="h"><a name="1783"></a>1783</td><td></td><td></td><td></td><td></td><td class="s">    $session-&gt;_invoke_state(</td></tr>
<tr><td class="h"><a name="1784"></a>1784</td><td></td><td></td><td></td><td></td><td class="s">      $session, $event_name, \@etc, (caller)[1,2],</td></tr>
<tr><td class="h"><a name="1785"></a>1785</td><td></td><td></td><td></td><td></td><td class="s">      $kr_active_event</td></tr>
<tr><td class="h"><a name="1786"></a>1786</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1787"></a>1787</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1788"></a>1788</td><td></td><td></td><td></td><td></td><td class="s">  else {</td></tr>
<tr><td class="h"><a name="1789"></a>1789</td><td></td><td></td><td class="c0">20</td><td class="c3">6Âµs</td><td class="s">    $self-&gt;_dispatch_event(<div class="calls"><div class="calls_out">    # spent     6Âµs making 10 calls to <a href="Time-HiRes-pm-50-sub.html#Time__HiRes__time">Time::HiRes::time</a>, avg 600ns/call
    # spent   183Âµs making 10 calls to <a href="POE-Kernel-pm-54-sub.html#996">POE::Kernel::_dispatch_event</a>, avg 18Âµs/call, recursion: max depth 1, sum of overlapping time 183Âµs</div></div></td></tr>
<tr><td class="h"><a name="1790"></a>1790</td><td></td><td></td><td></td><td></td><td class="s">      $session, $kr_active_session,</td></tr>
<tr><td class="h"><a name="1791"></a>1791</td><td></td><td></td><td></td><td></td><td class="s">      $event_name, ET_CALL, \@etc,</td></tr>
<tr><td class="h"><a name="1792"></a>1792</td><td></td><td></td><td></td><td></td><td class="s">      (caller)[1,2], $kr_active_event, monotime(), -__LINE__</td></tr>
<tr><td class="h"><a name="1793"></a>1793</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1794"></a>1794</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1795"></a>1795</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1796"></a>1796</td><td></td><td></td><td></td><td></td><td class="s">  $kr_exception and $self-&gt;_rethrow_kr_exception();</td></tr>
<tr><td class="h"><a name="1797"></a>1797</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1798"></a>1798</td><td></td><td></td><td></td><td></td><td class="s">  $! = 0;</td></tr>
<tr><td class="h"><a name="1799"></a>1799</td><td></td><td></td><td></td><td></td><td class="s">  return;</td></tr>
<tr><td class="h"><a name="1800"></a>1800</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1801"></a>1801</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1802"></a>1802</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="1803"></a>1803</td><td></td><td></td><td></td><td></td><td class="s"># DELAYED EVENTS</td></tr>
<tr><td class="h"><a name="1804"></a>1804</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="1805"></a>1805</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1806"></a>1806</td><td></td><td></td><td></td><td></td><td class="s">sub alarm {</td></tr>
<tr><td class="h"><a name="1807"></a>1807</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $event_name, $time, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1808"></a>1808</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1809"></a>1809</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1810"></a>1810</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call alarm() from a running session&quot;</td></tr>
<tr><td class="h"><a name="1811"></a>1811</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="1812"></a>1812</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; event name is undefined in alarm()&quot;</td></tr>
<tr><td class="h"><a name="1813"></a>1813</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $event_name;</td></tr>
<tr><td class="h"><a name="1814"></a>1814</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="1815"></a>1815</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="1816"></a>1816</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by setting an alarm for it&quot;</td></tr>
<tr><td class="h"><a name="1817"></a>1817</td><td></td><td></td><td></td><td></td><td class="s">    ) if exists $poes_own_events{$event_name};</td></tr>
<tr><td class="h"><a name="1818"></a>1818</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="1819"></a>1819</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1820"></a>1820</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $event_name) {</td></tr>
<tr><td class="h"><a name="1821"></a>1821</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_return(&quot;invalid parameter to alarm() call&quot;);</td></tr>
<tr><td class="h"><a name="1822"></a>1822</td><td></td><td></td><td></td><td></td><td class="s">    return EINVAL;</td></tr>
<tr><td class="h"><a name="1823"></a>1823</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1824"></a>1824</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1825"></a>1825</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_ev_clear_alarm_by_name($kr_active_session-&gt;ID(), $event_name);</td></tr>
<tr><td class="h"><a name="1826"></a>1826</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1827"></a>1827</td><td></td><td></td><td></td><td></td><td class="s">  # Add the new alarm if it includes a time.  Calling _data_ev_enqueue</td></tr>
<tr><td class="h"><a name="1828"></a>1828</td><td></td><td></td><td></td><td></td><td class="s">  # directly is faster than calling alarm_set to enqueue it.</td></tr>
<tr><td class="h"><a name="1829"></a>1829</td><td></td><td></td><td></td><td></td><td class="s">  if (defined $time) {</td></tr>
<tr><td class="h"><a name="1830"></a>1830</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_ev_enqueue</td></tr>
<tr><td class="h"><a name="1831"></a>1831</td><td></td><td></td><td></td><td></td><td class="s">      ( $kr_active_session, $kr_active_session,</td></tr>
<tr><td class="h"><a name="1832"></a>1832</td><td></td><td></td><td></td><td></td><td class="s">        $event_name, ET_ALARM, [ @etc ],</td></tr>
<tr><td class="h"><a name="1833"></a>1833</td><td></td><td></td><td></td><td></td><td class="s">        (caller)[1,2], $kr_active_event, $time,</td></tr>
<tr><td class="h"><a name="1834"></a>1834</td><td></td><td></td><td></td><td></td><td class="s">      );</td></tr>
<tr><td class="h"><a name="1835"></a>1835</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1836"></a>1836</td><td></td><td></td><td></td><td></td><td class="s">  else {</td></tr>
<tr><td class="h"><a name="1837"></a>1837</td><td></td><td></td><td></td><td></td><td class="s">    # The event queue has become empty?  Stop the time watcher.</td></tr>
<tr><td class="h"><a name="1838"></a>1838</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;loop_pause_time_watcher() unless $kr_queue-&gt;get_item_count();</td></tr>
<tr><td class="h"><a name="1839"></a>1839</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1840"></a>1840</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1841"></a>1841</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="1842"></a>1842</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1843"></a>1843</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1844"></a>1844</td><td></td><td></td><td></td><td></td><td class="s"># Add an alarm without clobbering previous alarms of the same name.</td></tr>
<tr><td class="h"><a name="1845"></a>1845</td><td></td><td></td><td></td><td></td><td class="s">sub alarm_add {</td></tr>
<tr><td class="h"><a name="1846"></a>1846</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $event_name, $time, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1847"></a>1847</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1848"></a>1848</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1849"></a>1849</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call alarm_add() from a running session&quot;</td></tr>
<tr><td class="h"><a name="1850"></a>1850</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="1851"></a>1851</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined event name in alarm_add()&quot;</td></tr>
<tr><td class="h"><a name="1852"></a>1852</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $event_name;</td></tr>
<tr><td class="h"><a name="1853"></a>1853</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined time in alarm_add()&quot; unless defined $time;</td></tr>
<tr><td class="h"><a name="1854"></a>1854</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="1855"></a>1855</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="1856"></a>1856</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by adding an alarm for it&quot;</td></tr>
<tr><td class="h"><a name="1857"></a>1857</td><td></td><td></td><td></td><td></td><td class="s">    ) if exists $poes_own_events{$event_name};</td></tr>
<tr><td class="h"><a name="1858"></a>1858</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="1859"></a>1859</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1860"></a>1860</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $event_name and defined $time) {</td></tr>
<tr><td class="h"><a name="1861"></a>1861</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_return(&quot;invalid parameter to alarm_add() call&quot;);</td></tr>
<tr><td class="h"><a name="1862"></a>1862</td><td></td><td></td><td></td><td></td><td class="s">    return EINVAL;</td></tr>
<tr><td class="h"><a name="1863"></a>1863</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1864"></a>1864</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1865"></a>1865</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_ev_enqueue</td></tr>
<tr><td class="h"><a name="1866"></a>1866</td><td></td><td></td><td></td><td></td><td class="s">    ( $kr_active_session, $kr_active_session,</td></tr>
<tr><td class="h"><a name="1867"></a>1867</td><td></td><td></td><td></td><td></td><td class="s">      $event_name, ET_ALARM, [ @etc ],</td></tr>
<tr><td class="h"><a name="1868"></a>1868</td><td></td><td></td><td></td><td></td><td class="s">      (caller)[1,2], $kr_active_event, $time,</td></tr>
<tr><td class="h"><a name="1869"></a>1869</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1870"></a>1870</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1871"></a>1871</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="1872"></a>1872</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1873"></a>1873</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1874"></a>1874</td><td></td><td></td><td></td><td></td><td class="s"># Add a delay, which is like an alarm relative to the current time.</td></tr>
<tr><td class="h"><a name="1875"></a>1875</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.06ms (226Âµs+835Âµs) within POE::Kernel::delay which was called 12 times, avg 88Âµs/call:
# 11 times (206Âµs+730Âµs) by main::__ANON__[t/simple_parallel_superbig.t:161] at <a href="t-simple_parallel_superbig-t-1-sub.html#161">line 161 of t/simple_parallel_superbig.t</a>, avg 85Âµs/call
#     once (21Âµs+105Âµs) by main::__ANON__[t/simple_parallel_superbig.t:159] at <a href="t-simple_parallel_superbig-t-1-sub.html#159">line 159 of t/simple_parallel_superbig.t</a></div></div>sub delay {</td></tr>
<tr><td class="h"><a name="1876"></a>1876</td><td class="c0">84</td><td class="c0"><span title="Avg 2Âµs">207Âµs</span></td><td></td><td></td><td class="s">  my ($self, $event_name, $delay, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1877"></a>1877</td><td></td><td></td><td class="c0">12</td><td class="c3">10Âµs</td><td class="s">  my $pri = monotime();<div class="calls"><div class="calls_out">  # spent    10Âµs making 12 calls to <a href="Time-HiRes-pm-50-sub.html#Time__HiRes__time">Time::HiRes::time</a>, avg 800ns/call</div></div></td></tr>
<tr><td class="h"><a name="1878"></a>1878</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1879"></a>1879</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1880"></a>1880</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call delay() from a running session&quot;</td></tr>
<tr><td class="h"><a name="1881"></a>1881</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="1882"></a>1882</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined event name in delay()&quot; unless defined $event_name;</td></tr>
<tr><td class="h"><a name="1883"></a>1883</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="1884"></a>1884</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="1885"></a>1885</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by setting a delay for it&quot;</td></tr>
<tr><td class="h"><a name="1886"></a>1886</td><td></td><td></td><td></td><td></td><td class="s">    ) if exists $poes_own_events{$event_name};</td></tr>
<tr><td class="h"><a name="1887"></a>1887</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="1888"></a>1888</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1889"></a>1889</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $event_name) {</td></tr>
<tr><td class="h"><a name="1890"></a>1890</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_return(&quot;invalid parameter to delay() call&quot;);</td></tr>
<tr><td class="h"><a name="1891"></a>1891</td><td></td><td></td><td></td><td></td><td class="s">    return EINVAL;</td></tr>
<tr><td class="h"><a name="1892"></a>1892</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1893"></a>1893</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1894"></a>1894</td><td></td><td></td><td></td><td></td><td class="s">  if (defined $delay) {</td></tr>
<tr><td class="h"><a name="1895"></a>1895</td><td></td><td></td><td class="c0">24</td><td class="c0">419Âµs</td><td class="s">    $self-&gt;_data_ev_clear_alarm_by_name($kr_active_session-&gt;ID(), $event_name);<div class="calls"><div class="calls_out">    # spent   406Âµs making 12 calls to <a href="POE-Resource-Events-pm-66-sub.html#251">POE::Kernel::_data_ev_clear_alarm_by_name</a>, avg 34Âµs/call
    # spent    13Âµs making 12 calls to <a href="POE-Session-pm-87-sub.html#598">POE::Session::ID</a>, avg 1Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1896"></a>1896</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1897"></a>1897</td><td></td><td></td><td></td><td></td><td class="s">    # Add the new alarm if it includes a time.  Calling _data_ev_enqueue</td></tr>
<tr><td class="h"><a name="1898"></a>1898</td><td></td><td></td><td></td><td></td><td class="s">    # directly is faster than calling alarm_set to enqueue it.</td></tr>
<tr><td class="h"><a name="1899"></a>1899</td><td></td><td></td><td class="c0">12</td><td class="c0">407Âµs</td><td class="s">    $self-&gt;_data_ev_enqueue<div class="calls"><div class="calls_out">    # spent   407Âµs making 12 calls to <a href="POE-Resource-Events-pm-66-sub.html#63">POE::Kernel::_data_ev_enqueue</a>, avg 34Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="1900"></a>1900</td><td></td><td></td><td></td><td></td><td class="s">      ( $kr_active_session, $kr_active_session,</td></tr>
<tr><td class="h"><a name="1901"></a>1901</td><td></td><td></td><td></td><td></td><td class="s">        $event_name, ET_ALARM, [ @etc ],</td></tr>
<tr><td class="h"><a name="1902"></a>1902</td><td></td><td></td><td></td><td></td><td class="s">        (caller)[1,2], $kr_active_event, undef, $delay, $pri+$delay</td></tr>
<tr><td class="h"><a name="1903"></a>1903</td><td></td><td></td><td></td><td></td><td class="s">      );</td></tr>
<tr><td class="h"><a name="1904"></a>1904</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1905"></a>1905</td><td></td><td></td><td></td><td></td><td class="s">  else {</td></tr>
<tr><td class="h"><a name="1906"></a>1906</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;alarm($event_name);</td></tr>
<tr><td class="h"><a name="1907"></a>1907</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1908"></a>1908</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1909"></a>1909</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="1910"></a>1910</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1911"></a>1911</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1912"></a>1912</td><td></td><td></td><td></td><td></td><td class="s"># Add a delay without clobbering previous delays of the same name.</td></tr>
<tr><td class="h"><a name="1913"></a>1913</td><td></td><td></td><td></td><td></td><td class="s">sub delay_add {</td></tr>
<tr><td class="h"><a name="1914"></a>1914</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $event_name, $delay, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1915"></a>1915</td><td></td><td></td><td></td><td></td><td class="s">  my $pri = monotime();</td></tr>
<tr><td class="h"><a name="1916"></a>1916</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1917"></a>1917</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1918"></a>1918</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call delay_add() from a running session&quot;</td></tr>
<tr><td class="h"><a name="1919"></a>1919</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="1920"></a>1920</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined event name in delay_add()&quot;</td></tr>
<tr><td class="h"><a name="1921"></a>1921</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $event_name;</td></tr>
<tr><td class="h"><a name="1922"></a>1922</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined time in delay_add()&quot; unless defined $delay;</td></tr>
<tr><td class="h"><a name="1923"></a>1923</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="1924"></a>1924</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="1925"></a>1925</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by adding a delay for it&quot;</td></tr>
<tr><td class="h"><a name="1926"></a>1926</td><td></td><td></td><td></td><td></td><td class="s">    ) if exists $poes_own_events{$event_name};</td></tr>
<tr><td class="h"><a name="1927"></a>1927</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="1928"></a>1928</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1929"></a>1929</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $event_name and defined $delay) {</td></tr>
<tr><td class="h"><a name="1930"></a>1930</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_return(&quot;invalid parameter to delay_add() call&quot;);</td></tr>
<tr><td class="h"><a name="1931"></a>1931</td><td></td><td></td><td></td><td></td><td class="s">    return EINVAL;</td></tr>
<tr><td class="h"><a name="1932"></a>1932</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1933"></a>1933</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1934"></a>1934</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_ev_enqueue</td></tr>
<tr><td class="h"><a name="1935"></a>1935</td><td></td><td></td><td></td><td></td><td class="s">    ( $kr_active_session, $kr_active_session,</td></tr>
<tr><td class="h"><a name="1936"></a>1936</td><td></td><td></td><td></td><td></td><td class="s">      $event_name, ET_ALARM, [ @etc ],</td></tr>
<tr><td class="h"><a name="1937"></a>1937</td><td></td><td></td><td></td><td></td><td class="s">      (caller)[1,2], $kr_active_event, undef, $delay, $pri+$delay</td></tr>
<tr><td class="h"><a name="1938"></a>1938</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1939"></a>1939</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1940"></a>1940</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="1941"></a>1941</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1942"></a>1942</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1943"></a>1943</td><td></td><td></td><td></td><td></td><td class="s">#------------------------------------------------------------------------------</td></tr>
<tr><td class="h"><a name="1944"></a>1944</td><td></td><td></td><td></td><td></td><td class="s"># New style alarms.</td></tr>
<tr><td class="h"><a name="1945"></a>1945</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1946"></a>1946</td><td></td><td></td><td></td><td></td><td class="s"># Set an alarm.  This does more *and* less than plain alarm().  It</td></tr>
<tr><td class="h"><a name="1947"></a>1947</td><td></td><td></td><td></td><td></td><td class="s"># only sets alarms (that's the less part), but it also returns an</td></tr>
<tr><td class="h"><a name="1948"></a>1948</td><td></td><td></td><td></td><td></td><td class="s"># alarm ID (that's the more part).</td></tr>
<tr><td class="h"><a name="1949"></a>1949</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1950"></a>1950</td><td></td><td></td><td></td><td></td><td class="s">sub alarm_set {</td></tr>
<tr><td class="h"><a name="1951"></a>1951</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $event_name, $time, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1952"></a>1952</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1953"></a>1953</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1954"></a>1954</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call alarm_set() from a running session&quot;</td></tr>
<tr><td class="h"><a name="1955"></a>1955</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="1956"></a>1956</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1957"></a>1957</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1958"></a>1958</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $event_name) {</td></tr>
<tr><td class="h"><a name="1959"></a>1959</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_usage(&quot;undefined event name in alarm_set()&quot;);</td></tr>
<tr><td class="h"><a name="1960"></a>1960</td><td></td><td></td><td></td><td></td><td class="s">    $! = EINVAL;</td></tr>
<tr><td class="h"><a name="1961"></a>1961</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1962"></a>1962</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1963"></a>1963</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1964"></a>1964</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $time) {</td></tr>
<tr><td class="h"><a name="1965"></a>1965</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_usage(&quot;undefined time in alarm_set()&quot;);</td></tr>
<tr><td class="h"><a name="1966"></a>1966</td><td></td><td></td><td></td><td></td><td class="s">    $! = EINVAL;</td></tr>
<tr><td class="h"><a name="1967"></a>1967</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1968"></a>1968</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1969"></a>1969</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1970"></a>1970</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1971"></a>1971</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="1972"></a>1972</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="1973"></a>1973</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by setting an alarm for it&quot;</td></tr>
<tr><td class="h"><a name="1974"></a>1974</td><td></td><td></td><td></td><td></td><td class="s">    ) if exists $poes_own_events{$event_name};</td></tr>
<tr><td class="h"><a name="1975"></a>1975</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1976"></a>1976</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1977"></a>1977</td><td></td><td></td><td></td><td></td><td class="s">  return $self-&gt;_data_ev_enqueue</td></tr>
<tr><td class="h"><a name="1978"></a>1978</td><td></td><td></td><td></td><td></td><td class="s">    ( $kr_active_session, $kr_active_session, $event_name, ET_ALARM, [ @etc ],</td></tr>
<tr><td class="h"><a name="1979"></a>1979</td><td></td><td></td><td></td><td></td><td class="s">      (caller)[1,2], $kr_active_event, $time,</td></tr>
<tr><td class="h"><a name="1980"></a>1980</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="1981"></a>1981</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="1982"></a>1982</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1983"></a>1983</td><td></td><td></td><td></td><td></td><td class="s"># Remove an alarm by its ID.  TODO Now that alarms and events have</td></tr>
<tr><td class="h"><a name="1984"></a>1984</td><td></td><td></td><td></td><td></td><td class="s"># been recombined, this will remove an event by its ID.  However,</td></tr>
<tr><td class="h"><a name="1985"></a>1985</td><td></td><td></td><td></td><td></td><td class="s"># nothing returns an event ID, so nobody knows what to remove.</td></tr>
<tr><td class="h"><a name="1986"></a>1986</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1987"></a>1987</td><td></td><td></td><td></td><td></td><td class="s">sub alarm_remove {</td></tr>
<tr><td class="h"><a name="1988"></a>1988</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $alarm_id) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="1989"></a>1989</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1990"></a>1990</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="1991"></a>1991</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call alarm_remove() from a running session&quot;</td></tr>
<tr><td class="h"><a name="1992"></a>1992</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="1993"></a>1993</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="1994"></a>1994</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="1995"></a>1995</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $alarm_id) {</td></tr>
<tr><td class="h"><a name="1996"></a>1996</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_usage(&quot;undefined alarm id in alarm_remove()&quot;);</td></tr>
<tr><td class="h"><a name="1997"></a>1997</td><td></td><td></td><td></td><td></td><td class="s">    $! = EINVAL;</td></tr>
<tr><td class="h"><a name="1998"></a>1998</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="1999"></a>1999</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2000"></a>2000</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2001"></a>2001</td><td></td><td></td><td></td><td></td><td class="s">  my ($time, $event) =</td></tr>
<tr><td class="h"><a name="2002"></a>2002</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_ev_clear_alarm_by_id($kr_active_session-&gt;ID(), $alarm_id);</td></tr>
<tr><td class="h"><a name="2003"></a>2003</td><td></td><td></td><td></td><td></td><td class="s">  return unless defined $time;</td></tr>
<tr><td class="h"><a name="2004"></a>2004</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2005"></a>2005</td><td></td><td></td><td></td><td></td><td class="s">  # In a list context, return the alarm that was removed.  In a scalar</td></tr>
<tr><td class="h"><a name="2006"></a>2006</td><td></td><td></td><td></td><td></td><td class="s">  # context, return a reference to the alarm that was removed.  In a</td></tr>
<tr><td class="h"><a name="2007"></a>2007</td><td></td><td></td><td></td><td></td><td class="s">  # void context, return nothing.  Either way this returns a defined</td></tr>
<tr><td class="h"><a name="2008"></a>2008</td><td></td><td></td><td></td><td></td><td class="s">  # value when someone needs something useful from it.</td></tr>
<tr><td class="h"><a name="2009"></a>2009</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2010"></a>2010</td><td></td><td></td><td></td><td></td><td class="s">  return unless defined wantarray;</td></tr>
<tr><td class="h"><a name="2011"></a>2011</td><td></td><td></td><td></td><td></td><td class="s">  return ( $event-&gt;[EV_NAME], $time, $event-&gt;[EV_ARGS] ) if wantarray;</td></tr>
<tr><td class="h"><a name="2012"></a>2012</td><td></td><td></td><td></td><td></td><td class="s">  return [ $event-&gt;[EV_NAME], $time, $event-&gt;[EV_ARGS] ];</td></tr>
<tr><td class="h"><a name="2013"></a>2013</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2014"></a>2014</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2015"></a>2015</td><td></td><td></td><td></td><td></td><td class="s"># Move an alarm to a new time.  This virtually removes the alarm and</td></tr>
<tr><td class="h"><a name="2016"></a>2016</td><td></td><td></td><td></td><td></td><td class="s"># re-adds it somewhere else.  In reality, adjust_priority() is</td></tr>
<tr><td class="h"><a name="2017"></a>2017</td><td></td><td></td><td></td><td></td><td class="s"># optimized for this sort of thing.</td></tr>
<tr><td class="h"><a name="2018"></a>2018</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2019"></a>2019</td><td></td><td></td><td></td><td></td><td class="s">sub alarm_adjust {</td></tr>
<tr><td class="h"><a name="2020"></a>2020</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $alarm_id, $delta) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2021"></a>2021</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2022"></a>2022</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2023"></a>2023</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call alarm_adjust() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2024"></a>2024</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2025"></a>2025</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2026"></a>2026</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2027"></a>2027</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $alarm_id) {</td></tr>
<tr><td class="h"><a name="2028"></a>2028</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_usage(&quot;undefined alarm id in alarm_adjust()&quot;);</td></tr>
<tr><td class="h"><a name="2029"></a>2029</td><td></td><td></td><td></td><td></td><td class="s">    $! = EINVAL;</td></tr>
<tr><td class="h"><a name="2030"></a>2030</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="2031"></a>2031</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2032"></a>2032</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2033"></a>2033</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $delta) {</td></tr>
<tr><td class="h"><a name="2034"></a>2034</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_usage(&quot;undefined alarm delta in alarm_adjust()&quot;);</td></tr>
<tr><td class="h"><a name="2035"></a>2035</td><td></td><td></td><td></td><td></td><td class="s">    $! = EINVAL;</td></tr>
<tr><td class="h"><a name="2036"></a>2036</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="2037"></a>2037</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2038"></a>2038</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2039"></a>2039</td><td></td><td></td><td></td><td></td><td class="s">  my $my_alarm = sub {</td></tr>
<tr><td class="h"><a name="2040"></a>2040</td><td></td><td></td><td></td><td></td><td class="s">    $_[0]-&gt;[EV_SESSION] == $kr_active_session;</td></tr>
<tr><td class="h"><a name="2041"></a>2041</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2042"></a>2042</td><td></td><td></td><td></td><td></td><td class="s">  </td></tr>
<tr><td class="h"><a name="2043"></a>2043</td><td></td><td></td><td></td><td></td><td class="s">  return $self-&gt;_data_ev_adjust( $alarm_id, $my_alarm, undef, $delta );</td></tr>
<tr><td class="h"><a name="2044"></a>2044</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2045"></a>2045</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2046"></a>2046</td><td></td><td></td><td></td><td></td><td class="s"># A convenient function for setting alarms relative to now.  It also</td></tr>
<tr><td class="h"><a name="2047"></a>2047</td><td></td><td></td><td></td><td></td><td class="s"># uses whichever time() POE::Kernel can find, which may be</td></tr>
<tr><td class="h"><a name="2048"></a>2048</td><td></td><td></td><td></td><td></td><td class="s"># Time::HiRes'.</td></tr>
<tr><td class="h"><a name="2049"></a>2049</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2050"></a>2050</td><td></td><td></td><td></td><td></td><td class="s">sub delay_set {</td></tr>
<tr><td class="h"><a name="2051"></a>2051</td><td></td><td></td><td></td><td></td><td class="s">  # Always always always grab time() ASAP, so that the eventual</td></tr>
<tr><td class="h"><a name="2052"></a>2052</td><td></td><td></td><td></td><td></td><td class="s">  # time we set the delay for is as close as possible to the time</td></tr>
<tr><td class="h"><a name="2053"></a>2053</td><td></td><td></td><td></td><td></td><td class="s">  # at which they ASKED for the delay, not when we actually set it.</td></tr>
<tr><td class="h"><a name="2054"></a>2054</td><td></td><td></td><td></td><td></td><td class="s">  my $t = walltime();</td></tr>
<tr><td class="h"><a name="2055"></a>2055</td><td></td><td></td><td></td><td></td><td class="s">  my $pri = monotime();</td></tr>
<tr><td class="h"><a name="2056"></a>2056</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2057"></a>2057</td><td></td><td></td><td></td><td></td><td class="s">  # And now continue as normal</td></tr>
<tr><td class="h"><a name="2058"></a>2058</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $event_name, $seconds, @etc) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2059"></a>2059</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2060"></a>2060</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2061"></a>2061</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call delay_set() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2062"></a>2062</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2063"></a>2063</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2064"></a>2064</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2065"></a>2065</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $event_name) {</td></tr>
<tr><td class="h"><a name="2066"></a>2066</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_usage(&quot;undefined event name in delay_set()&quot;);</td></tr>
<tr><td class="h"><a name="2067"></a>2067</td><td></td><td></td><td></td><td></td><td class="s">    $! = EINVAL;</td></tr>
<tr><td class="h"><a name="2068"></a>2068</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="2069"></a>2069</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2070"></a>2070</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2071"></a>2071</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2072"></a>2072</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="2073"></a>2073</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="2074"></a>2074</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by setting a delay for it&quot;</td></tr>
<tr><td class="h"><a name="2075"></a>2075</td><td></td><td></td><td></td><td></td><td class="s">    ) if exists $poes_own_events{$event_name};</td></tr>
<tr><td class="h"><a name="2076"></a>2076</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2077"></a>2077</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2078"></a>2078</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $seconds) {</td></tr>
<tr><td class="h"><a name="2079"></a>2079</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_usage(&quot;undefined seconds in delay_set()&quot;);</td></tr>
<tr><td class="h"><a name="2080"></a>2080</td><td></td><td></td><td></td><td></td><td class="s">    $! = EINVAL;</td></tr>
<tr><td class="h"><a name="2081"></a>2081</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="2082"></a>2082</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2083"></a>2083</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2084"></a>2084</td><td></td><td></td><td></td><td></td><td class="s">  return $self-&gt;_data_ev_enqueue</td></tr>
<tr><td class="h"><a name="2085"></a>2085</td><td></td><td></td><td></td><td></td><td class="s">    ( $kr_active_session, $kr_active_session, $event_name, ET_ALARM, [ @etc ],</td></tr>
<tr><td class="h"><a name="2086"></a>2086</td><td></td><td></td><td></td><td></td><td class="s">      (caller)[1,2], $kr_active_event, $t, $seconds, $pri+$seconds</td></tr>
<tr><td class="h"><a name="2087"></a>2087</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="2088"></a>2088</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2089"></a>2089</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2090"></a>2090</td><td></td><td></td><td></td><td></td><td class="s"># Move a delay to a new offset from time().  As with alarm_adjust(),</td></tr>
<tr><td class="h"><a name="2091"></a>2091</td><td></td><td></td><td></td><td></td><td class="s"># this is optimized internally for this sort of activity.</td></tr>
<tr><td class="h"><a name="2092"></a>2092</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2093"></a>2093</td><td></td><td></td><td></td><td></td><td class="s">sub delay_adjust {</td></tr>
<tr><td class="h"><a name="2094"></a>2094</td><td></td><td></td><td></td><td></td><td class="s">  # Always always always grab time() ASAP, so that the eventual</td></tr>
<tr><td class="h"><a name="2095"></a>2095</td><td></td><td></td><td></td><td></td><td class="s">  # time we set the delay for is as close as possible to the time</td></tr>
<tr><td class="h"><a name="2096"></a>2096</td><td></td><td></td><td></td><td></td><td class="s">  # at which they ASKED for the delay, not when we actually set it.</td></tr>
<tr><td class="h"><a name="2097"></a>2097</td><td></td><td></td><td></td><td></td><td class="s">  my $t = walltime();</td></tr>
<tr><td class="h"><a name="2098"></a>2098</td><td></td><td></td><td></td><td></td><td class="s">  my $pri = monotime();</td></tr>
<tr><td class="h"><a name="2099"></a>2099</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2100"></a>2100</td><td></td><td></td><td></td><td></td><td class="s">  # And now continue as normal</td></tr>
<tr><td class="h"><a name="2101"></a>2101</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $alarm_id, $seconds) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2102"></a>2102</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2103"></a>2103</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2104"></a>2104</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call delay_adjust() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2105"></a>2105</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2106"></a>2106</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2107"></a>2107</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2108"></a>2108</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $alarm_id) {</td></tr>
<tr><td class="h"><a name="2109"></a>2109</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_usage(&quot;undefined delay id in delay_adjust()&quot;);</td></tr>
<tr><td class="h"><a name="2110"></a>2110</td><td></td><td></td><td></td><td></td><td class="s">    $! = EINVAL;</td></tr>
<tr><td class="h"><a name="2111"></a>2111</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="2112"></a>2112</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2113"></a>2113</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2114"></a>2114</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $seconds) {</td></tr>
<tr><td class="h"><a name="2115"></a>2115</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_usage(&quot;undefined delay seconds in delay_adjust()&quot;);</td></tr>
<tr><td class="h"><a name="2116"></a>2116</td><td></td><td></td><td></td><td></td><td class="s">    $! = EINVAL;</td></tr>
<tr><td class="h"><a name="2117"></a>2117</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="2118"></a>2118</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2119"></a>2119</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2120"></a>2120</td><td></td><td></td><td></td><td></td><td class="s">  my $my_delay = sub {</td></tr>
<tr><td class="h"><a name="2121"></a>2121</td><td></td><td></td><td></td><td></td><td class="s">    $_[0]-&gt;[EV_SESSION] == $kr_active_session;</td></tr>
<tr><td class="h"><a name="2122"></a>2122</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2123"></a>2123</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2124"></a>2124</td><td></td><td></td><td></td><td></td><td class="s">  if (TRACE_EVENTS) {</td></tr>
<tr><td class="h"><a name="2125"></a>2125</td><td></td><td></td><td></td><td></td><td class="s">    _warn(&quot;&lt;ev&gt; adjusted event $alarm_id by $seconds seconds from $t&quot;);</td></tr>
<tr><td class="h"><a name="2126"></a>2126</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2127"></a>2127</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2128"></a>2128</td><td></td><td></td><td></td><td></td><td class="s">  return $self-&gt;_data_ev_set($alarm_id, $my_delay, $t, $pri, $seconds );</td></tr>
<tr><td class="h"><a name="2129"></a>2129</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2130"></a>2130</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2131"></a>2131</td><td></td><td></td><td></td><td></td><td class="s"># Remove all alarms for the current session.</td></tr>
<tr><td class="h"><a name="2132"></a>2132</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2133"></a>2133</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 247Âµs (42+204) within POE::Kernel::alarm_remove_all which was called:
#    once (42Âµs+204Âµs) by main::__ANON__[t/simple_parallel_superbig.t:161] at <a href="t-simple_parallel_superbig-t-1-sub.html#161">line 161 of t/simple_parallel_superbig.t</a></div></div>sub alarm_remove_all {</td></tr>
<tr><td class="h"><a name="2134"></a>2134</td><td class="c3">4</td><td class="c3"><span title="Avg 6Âµs">26Âµs</span></td><td></td><td></td><td class="s">  my $self = $poe_kernel;</td></tr>
<tr><td class="h"><a name="2135"></a>2135</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2136"></a>2136</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2137"></a>2137</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call alarm_remove_all() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2138"></a>2138</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2139"></a>2139</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2140"></a>2140</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2141"></a>2141</td><td></td><td></td><td></td><td></td><td class="s">  # This should never happen, actually.</td></tr>
<tr><td class="h"><a name="2142"></a>2142</td><td></td><td></td><td class="c3">2</td><td class="c3">8Âµs</td><td class="s">  _trap &quot;unknown session in alarm_remove_all call&quot; unless (<div class="calls"><div class="calls_out">  # spent     6Âµs making 1 call to <a href="POE-Resource-Sessions-pm-82-sub.html#352">POE::Kernel::_data_ses_exists</a>
  # spent     2Âµs making 1 call to <a href="POE-Session-pm-87-sub.html#598">POE::Session::ID</a></div></div></td></tr>
<tr><td class="h"><a name="2143"></a>2143</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_ses_exists($kr_active_session-&gt;ID)</td></tr>
<tr><td class="h"><a name="2144"></a>2144</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2145"></a>2145</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2146"></a>2146</td><td></td><td></td><td></td><td></td><td class="s">  # Free every alarm owned by the session.  This code is ripped off</td></tr>
<tr><td class="h"><a name="2147"></a>2147</td><td></td><td></td><td></td><td></td><td class="s">  # from the _stop code to flush everything.</td></tr>
<tr><td class="h"><a name="2148"></a>2148</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2149"></a>2149</td><td></td><td></td><td class="c3">2</td><td class="c0">196Âµs</td><td class="s">  my @removed = $self-&gt;_data_ev_clear_alarm_by_session(<div class="calls"><div class="calls_out">  # spent   194Âµs making 1 call to <a href="POE-Resource-Events-pm-66-sub.html#294">POE::Kernel::_data_ev_clear_alarm_by_session</a>
  # spent     2Âµs making 1 call to <a href="POE-Session-pm-87-sub.html#598">POE::Session::ID</a></div></div></td></tr>
<tr><td class="h"><a name="2150"></a>2150</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session-&gt;ID()</td></tr>
<tr><td class="h"><a name="2151"></a>2151</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2152"></a>2152</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2153"></a>2153</td><td></td><td></td><td></td><td></td><td class="s">  return unless defined wantarray;</td></tr>
<tr><td class="h"><a name="2154"></a>2154</td><td></td><td></td><td></td><td></td><td class="s">  return @removed if wantarray;</td></tr>
<tr><td class="h"><a name="2155"></a>2155</td><td></td><td></td><td></td><td></td><td class="s">  return \@removed;</td></tr>
<tr><td class="h"><a name="2156"></a>2156</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2157"></a>2157</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2158"></a>2158</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2159"></a>2159</td><td></td><td></td><td></td><td></td><td class="s"># SELECTS</td></tr>
<tr><td class="h"><a name="2160"></a>2160</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2161"></a>2161</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2162"></a>2162</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 9.23ms (641Âµs+8.59) within POE::Kernel::_internal_select which was called 145 times, avg 64Âµs/call:
# 60 times (205Âµs+1.98ms) by POE::Kernel::select_write at <a href="POE-Kernel-pm-54-sub.html#2250">line 2250</a>, avg 36Âµs/call
# 52 times (258Âµs+5.81ms) by POE::Kernel::select_read at <a href="POE-Kernel-pm-54-sub.html#2227">line 2227</a>, avg 117Âµs/call
# 11 times (50Âµs+636Âµs) by POE::Kernel::select at <a href="POE-Kernel-pm-54-sub.html#2201">line 2201</a>, avg 62Âµs/call
# 11 times (78Âµs+135Âµs) by POE::Kernel::select at <a href="POE-Kernel-pm-54-sub.html#2199">line 2199</a>, avg 19Âµs/call
# 11 times (51Âµs+32Âµs) by POE::Kernel::select at <a href="POE-Kernel-pm-54-sub.html#2204">line 2204</a>, avg 8Âµs/call</div></div>sub _internal_select {</td></tr>
<tr><td class="h"><a name="2163"></a>2163</td><td class="c0">373</td><td class="c0"><span title="Avg 2Âµs">579Âµs</span></td><td></td><td></td><td class="s">  my ($self, $session, $handle, $event_name, $mode, $args) = @_;</td></tr>
<tr><td class="h"><a name="2164"></a>2164</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2165"></a>2165</td><td></td><td></td><td></td><td></td><td class="s">  # If an event is included, then we're defining a filehandle watcher.</td></tr>
<tr><td class="h"><a name="2166"></a>2166</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2167"></a>2167</td><td></td><td></td><td class="c0">62</td><td class="c0">5.55ms</td><td class="s">  if ($event_name) {<div class="calls"><div class="calls_out">  # spent  5.55ms making 62 calls to <a href="POE-Resource-FileHandles-pm-72-sub.html#264">POE::Kernel::_data_handle_add</a>, avg 90Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2168"></a>2168</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_handle_add($handle, $mode, $session, $event_name, $args);</td></tr>
<tr><td class="h"><a name="2169"></a>2169</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2170"></a>2170</td><td></td><td></td><td></td><td></td><td class="s">  else {</td></tr>
<tr><td class="h"><a name="2171"></a>2171</td><td></td><td></td><td class="c0">166</td><td class="c0">3.04ms</td><td class="s">    $self-&gt;_data_handle_remove($handle, $mode, $session-&gt;ID);<div class="calls"><div class="calls_out">    # spent  2.96ms making 83 calls to <a href="POE-Resource-FileHandles-pm-72-sub.html#466">POE::Kernel::_data_handle_remove</a>, avg 36Âµs/call
    # spent    82Âµs making 83 calls to <a href="POE-Session-pm-87-sub.html#598">POE::Session::ID</a>, avg 982ns/call</div></div></td></tr>
<tr><td class="h"><a name="2172"></a>2172</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2173"></a>2173</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2174"></a>2174</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2175"></a>2175</td><td></td><td></td><td></td><td></td><td class="s"># A higher-level select() that manipulates read, write and expedite</td></tr>
<tr><td class="h"><a name="2176"></a>2176</td><td></td><td></td><td></td><td></td><td class="s"># selects together.</td></tr>
<tr><td class="h"><a name="2177"></a>2177</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2178"></a>2178</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.10ms (115Âµs+981Âµs) within POE::Kernel::select which was called 11 times, avg 100Âµs/call:
# 11 times (115Âµs+981Âµs) by POE::Wheel::SocketFactory::_shutdown at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#1110">line 1110 of POE/Wheel/SocketFactory.pm</a>, avg 100Âµs/call</div></div>sub select {</td></tr>
<tr><td class="h"><a name="2179"></a>2179</td><td class="c0">55</td><td class="c2"><span title="Avg 2Âµs">95Âµs</span></td><td></td><td></td><td class="s">  my ($self, $handle, $event_r, $event_w, $event_e, @args) = (</td></tr>
<tr><td class="h"><a name="2180"></a>2180</td><td></td><td></td><td></td><td></td><td class="s">    $poe_kernel, @_[1..$#_]</td></tr>
<tr><td class="h"><a name="2181"></a>2181</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2182"></a>2182</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2183"></a>2183</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2184"></a>2184</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call select() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2185"></a>2185</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2186"></a>2186</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined filehandle in select()&quot; unless defined $handle;</td></tr>
<tr><td class="h"><a name="2187"></a>2187</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; invalid filehandle in select()&quot;</td></tr>
<tr><td class="h"><a name="2188"></a>2188</td><td></td><td></td><td></td><td></td><td class="s">      unless defined fileno($handle);</td></tr>
<tr><td class="h"><a name="2189"></a>2189</td><td></td><td></td><td></td><td></td><td class="s">    foreach ($event_r, $event_w, $event_e) {</td></tr>
<tr><td class="h"><a name="2190"></a>2190</td><td></td><td></td><td></td><td></td><td class="s">      next unless defined $_;</td></tr>
<tr><td class="h"><a name="2191"></a>2191</td><td></td><td></td><td></td><td></td><td class="s">      _carp(</td></tr>
<tr><td class="h"><a name="2192"></a>2192</td><td></td><td></td><td></td><td></td><td class="s">        &quot;&lt;us&gt; The '$_' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="2193"></a>2193</td><td></td><td></td><td></td><td></td><td class="s">        &quot;effect cannot be achieved by setting a file watcher to it&quot;</td></tr>
<tr><td class="h"><a name="2194"></a>2194</td><td></td><td></td><td></td><td></td><td class="s">      ) if exists($poes_own_events{$_});</td></tr>
<tr><td class="h"><a name="2195"></a>2195</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="2196"></a>2196</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2197"></a>2197</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2198"></a>2198</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_internal_select(</td></tr>
<tr><td class="h"><a name="2199"></a>2199</td><td></td><td></td><td class="c0">11</td><td class="c0">213Âµs</td><td class="s">    $kr_active_session, $handle, $event_r, MODE_RD, \@args<div class="calls"><div class="calls_out">    # spent   213Âµs making 11 calls to <a href="POE-Kernel-pm-54-sub.html#2162">POE::Kernel::_internal_select</a>, avg 19Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2200"></a>2200</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2201"></a>2201</td><td></td><td></td><td class="c0">11</td><td class="c0">685Âµs</td><td class="s">  $self-&gt;_internal_select(<div class="calls"><div class="calls_out">  # spent   685Âµs making 11 calls to <a href="POE-Kernel-pm-54-sub.html#2162">POE::Kernel::_internal_select</a>, avg 62Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2202"></a>2202</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $handle, $event_w, MODE_WR, \@args</td></tr>
<tr><td class="h"><a name="2203"></a>2203</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2204"></a>2204</td><td></td><td></td><td class="c0">11</td><td class="c0">83Âµs</td><td class="s">  $self-&gt;_internal_select(<div class="calls"><div class="calls_out">  # spent    83Âµs making 11 calls to <a href="POE-Kernel-pm-54-sub.html#2162">POE::Kernel::_internal_select</a>, avg 8Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2205"></a>2205</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $handle, $event_e, MODE_EX, \@args</td></tr>
<tr><td class="h"><a name="2206"></a>2206</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2207"></a>2207</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="2208"></a>2208</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2209"></a>2209</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2210"></a>2210</td><td></td><td></td><td></td><td></td><td class="s"># Only manipulate the read select.</td></tr>
<tr><td class="h"><a name="2211"></a>2211</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 6.33ms (262Âµs+6.07) within POE::Kernel::select_read which was called 52 times, avg 122Âµs/call:
# 20 times (108Âµs+4.67ms) by POE::Wheel::ReadWrite::_define_read_state at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#325">line 325 of POE/Wheel/ReadWrite.pm</a>, avg 239Âµs/call
# 20 times (93Âµs+711Âµs) by POE::Wheel::ReadWrite::DESTROY at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#392">line 392 of POE/Wheel/ReadWrite.pm</a>, avg 40Âµs/call
# 10 times (52Âµs+606Âµs) by POE::Wheel::ReadWrite::__ANON__[/usr/local/share/perl/5.18.2/POE/Wheel/ReadWrite.pm:293] at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#291">line 291 of POE/Wheel/ReadWrite.pm</a>, avg 66Âµs/call
#     once (6Âµs+63Âµs) by POE::Wheel::SocketFactory::_define_accept_state at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#207">line 207 of POE/Wheel/SocketFactory.pm</a>
#     once (4Âµs+19Âµs) by POE::Wheel::SocketFactory::event at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#407">line 407 of POE/Wheel/SocketFactory.pm</a></div></div>sub select_read {</td></tr>
<tr><td class="h"><a name="2212"></a>2212</td><td class="c0">156</td><td class="c0"><span title="Avg 2Âµs">272Âµs</span></td><td></td><td></td><td class="s">  my ($self, $handle, $event_name, @args) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2213"></a>2213</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2214"></a>2214</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2215"></a>2215</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call select_read() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2216"></a>2216</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2217"></a>2217</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined filehandle in select_read()&quot;</td></tr>
<tr><td class="h"><a name="2218"></a>2218</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $handle;</td></tr>
<tr><td class="h"><a name="2219"></a>2219</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; invalid filehandle in select_read()&quot;</td></tr>
<tr><td class="h"><a name="2220"></a>2220</td><td></td><td></td><td></td><td></td><td class="s">      unless defined fileno($handle);</td></tr>
<tr><td class="h"><a name="2221"></a>2221</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="2222"></a>2222</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="2223"></a>2223</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by setting a file watcher to it&quot;</td></tr>
<tr><td class="h"><a name="2224"></a>2224</td><td></td><td></td><td></td><td></td><td class="s">    ) if defined($event_name) and exists($poes_own_events{$event_name});</td></tr>
<tr><td class="h"><a name="2225"></a>2225</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2226"></a>2226</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2227"></a>2227</td><td></td><td></td><td class="c0">52</td><td class="c0">6.07ms</td><td class="s">  $self-&gt;_internal_select(<div class="calls"><div class="calls_out">  # spent  6.07ms making 52 calls to <a href="POE-Kernel-pm-54-sub.html#2162">POE::Kernel::_internal_select</a>, avg 117Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2228"></a>2228</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $handle, $event_name, MODE_RD, \@args</td></tr>
<tr><td class="h"><a name="2229"></a>2229</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2230"></a>2230</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="2231"></a>2231</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2232"></a>2232</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2233"></a>2233</td><td></td><td></td><td></td><td></td><td class="s"># Only manipulate the write select.</td></tr>
<tr><td class="h"><a name="2234"></a>2234</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 2.45ms (269Âµs+2.18) within POE::Kernel::select_write which was called 60 times, avg 41Âµs/call:
# 20 times (90Âµs+1.18ms) by POE::Wheel::ReadWrite::DESTROY at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#397">line 397 of POE/Wheel/ReadWrite.pm</a>, avg 64Âµs/call
# 20 times (106Âµs+486Âµs) by POE::Wheel::ReadWrite::_define_write_state at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#234">line 234 of POE/Wheel/ReadWrite.pm</a>, avg 30Âµs/call
# 10 times (38Âµs+374Âµs) by POE::Wheel::SocketFactory::_define_connect_state at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#361">line 361 of POE/Wheel/SocketFactory.pm</a>, avg 41Âµs/call
# 10 times (35Âµs+144Âµs) by POE::Wheel::SocketFactory::event at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#413">line 413 of POE/Wheel/SocketFactory.pm</a>, avg 18Âµs/call</div></div>sub select_write {</td></tr>
<tr><td class="h"><a name="2235"></a>2235</td><td class="c0">180</td><td class="c0"><span title="Avg 26Âµs">4.76ms</span></td><td></td><td></td><td class="s">  my ($self, $handle, $event_name, @args) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2236"></a>2236</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2237"></a>2237</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2238"></a>2238</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call select_write() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2239"></a>2239</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2240"></a>2240</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined filehandle in select_write()&quot;</td></tr>
<tr><td class="h"><a name="2241"></a>2241</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $handle;</td></tr>
<tr><td class="h"><a name="2242"></a>2242</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; invalid filehandle in select_write()&quot;</td></tr>
<tr><td class="h"><a name="2243"></a>2243</td><td></td><td></td><td></td><td></td><td class="s">      unless defined fileno($handle);</td></tr>
<tr><td class="h"><a name="2244"></a>2244</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="2245"></a>2245</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="2246"></a>2246</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by setting a file watcher to it&quot;</td></tr>
<tr><td class="h"><a name="2247"></a>2247</td><td></td><td></td><td></td><td></td><td class="s">    ) if defined($event_name) and exists($poes_own_events{$event_name});</td></tr>
<tr><td class="h"><a name="2248"></a>2248</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2249"></a>2249</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2250"></a>2250</td><td></td><td></td><td class="c0">60</td><td class="c0">2.18ms</td><td class="s">  $self-&gt;_internal_select(<div class="calls"><div class="calls_out">  # spent  2.18ms making 60 calls to <a href="POE-Kernel-pm-54-sub.html#2162">POE::Kernel::_internal_select</a>, avg 36Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2251"></a>2251</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $handle, $event_name, MODE_WR, \@args</td></tr>
<tr><td class="h"><a name="2252"></a>2252</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2253"></a>2253</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="2254"></a>2254</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2255"></a>2255</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2256"></a>2256</td><td></td><td></td><td></td><td></td><td class="s"># Only manipulate the expedite select.</td></tr>
<tr><td class="h"><a name="2257"></a>2257</td><td></td><td></td><td></td><td></td><td class="s">sub select_expedite {</td></tr>
<tr><td class="h"><a name="2258"></a>2258</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $handle, $event_name, @args) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2259"></a>2259</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2260"></a>2260</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2261"></a>2261</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call select_expedite() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2262"></a>2262</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2263"></a>2263</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined filehandle in select_expedite()&quot;</td></tr>
<tr><td class="h"><a name="2264"></a>2264</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $handle;</td></tr>
<tr><td class="h"><a name="2265"></a>2265</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; invalid filehandle in select_expedite()&quot;</td></tr>
<tr><td class="h"><a name="2266"></a>2266</td><td></td><td></td><td></td><td></td><td class="s">      unless defined fileno($handle);</td></tr>
<tr><td class="h"><a name="2267"></a>2267</td><td></td><td></td><td></td><td></td><td class="s">    _carp(</td></tr>
<tr><td class="h"><a name="2268"></a>2268</td><td></td><td></td><td></td><td></td><td class="s">      &quot;&lt;us&gt; The '$event_name' event is one of POE's own.  Its &quot; .</td></tr>
<tr><td class="h"><a name="2269"></a>2269</td><td></td><td></td><td></td><td></td><td class="s">      &quot;effect cannot be achieved by setting a file watcher to it&quot;</td></tr>
<tr><td class="h"><a name="2270"></a>2270</td><td></td><td></td><td></td><td></td><td class="s">    ) if defined($event_name) and exists($poes_own_events{$event_name});</td></tr>
<tr><td class="h"><a name="2271"></a>2271</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2272"></a>2272</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2273"></a>2273</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_internal_select(</td></tr>
<tr><td class="h"><a name="2274"></a>2274</td><td></td><td></td><td></td><td></td><td class="s">    $kr_active_session, $handle, $event_name, MODE_EX, \@args</td></tr>
<tr><td class="h"><a name="2275"></a>2275</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2276"></a>2276</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="2277"></a>2277</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2278"></a>2278</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2279"></a>2279</td><td></td><td></td><td></td><td></td><td class="s"># Turn off a handle's write mode bit without doing</td></tr>
<tr><td class="h"><a name="2280"></a>2280</td><td></td><td></td><td></td><td></td><td class="s"># garbage-collection things.</td></tr>
<tr><td class="h"><a name="2281"></a>2281</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.56ms (384Âµs+1.17) within POE::Kernel::select_pause_write which was called 40 times, avg 39Âµs/call:
# 20 times (244Âµs+677Âµs) by POE::Wheel::ReadWrite::__ANON__[/usr/local/share/perl/5.18.2/POE/Wheel/ReadWrite.pm:231] at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#228">line 228 of POE/Wheel/ReadWrite.pm</a>, avg 46Âµs/call
# 20 times (140Âµs+497Âµs) by POE::Wheel::ReadWrite::_define_write_state at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#237">line 237 of POE/Wheel/ReadWrite.pm</a>, avg 32Âµs/call</div></div>sub select_pause_write {</td></tr>
<tr><td class="h"><a name="2282"></a>2282</td><td class="c0">160</td><td class="c0"><span title="Avg 2Âµs">348Âµs</span></td><td></td><td></td><td class="s">  my ($self, $handle) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2283"></a>2283</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2284"></a>2284</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2285"></a>2285</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call select_pause_write() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2286"></a>2286</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2287"></a>2287</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined filehandle in select_pause_write()&quot;</td></tr>
<tr><td class="h"><a name="2288"></a>2288</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $handle;</td></tr>
<tr><td class="h"><a name="2289"></a>2289</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; invalid filehandle in select_pause_write()&quot;</td></tr>
<tr><td class="h"><a name="2290"></a>2290</td><td></td><td></td><td></td><td></td><td class="s">      unless defined fileno($handle);</td></tr>
<tr><td class="h"><a name="2291"></a>2291</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2292"></a>2292</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2293"></a>2293</td><td></td><td></td><td class="c0">40</td><td class="c0">471Âµs</td><td class="s">  return 0 unless $self-&gt;_data_handle_is_good($handle, MODE_WR);<div class="calls"><div class="calls_out">  # spent   471Âµs making 40 calls to <a href="POE-Resource-FileHandles-pm-72-sub.html#250">POE::Kernel::_data_handle_is_good</a>, avg 12Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2294"></a>2294</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2295"></a>2295</td><td></td><td></td><td class="c0">40</td><td class="c0">703Âµs</td><td class="s">  $self-&gt;_data_handle_pause($handle, MODE_WR);<div class="calls"><div class="calls_out">  # spent   703Âµs making 40 calls to <a href="POE-Resource-FileHandles-pm-72-sub.html#640">POE::Kernel::_data_handle_pause</a>, avg 18Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2296"></a>2296</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2297"></a>2297</td><td></td><td></td><td></td><td></td><td class="s">  return 1;</td></tr>
<tr><td class="h"><a name="2298"></a>2298</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2299"></a>2299</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2300"></a>2300</td><td></td><td></td><td></td><td></td><td class="s"># Turn on a handle's write mode bit without doing garbage-collection</td></tr>
<tr><td class="h"><a name="2301"></a>2301</td><td></td><td></td><td></td><td></td><td class="s"># things.</td></tr>
<tr><td class="h"><a name="2302"></a>2302</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.03ms (235Âµs+792Âµs) within POE::Kernel::select_resume_write which was called 20 times, avg 51Âµs/call:
# 20 times (235Âµs+792Âµs) by POE::Wheel::ReadWrite::put at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#440">line 440 of POE/Wheel/ReadWrite.pm</a>, avg 51Âµs/call</div></div>sub select_resume_write {</td></tr>
<tr><td class="h"><a name="2303"></a>2303</td><td class="c0">80</td><td class="c0"><span title="Avg 3Âµs">202Âµs</span></td><td></td><td></td><td class="s">  my ($self, $handle) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2304"></a>2304</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2305"></a>2305</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2306"></a>2306</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call select_resume_write() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2307"></a>2307</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2308"></a>2308</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined filehandle in select_resume_write()&quot;</td></tr>
<tr><td class="h"><a name="2309"></a>2309</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $handle;</td></tr>
<tr><td class="h"><a name="2310"></a>2310</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; invalid filehandle in select_resume_write()&quot;</td></tr>
<tr><td class="h"><a name="2311"></a>2311</td><td></td><td></td><td></td><td></td><td class="s">      unless defined fileno($handle);</td></tr>
<tr><td class="h"><a name="2312"></a>2312</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2313"></a>2313</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2314"></a>2314</td><td></td><td></td><td class="c0">20</td><td class="c0">363Âµs</td><td class="s">  return 0 unless $self-&gt;_data_handle_is_good($handle, MODE_WR);<div class="calls"><div class="calls_out">  # spent   363Âµs making 20 calls to <a href="POE-Resource-FileHandles-pm-72-sub.html#250">POE::Kernel::_data_handle_is_good</a>, avg 18Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2315"></a>2315</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2316"></a>2316</td><td></td><td></td><td class="c0">20</td><td class="c0">429Âµs</td><td class="s">  $self-&gt;_data_handle_resume($handle, MODE_WR);<div class="calls"><div class="calls_out">  # spent   429Âµs making 20 calls to <a href="POE-Resource-FileHandles-pm-72-sub.html#620">POE::Kernel::_data_handle_resume</a>, avg 21Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2317"></a>2317</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2318"></a>2318</td><td></td><td></td><td></td><td></td><td class="s">  return 1;</td></tr>
<tr><td class="h"><a name="2319"></a>2319</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2320"></a>2320</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2321"></a>2321</td><td></td><td></td><td></td><td></td><td class="s"># Turn off a handle's read mode bit without doing garbage-collection</td></tr>
<tr><td class="h"><a name="2322"></a>2322</td><td></td><td></td><td></td><td></td><td class="s"># things.</td></tr>
<tr><td class="h"><a name="2323"></a>2323</td><td></td><td></td><td></td><td></td><td class="s">sub select_pause_read {</td></tr>
<tr><td class="h"><a name="2324"></a>2324</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $handle) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2325"></a>2325</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2326"></a>2326</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2327"></a>2327</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call select_pause_read() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2328"></a>2328</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2329"></a>2329</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined filehandle in select_pause_read()&quot;</td></tr>
<tr><td class="h"><a name="2330"></a>2330</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $handle;</td></tr>
<tr><td class="h"><a name="2331"></a>2331</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; invalid filehandle in select_pause_read()&quot;</td></tr>
<tr><td class="h"><a name="2332"></a>2332</td><td></td><td></td><td></td><td></td><td class="s">      unless defined fileno($handle);</td></tr>
<tr><td class="h"><a name="2333"></a>2333</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2334"></a>2334</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2335"></a>2335</td><td></td><td></td><td></td><td></td><td class="s">  return 0 unless $self-&gt;_data_handle_is_good($handle, MODE_RD);</td></tr>
<tr><td class="h"><a name="2336"></a>2336</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2337"></a>2337</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_handle_pause($handle, MODE_RD);</td></tr>
<tr><td class="h"><a name="2338"></a>2338</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2339"></a>2339</td><td></td><td></td><td></td><td></td><td class="s">  return 1;</td></tr>
<tr><td class="h"><a name="2340"></a>2340</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2341"></a>2341</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2342"></a>2342</td><td></td><td></td><td></td><td></td><td class="s"># Turn on a handle's read mode bit without doing garbage-collection</td></tr>
<tr><td class="h"><a name="2343"></a>2343</td><td></td><td></td><td></td><td></td><td class="s"># things.</td></tr>
<tr><td class="h"><a name="2344"></a>2344</td><td></td><td></td><td></td><td></td><td class="s">sub select_resume_read {</td></tr>
<tr><td class="h"><a name="2345"></a>2345</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $handle) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2346"></a>2346</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2347"></a>2347</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2348"></a>2348</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call select_resume_read() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2349"></a>2349</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2350"></a>2350</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined filehandle in select_resume_read()&quot;</td></tr>
<tr><td class="h"><a name="2351"></a>2351</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $handle;</td></tr>
<tr><td class="h"><a name="2352"></a>2352</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; invalid filehandle in select_resume_read()&quot;</td></tr>
<tr><td class="h"><a name="2353"></a>2353</td><td></td><td></td><td></td><td></td><td class="s">      unless defined fileno($handle);</td></tr>
<tr><td class="h"><a name="2354"></a>2354</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2355"></a>2355</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2356"></a>2356</td><td></td><td></td><td></td><td></td><td class="s">  return 0 unless $self-&gt;_data_handle_is_good($handle, MODE_RD);</td></tr>
<tr><td class="h"><a name="2357"></a>2357</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2358"></a>2358</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_data_handle_resume($handle, MODE_RD);</td></tr>
<tr><td class="h"><a name="2359"></a>2359</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2360"></a>2360</td><td></td><td></td><td></td><td></td><td class="s">  return 1;</td></tr>
<tr><td class="h"><a name="2361"></a>2361</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2362"></a>2362</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2363"></a>2363</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2364"></a>2364</td><td></td><td></td><td></td><td></td><td class="s"># Aliases: These functions expose the internal alias accessors with</td></tr>
<tr><td class="h"><a name="2365"></a>2365</td><td></td><td></td><td></td><td></td><td class="s"># extra fun parameter/return value checking.</td></tr>
<tr><td class="h"><a name="2366"></a>2366</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2367"></a>2367</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2368"></a>2368</td><td></td><td></td><td></td><td></td><td class="s">### Set an alias in the current session.</td></tr>
<tr><td class="h"><a name="2369"></a>2369</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2370"></a>2370</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 210Âµs (128+82) within POE::Kernel::alias_set which was called 21 times, avg 10Âµs/call:
# 10 times (60Âµs+38Âµs) by POE::Component::Client::TCP::__ANON__[/usr/local/share/perl/5.18.2/POE/Component/Client/TCP.pm:149] at <a href="POE-Component-Client-TCP-pm-88-sub.html#146">line 146 of POE/Component/Client/TCP.pm</a>, avg 10Âµs/call
# 10 times (57Âµs+26Âµs) by POE::Component::Client::TCP::__ANON__[/usr/local/share/perl/5.18.2/POE/Component/Client/TCP.pm:181] at <a href="POE-Component-Client-TCP-pm-88-sub.html#165">line 165 of POE/Component/Client/TCP.pm</a>, avg 8Âµs/call
#     once (10Âµs+17Âµs) by POE::Component::Server::TCP::__ANON__[/usr/local/share/perl/5.18.2/POE/Component/Server/TCP.pm:479] at <a href="POE-Component-Server-TCP-pm-105-sub.html#461">line 461 of POE/Component/Server/TCP.pm</a></div></div>sub alias_set {</td></tr>
<tr><td class="h"><a name="2371"></a>2371</td><td class="c0">123</td><td class="c2"><span title="Avg 939ns">116Âµs</span></td><td></td><td></td><td class="s">  my ($self, $name) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2372"></a>2372</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2373"></a>2373</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2374"></a>2374</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined alias in alias_set()&quot; unless defined $name;</td></tr>
<tr><td class="h"><a name="2375"></a>2375</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2376"></a>2376</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2377"></a>2377</td><td></td><td></td><td></td><td></td><td class="s">  # Don't overwrite another session's alias.</td></tr>
<tr><td class="h"><a name="2378"></a>2378</td><td></td><td></td><td class="c0">21</td><td class="c3">30Âµs</td><td class="s">  my $existing_session = $self-&gt;_data_alias_resolve($name);<div class="calls"><div class="calls_out">  # spent    30Âµs making 21 calls to <a href="POE-Resource-Aliases-pm-63-sub.html#102">POE::Kernel::_data_alias_resolve</a>, avg 1Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2379"></a>2379</td><td></td><td></td><td></td><td></td><td class="s">  if (defined $existing_session) {</td></tr>
<tr><td class="h"><a name="2380"></a>2380</td><td></td><td></td><td></td><td></td><td class="s">    if ($existing_session != $kr_active_session) {</td></tr>
<tr><td class="h"><a name="2381"></a>2381</td><td></td><td></td><td class="c0">18</td><td class="c3">25Âµs</td><td class="s">      $self-&gt;_explain_usage(&quot;alias '$name' is in use by another session&quot;);<div class="calls"><div class="calls_out">      # spent    25Âµs making 18 calls to <a href="POE-Kernel-pm-54-sub.html#680">POE::Kernel::_explain_usage</a>, avg 1Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2382"></a>2382</td><td></td><td></td><td></td><td></td><td class="s">      return EEXIST;</td></tr>
<tr><td class="h"><a name="2383"></a>2383</td><td></td><td></td><td></td><td></td><td class="s">    }</td></tr>
<tr><td class="h"><a name="2384"></a>2384</td><td></td><td></td><td></td><td></td><td class="s">    return 0;</td></tr>
<tr><td class="h"><a name="2385"></a>2385</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2386"></a>2386</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2387"></a>2387</td><td></td><td></td><td class="c3">2</td><td class="c3">26Âµs</td><td class="s">  $self-&gt;_data_alias_add($kr_active_session, $name);<div class="calls"><div class="calls_out">  # spent    26Âµs making 2 calls to <a href="POE-Resource-Aliases-pm-63-sub.html#68">POE::Kernel::_data_alias_add</a>, avg 13Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2388"></a>2388</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="2389"></a>2389</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2390"></a>2390</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2391"></a>2391</td><td></td><td></td><td></td><td></td><td class="s">### Remove an alias from the current session.</td></tr>
<tr><td class="h"><a name="2392"></a>2392</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2393"></a>2393</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 181Âµs (103+78) within POE::Kernel::alias_remove which was called 11 times, avg 16Âµs/call:
# 10 times (96Âµs+65Âµs) by POE::Component::Client::TCP::__ANON__[/usr/local/share/perl/5.18.2/POE/Component/Client/TCP.pm:298] at <a href="POE-Component-Client-TCP-pm-88-sub.html#297">line 297 of POE/Component/Client/TCP.pm</a>, avg 16Âµs/call
#     once (7Âµs+13Âµs) by POE::Component::Server::TCP::__ANON__[/usr/local/share/perl/5.18.2/POE/Component/Server/TCP.pm:540] at <a href="POE-Component-Server-TCP-pm-105-sub.html#538">line 538 of POE/Component/Server/TCP.pm</a></div></div>sub alias_remove {</td></tr>
<tr><td class="h"><a name="2394"></a>2394</td><td class="c0">58</td><td class="c2"><span title="Avg 2Âµs">92Âµs</span></td><td></td><td></td><td class="s">  my ($self, $name) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2395"></a>2395</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2396"></a>2396</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2397"></a>2397</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined alias in alias_remove()&quot; unless defined $name;</td></tr>
<tr><td class="h"><a name="2398"></a>2398</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2399"></a>2399</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2400"></a>2400</td><td></td><td></td><td class="c0">11</td><td class="c3">24Âµs</td><td class="s">  my $existing_session = $self-&gt;_data_alias_resolve($name);<div class="calls"><div class="calls_out">  # spent    24Âµs making 11 calls to <a href="POE-Resource-Aliases-pm-63-sub.html#102">POE::Kernel::_data_alias_resolve</a>, avg 2Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2401"></a>2401</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2402"></a>2402</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $existing_session) {</td></tr>
<tr><td class="h"><a name="2403"></a>2403</td><td></td><td></td><td class="c0">8</td><td class="c3">20Âµs</td><td class="s">    $self-&gt;_explain_usage(&quot;alias '$name' does not exist&quot;);<div class="calls"><div class="calls_out">    # spent    20Âµs making 8 calls to <a href="POE-Kernel-pm-54-sub.html#680">POE::Kernel::_explain_usage</a>, avg 2Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2404"></a>2404</td><td></td><td></td><td></td><td></td><td class="s">    return ESRCH;</td></tr>
<tr><td class="h"><a name="2405"></a>2405</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2406"></a>2406</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2407"></a>2407</td><td></td><td></td><td></td><td></td><td class="s">  if ($existing_session != $kr_active_session) {</td></tr>
<tr><td class="h"><a name="2408"></a>2408</td><td></td><td></td><td class="c3">1</td><td class="c3">2Âµs</td><td class="s">    $self-&gt;_explain_usage(&quot;alias '$name' does not belong to current session&quot;);<div class="calls"><div class="calls_out">    # spent     2Âµs making 1 call to <a href="POE-Kernel-pm-54-sub.html#680">POE::Kernel::_explain_usage</a></div></div></td></tr>
<tr><td class="h"><a name="2409"></a>2409</td><td></td><td></td><td></td><td></td><td class="s">    return EPERM;</td></tr>
<tr><td class="h"><a name="2410"></a>2410</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2411"></a>2411</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2412"></a>2412</td><td></td><td></td><td class="c3">2</td><td class="c3">31Âµs</td><td class="s">  $self-&gt;_data_alias_remove($kr_active_session, $name);<div class="calls"><div class="calls_out">  # spent    31Âµs making 2 calls to <a href="POE-Resource-Aliases-pm-63-sub.html#81">POE::Kernel::_data_alias_remove</a>, avg 16Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2413"></a>2413</td><td></td><td></td><td></td><td></td><td class="s">  return 0;</td></tr>
<tr><td class="h"><a name="2414"></a>2414</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2415"></a>2415</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2416"></a>2416</td><td></td><td></td><td></td><td></td><td class="s">### Resolve an alias into a session.</td></tr>
<tr><td class="h"><a name="2417"></a>2417</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2418"></a>2418</td><td></td><td></td><td></td><td></td><td class="s">sub alias_resolve {</td></tr>
<tr><td class="h"><a name="2419"></a>2419</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $name) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2420"></a>2420</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2421"></a>2421</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2422"></a>2422</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined alias in alias_resolve()&quot; unless defined $name;</td></tr>
<tr><td class="h"><a name="2423"></a>2423</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2424"></a>2424</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2425"></a>2425</td><td></td><td></td><td></td><td></td><td class="s">  return $self-&gt;_resolve_session($name);</td></tr>
<tr><td class="h"><a name="2426"></a>2426</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2427"></a>2427</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2428"></a>2428</td><td></td><td></td><td></td><td></td><td class="s">### List the aliases for a given session.</td></tr>
<tr><td class="h"><a name="2429"></a>2429</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2430"></a>2430</td><td></td><td></td><td></td><td></td><td class="s">sub alias_list {</td></tr>
<tr><td class="h"><a name="2431"></a>2431</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $search_session) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2432"></a>2432</td><td></td><td></td><td></td><td></td><td class="s">  my $session =</td></tr>
<tr><td class="h"><a name="2433"></a>2433</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_resolve_session($search_session || $kr_active_session);</td></tr>
<tr><td class="h"><a name="2434"></a>2434</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2435"></a>2435</td><td></td><td></td><td></td><td></td><td class="s">  unless (defined $session) {</td></tr>
<tr><td class="h"><a name="2436"></a>2436</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_resolve_failure($search_session, &quot;nonfatal&quot;);</td></tr>
<tr><td class="h"><a name="2437"></a>2437</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="2438"></a>2438</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2439"></a>2439</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2440"></a>2440</td><td></td><td></td><td></td><td></td><td class="s">  # Return whatever can be found.</td></tr>
<tr><td class="h"><a name="2441"></a>2441</td><td></td><td></td><td></td><td></td><td class="s">  my @alias_list = $self-&gt;_data_alias_list($session-&gt;ID);</td></tr>
<tr><td class="h"><a name="2442"></a>2442</td><td></td><td></td><td></td><td></td><td class="s">  return wantarray() ? @alias_list : $alias_list[0];</td></tr>
<tr><td class="h"><a name="2443"></a>2443</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2444"></a>2444</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2445"></a>2445</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2446"></a>2446</td><td></td><td></td><td></td><td></td><td class="s"># Kernel and Session IDs</td></tr>
<tr><td class="h"><a name="2447"></a>2447</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2448"></a>2448</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2449"></a>2449</td><td></td><td></td><td></td><td></td><td class="s"># Return the Kernel's &quot;unique&quot; ID.  There's only so much uniqueness</td></tr>
<tr><td class="h"><a name="2450"></a>2450</td><td></td><td></td><td></td><td></td><td class="s"># available; machines on separate private 10/8 networks may have</td></tr>
<tr><td class="h"><a name="2451"></a>2451</td><td></td><td></td><td></td><td></td><td class="s"># identical kernel IDs.  The chances of a collision are vanishingly</td></tr>
<tr><td class="h"><a name="2452"></a>2452</td><td></td><td></td><td></td><td></td><td class="s"># small.</td></tr>
<tr><td class="h"><a name="2453"></a>2453</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2454"></a>2454</td><td></td><td></td><td></td><td></td><td class="s"># The Kernel and Session IDs are based on Philip Gwyn's code.  I hope</td></tr>
<tr><td class="h"><a name="2455"></a>2455</td><td></td><td></td><td></td><td></td><td class="s"># he still can recognize it.</td></tr>
<tr><td class="h"><a name="2456"></a>2456</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2457"></a>2457</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 49Âµs (28+21) within POE::Kernel::_recalc_id which was called:
#    once (28Âµs+21Âµs) by POE::Kernel::new at <a href="POE-Kernel-pm-54-sub.html#839">line 839</a></div></div>sub _recalc_id {</td></tr>
<tr><td class="h"><a name="2458"></a>2458</td><td class="c1">7</td><td class="c3"><span title="Avg 7Âµs">50Âµs</span></td><td></td><td></td><td class="s">  my $self = shift;</td></tr>
<tr><td class="h"><a name="2459"></a>2459</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2460"></a>2460</td><td></td><td></td><td></td><td></td><td class="s">  my $old_id = $self-&gt;[KR_ID];</td></tr>
<tr><td class="h"><a name="2461"></a>2461</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2462"></a>2462</td><td></td><td></td><td class="c3">1</td><td class="c3">11Âµs</td><td class="s">  my $hostname = eval { (uname)[1] };<div class="calls"><div class="calls_out">  # spent    11Âµs making 1 call to <a href="POSIX-pm-27-sub.html#POSIX__uname">POSIX::uname</a></div></div></td></tr>
<tr><td class="h"><a name="2463"></a>2463</td><td></td><td></td><td></td><td></td><td class="s">  $hostname = hostname() unless defined $hostname;</td></tr>
<tr><td class="h"><a name="2464"></a>2464</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2465"></a>2465</td><td></td><td></td><td></td><td></td><td class="s">  my $new_id = $self-&gt;[KR_ID] = join(</td></tr>
<tr><td class="h"><a name="2466"></a>2466</td><td></td><td></td><td></td><td></td><td class="s">    &quot;-&quot;, $hostname,</td></tr>
<tr><td class="h"><a name="2467"></a>2467</td><td></td><td></td><td></td><td></td><td class="s">    map { unpack &quot;H*&quot;, $_ }</td></tr>
<tr><td class="h"><a name="2468"></a>2468</td><td></td><td></td><td class="c0">7</td><td class="c3">10Âµs</td><td class="s">    map { pack &quot;N&quot;, $_ }<div class="calls"><div class="calls_out">    # spent     6Âµs making 3 calls to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_unpack">POE::Kernel::CORE:unpack</a>, avg 2Âµs/call
    # spent     4Âµs making 3 calls to <a href="POE-Kernel-pm-54-sub.html#POE__Kernel__CORE_pack">POE::Kernel::CORE:pack</a>, avg 1Âµs/call
    # spent   900ns making 1 call to <a href="Time-HiRes-pm-50-sub.html#Time__HiRes__time">Time::HiRes::time</a></div></div></td></tr>
<tr><td class="h"><a name="2469"></a>2469</td><td></td><td></td><td></td><td></td><td class="s">    (monotime(), $$, ++$kr_id_seq)</td></tr>
<tr><td class="h"><a name="2470"></a>2470</td><td></td><td></td><td></td><td></td><td class="s">  );</td></tr>
<tr><td class="h"><a name="2471"></a>2471</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2472"></a>2472</td><td></td><td></td><td></td><td></td><td class="s">  if (defined $old_id) {</td></tr>
<tr><td class="h"><a name="2473"></a>2473</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_sig_relocate_kernel_id($old_id, $new_id);</td></tr>
<tr><td class="h"><a name="2474"></a>2474</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_ses_relocate_kernel_id($old_id, $new_id);</td></tr>
<tr><td class="h"><a name="2475"></a>2475</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_sid_relocate_kernel_id($old_id, $new_id);</td></tr>
<tr><td class="h"><a name="2476"></a>2476</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_handle_relocate_kernel_id($old_id, $new_id);</td></tr>
<tr><td class="h"><a name="2477"></a>2477</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_ev_relocate_kernel_id($old_id, $new_id);</td></tr>
<tr><td class="h"><a name="2478"></a>2478</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_data_alias_relocate_kernel_id($old_id, $new_id);</td></tr>
<tr><td class="h"><a name="2479"></a>2479</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2480"></a>2480</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2481"></a>2481</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2482"></a>2482</td><td class="c0">120</td><td class="c0"><span title="Avg 3Âµs">382Âµs</span></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 181Âµs within POE::Kernel::ID which was called 120 times, avg 2Âµs/call:
# 34 times (55Âµs+0s) by POE::Kernel::_data_ses_refcount_dec at <a href="POE-Resource-Sessions-pm-82-sub.html#420">line 420 of POE/Resource/Sessions.pm</a>, avg 2Âµs/call
# 24 times (29Âµs+0s) by POE::Kernel::_data_ses_gc_sweep at <a href="POE-Resource-Sessions-pm-82-sub.html#388">line 388 of POE/Resource/Sessions.pm</a>, avg 1Âµs/call
# 23 times (31Âµs+0s) by POE::Kernel::_data_ses_allocate at <a href="POE-Resource-Sessions-pm-82-sub.html#138">line 138 of POE/Resource/Sessions.pm</a>, avg 1Âµs/call
# 12 times (13Âµs+0s) by POE::Kernel::_data_ses_free at <a href="POE-Resource-Sessions-pm-82-sub.html#172">line 172 of POE/Resource/Sessions.pm</a>, avg 1Âµs/call
# 12 times (13Âµs+0s) by POE::Kernel::session_alloc at <a href="POE-Kernel-pm-54-sub.html#1471">line 1471</a>, avg 1Âµs/call
#  4 times (10Âµs+0s) by POE::Kernel::_data_ev_refcount_dec at <a href="POE-Resource-Events-pm-66-sub.html#319">line 319 of POE/Resource/Events.pm</a>, avg 3Âµs/call
#  2 times (6Âµs+0s) by POE::Kernel::_data_ev_enqueue at <a href="POE-Resource-Events-pm-66-sub.html#70">line 70 of POE/Resource/Events.pm</a>, avg 3Âµs/call
#  2 times (5Âµs+0s) by POE::Kernel::_data_ev_enqueue at <a href="POE-Resource-Events-pm-66-sub.html#125">line 125 of POE/Resource/Events.pm</a>, avg 3Âµs/call
#     once (3Âµs+0s) by POE::Kernel::_finalize_kernel at <a href="POE-Kernel-pm-54-sub.html#1214">line 1214</a>
#     once (3Âµs+0s) by POE::Kernel::_dispatch_signal_event at <a href="POE-Kernel-pm-54-sub.html#923">line 923</a>
#     once (3Âµs+0s) by POE::Kernel::_data_sig_free_terminated_sessions at <a href="POE-Resource-Signals-pm-85-sub.html#542">line 542 of POE/Resource/Signals.pm</a>
#     once (3Âµs+0s) by POE::Kernel::_dispatch_signal_event at <a href="POE-Kernel-pm-54-sub.html#950">line 950</a>
#     once (3Âµs+0s) by POE::Kernel::__ANON__[/usr/local/share/perl/5.18.2/POE/Resource/Events.pm:199] at <a href="POE-Resource-Events-pm-66-sub.html#199">line 199 of POE/Resource/Events.pm</a>
#     once (3Âµs+0s) by POE::Kernel::_data_sig_free_terminated_sessions at <a href="POE-Resource-Signals-pm-85-sub.html#551">line 551 of POE/Resource/Signals.pm</a>
#     once (900ns+0s) by POE::Kernel::_data_sig_add at <a href="POE-Resource-Signals-pm-85-sub.html#314">line 314 of POE/Resource/Signals.pm</a></div></div>sub ID { $poe_kernel-&gt;[KR_ID] }</td></tr>
<tr><td class="h"><a name="2483"></a>2483</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2484"></a>2484</td><td></td><td></td><td></td><td></td><td class="s"># Resolve an ID to a session reference.  This function is virtually</td></tr>
<tr><td class="h"><a name="2485"></a>2485</td><td></td><td></td><td></td><td></td><td class="s"># moot now that _resolve_session does it too.  This explicit call will</td></tr>
<tr><td class="h"><a name="2486"></a>2486</td><td></td><td></td><td></td><td></td><td class="s"># be faster, though, so it's kept for things that can benefit from it.</td></tr>
<tr><td class="h"><a name="2487"></a>2487</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2488"></a>2488</td><td></td><td></td><td></td><td></td><td class="s">sub ID_id_to_session {</td></tr>
<tr><td class="h"><a name="2489"></a>2489</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $id) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2490"></a>2490</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2491"></a>2491</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2492"></a>2492</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined ID in ID_id_to_session()&quot; unless defined $id;</td></tr>
<tr><td class="h"><a name="2493"></a>2493</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2494"></a>2494</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2495"></a>2495</td><td></td><td></td><td></td><td></td><td class="s">  my $session = $self-&gt;_data_sid_resolve($id);</td></tr>
<tr><td class="h"><a name="2496"></a>2496</td><td></td><td></td><td></td><td></td><td class="s">  return $session if defined $session;</td></tr>
<tr><td class="h"><a name="2497"></a>2497</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2498"></a>2498</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_explain_return(&quot;ID does not exist&quot;);</td></tr>
<tr><td class="h"><a name="2499"></a>2499</td><td></td><td></td><td></td><td></td><td class="s">  $! = ESRCH;</td></tr>
<tr><td class="h"><a name="2500"></a>2500</td><td></td><td></td><td></td><td></td><td class="s">  return;</td></tr>
<tr><td class="h"><a name="2501"></a>2501</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2502"></a>2502</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2503"></a>2503</td><td></td><td></td><td></td><td></td><td class="s"># Resolve a session reference to its corresponding ID.</td></tr>
<tr><td class="h"><a name="2504"></a>2504</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2505"></a>2505</td><td></td><td></td><td></td><td></td><td class="s">sub ID_session_to_id {</td></tr>
<tr><td class="h"><a name="2506"></a>2506</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $session) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2507"></a>2507</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2508"></a>2508</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2509"></a>2509</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined session in ID_session_to_id()&quot;</td></tr>
<tr><td class="h"><a name="2510"></a>2510</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $session;</td></tr>
<tr><td class="h"><a name="2511"></a>2511</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2512"></a>2512</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2513"></a>2513</td><td></td><td></td><td></td><td></td><td class="s">  my $id = $self-&gt;_data_ses_resolve_to_id($session);</td></tr>
<tr><td class="h"><a name="2514"></a>2514</td><td></td><td></td><td></td><td></td><td class="s">  if (defined $id) {</td></tr>
<tr><td class="h"><a name="2515"></a>2515</td><td></td><td></td><td></td><td></td><td class="s">    $! = 0;</td></tr>
<tr><td class="h"><a name="2516"></a>2516</td><td></td><td></td><td></td><td></td><td class="s">    return $id;</td></tr>
<tr><td class="h"><a name="2517"></a>2517</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2518"></a>2518</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2519"></a>2519</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_explain_return(&quot;session ($session) does not exist&quot;);</td></tr>
<tr><td class="h"><a name="2520"></a>2520</td><td></td><td></td><td></td><td></td><td class="s">  $! = ESRCH;</td></tr>
<tr><td class="h"><a name="2521"></a>2521</td><td></td><td></td><td></td><td></td><td class="s">  return;</td></tr>
<tr><td class="h"><a name="2522"></a>2522</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2523"></a>2523</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2524"></a>2524</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2525"></a>2525</td><td></td><td></td><td></td><td></td><td class="s"># Extra reference counts, to keep sessions alive when things occur.</td></tr>
<tr><td class="h"><a name="2526"></a>2526</td><td></td><td></td><td></td><td></td><td class="s"># They take session IDs because they may be called from resources at</td></tr>
<tr><td class="h"><a name="2527"></a>2527</td><td></td><td></td><td></td><td></td><td class="s"># times where the session reference is otherwise unknown.</td></tr>
<tr><td class="h"><a name="2528"></a>2528</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2529"></a>2529</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2530"></a>2530</td><td></td><td></td><td></td><td></td><td class="s">sub refcount_increment {</td></tr>
<tr><td class="h"><a name="2531"></a>2531</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $session_id, $tag) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2532"></a>2532</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2533"></a>2533</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2534"></a>2534</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined session ID in refcount_increment()&quot;</td></tr>
<tr><td class="h"><a name="2535"></a>2535</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $session_id;</td></tr>
<tr><td class="h"><a name="2536"></a>2536</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined reference count tag in refcount_increment()&quot;</td></tr>
<tr><td class="h"><a name="2537"></a>2537</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $tag;</td></tr>
<tr><td class="h"><a name="2538"></a>2538</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2539"></a>2539</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2540"></a>2540</td><td></td><td></td><td></td><td></td><td class="s">  unless ($self-&gt;_data_ses_exists($session_id)) {</td></tr>
<tr><td class="h"><a name="2541"></a>2541</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_return(&quot;session id $session_id does not exist&quot;);</td></tr>
<tr><td class="h"><a name="2542"></a>2542</td><td></td><td></td><td></td><td></td><td class="s">    $! = ESRCH;</td></tr>
<tr><td class="h"><a name="2543"></a>2543</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="2544"></a>2544</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2545"></a>2545</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2546"></a>2546</td><td></td><td></td><td></td><td></td><td class="s">  my $refcount = $self-&gt;_data_extref_inc($session_id, $tag);</td></tr>
<tr><td class="h"><a name="2547"></a>2547</td><td></td><td></td><td></td><td></td><td class="s">  # TODO trace it here</td></tr>
<tr><td class="h"><a name="2548"></a>2548</td><td></td><td></td><td></td><td></td><td class="s">  return $refcount;</td></tr>
<tr><td class="h"><a name="2549"></a>2549</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2550"></a>2550</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2551"></a>2551</td><td></td><td></td><td></td><td></td><td class="s">sub refcount_decrement {</td></tr>
<tr><td class="h"><a name="2552"></a>2552</td><td></td><td></td><td></td><td></td><td class="s">  my ($self, $session_id, $tag) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2553"></a>2553</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2554"></a>2554</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2555"></a>2555</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined session ID in refcount_decrement()&quot;</td></tr>
<tr><td class="h"><a name="2556"></a>2556</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $session_id;</td></tr>
<tr><td class="h"><a name="2557"></a>2557</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined reference count tag in refcount_decrement()&quot;</td></tr>
<tr><td class="h"><a name="2558"></a>2558</td><td></td><td></td><td></td><td></td><td class="s">      unless defined $tag;</td></tr>
<tr><td class="h"><a name="2559"></a>2559</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2560"></a>2560</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2561"></a>2561</td><td></td><td></td><td></td><td></td><td class="s">  unless ($self-&gt;_data_ses_exists($session_id)) {</td></tr>
<tr><td class="h"><a name="2562"></a>2562</td><td></td><td></td><td></td><td></td><td class="s">    $self-&gt;_explain_return(&quot;session id $session_id does not exist&quot;);</td></tr>
<tr><td class="h"><a name="2563"></a>2563</td><td></td><td></td><td></td><td></td><td class="s">    $! = ESRCH;</td></tr>
<tr><td class="h"><a name="2564"></a>2564</td><td></td><td></td><td></td><td></td><td class="s">    return;</td></tr>
<tr><td class="h"><a name="2565"></a>2565</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2566"></a>2566</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2567"></a>2567</td><td></td><td></td><td></td><td></td><td class="s">  my $refcount = $self-&gt;_data_extref_dec($session_id, $tag);</td></tr>
<tr><td class="h"><a name="2568"></a>2568</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2569"></a>2569</td><td></td><td></td><td></td><td></td><td class="s">  # TODO trace it here</td></tr>
<tr><td class="h"><a name="2570"></a>2570</td><td></td><td></td><td></td><td></td><td class="s">  return $refcount;</td></tr>
<tr><td class="h"><a name="2571"></a>2571</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2572"></a>2572</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2573"></a>2573</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2574"></a>2574</td><td></td><td></td><td></td><td></td><td class="s"># HANDLERS</td></tr>
<tr><td class="h"><a name="2575"></a>2575</td><td></td><td></td><td></td><td></td><td class="s">#==============================================================================</td></tr>
<tr><td class="h"><a name="2576"></a>2576</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2577"></a>2577</td><td></td><td></td><td></td><td></td><td class="s"># Add or remove event handlers from sessions.</td></tr>
<tr><td class="h"><a name="2578"></a>2578</td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.15ms (567Âµs+580Âµs) within POE::Kernel::state which was called 102 times, avg 11Âµs/call:
# 20 times (130Âµs+166Âµs) by POE::Wheel::ReadWrite::DESTROY at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#402">line 402 of POE/Wheel/ReadWrite.pm</a>, avg 15Âµs/call
# 20 times (100Âµs+158Âµs) by POE::Wheel::ReadWrite::DESTROY at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#407">line 407 of POE/Wheel/ReadWrite.pm</a>, avg 13Âµs/call
# 20 times (119Âµs+87Âµs) by POE::Wheel::ReadWrite::_define_read_state at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#294">line 294 of POE/Wheel/ReadWrite.pm</a>, avg 10Âµs/call
# 20 times (93Âµs+80Âµs) by POE::Wheel::ReadWrite::_define_write_state at <a href="POE-Wheel-ReadWrite-pm-94-sub.html#232">line 232 of POE/Wheel/ReadWrite.pm</a>, avg 9Âµs/call
# 10 times (66Âµs+38Âµs) by POE::Wheel::SocketFactory::_shutdown at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#1120">line 1120 of POE/Wheel/SocketFactory.pm</a>, avg 10Âµs/call
# 10 times (48Âµs+37Âµs) by POE::Wheel::SocketFactory::_define_connect_state at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#321">line 321 of POE/Wheel/SocketFactory.pm</a>, avg 8Âµs/call
#     once (4Âµs+10Âµs) by POE::Wheel::SocketFactory::_shutdown at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#1115">line 1115 of POE/Wheel/SocketFactory.pm</a>
#     once (7Âµs+3Âµs) by POE::Wheel::SocketFactory::_define_accept_state at <a href="POE-Wheel-SocketFactory-pm-101-sub.html#204">line 204 of POE/Wheel/SocketFactory.pm</a></div></div>sub state {</td></tr>
<tr><td class="h"><a name="2579"></a>2579</td><td class="c0">510</td><td class="c0"><span title="Avg 1Âµs">533Âµs</span></td><td></td><td></td><td class="s">  my ($self, $event, $state_code, $state_alias) = ($poe_kernel, @_[1..$#_]);</td></tr>
<tr><td class="h"><a name="2580"></a>2580</td><td></td><td></td><td></td><td></td><td class="s">  $state_alias = $event unless defined $state_alias;</td></tr>
<tr><td class="h"><a name="2581"></a>2581</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2582"></a>2582</td><td></td><td></td><td></td><td></td><td class="s">  if (ASSERT_USAGE) {</td></tr>
<tr><td class="h"><a name="2583"></a>2583</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; must call state() from a running session&quot;</td></tr>
<tr><td class="h"><a name="2584"></a>2584</td><td></td><td></td><td></td><td></td><td class="s">      if $kr_active_session == $self;</td></tr>
<tr><td class="h"><a name="2585"></a>2585</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; undefined event name in state()&quot; unless defined $event;</td></tr>
<tr><td class="h"><a name="2586"></a>2586</td><td></td><td></td><td></td><td></td><td class="s">    _confess &quot;&lt;us&gt; can't call state() outside a session&quot; if (</td></tr>
<tr><td class="h"><a name="2587"></a>2587</td><td></td><td></td><td></td><td></td><td class="s">      $kr_active_session == $self</td></tr>
<tr><td class="h"><a name="2588"></a>2588</td><td></td><td></td><td></td><td></td><td class="s">    );</td></tr>
<tr><td class="h"><a name="2589"></a>2589</td><td></td><td></td><td></td><td></td><td class="s">  };</td></tr>
<tr><td class="h"><a name="2590"></a>2590</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2591"></a>2591</td><td></td><td></td><td></td><td></td><td class="s">  if (</td></tr>
<tr><td class="h"><a name="2592"></a>2592</td><td></td><td></td><td></td><td></td><td class="s">    (ref($kr_active_session) ne '') &amp;&amp;</td></tr>
<tr><td class="h"><a name="2593"></a>2593</td><td></td><td></td><td></td><td></td><td class="s">    (ref($kr_active_session) ne 'POE::Kernel')</td></tr>
<tr><td class="h"><a name="2594"></a>2594</td><td></td><td></td><td></td><td></td><td class="s">  ) {</td></tr>
<tr><td class="h"><a name="2595"></a>2595</td><td></td><td></td><td class="c0">102</td><td class="c0">580Âµs</td><td class="s">    $kr_active_session-&gt;_register_state($event, $state_code, $state_alias);<div class="calls"><div class="calls_out">    # spent   580Âµs making 102 calls to <a href="POE-Session-pm-87-sub.html#500">POE::Session::_register_state</a>, avg 6Âµs/call</div></div></td></tr>
<tr><td class="h"><a name="2596"></a>2596</td><td></td><td></td><td></td><td></td><td class="s">    return 0;</td></tr>
<tr><td class="h"><a name="2597"></a>2597</td><td></td><td></td><td></td><td></td><td class="s">  }</td></tr>
<tr><td class="h"><a name="2598"></a>2598</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2599"></a>2599</td><td></td><td></td><td></td><td></td><td class="s">  # TODO A terminal signal (such as UIDESTROY) kills a session.  The</td></tr>
<tr><td class="h"><a name="2600"></a>2600</td><td></td><td></td><td></td><td></td><td class="s">  # Kernel deallocates the session, which cascades destruction to its</td></tr>
<tr><td class="h"><a name="2601"></a>2601</td><td></td><td></td><td></td><td></td><td class="s">  # HEAP.  That triggers a Wheel's destruction, which calls</td></tr>
<tr><td class="h"><a name="2602"></a>2602</td><td></td><td></td><td></td><td></td><td class="s">  # $kernel-&gt;state() to remove a state from the session.  The session,</td></tr>
<tr><td class="h"><a name="2603"></a>2603</td><td></td><td></td><td></td><td></td><td class="s">  # though, is already gone.  If TRACE_RETVALS and/or ASSERT_RETVALS</td></tr>
<tr><td class="h"><a name="2604"></a>2604</td><td></td><td></td><td></td><td></td><td class="s">  # is set, this causes a warning or fatal error.</td></tr>
<tr><td class="h"><a name="2605"></a>2605</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2606"></a>2606</td><td></td><td></td><td></td><td></td><td class="s">  $self-&gt;_explain_return(&quot;session ($kr_active_session) does not exist&quot;);</td></tr>
<tr><td class="h"><a name="2607"></a>2607</td><td></td><td></td><td></td><td></td><td class="s">  return ESRCH;</td></tr>
<tr><td class="h"><a name="2608"></a>2608</td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h"><a name="2609"></a>2609</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2610"></a>2610</td><td class="c3">1</td><td class="c3"><span title="Avg 5Âµs">5Âµs</span></td><td></td><td></td><td class="s">1;</td></tr>
<tr><td class="h"><a name="2611"></a>2611</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="2612"></a>2612</td><td></td><td></td><td></td><td></td><td class="s">__END__</td></tr>
<tr><td class="s"><a name=""></a>&nbsp;</td><td></td><td></td><td></td><td></td><td class="s"></td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_binmode"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 3.47ms (72Âµs+3.40) within POE::Kernel::CORE:binmode which was called 32 times, avg 108Âµs/call:
# 32 times (72Âµs+3.40ms) by POE::Kernel::_data_handle_condition at <a href="POE-Resource-FileHandles-pm-72-sub.html#439">line 439 of POE/Resource/FileHandles.pm</a>, avg 108Âµs/call</div></div>sub POE::Kernel::CORE:binmode; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_close"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 36Âµs within POE::Kernel::CORE:close which was called 2 times, avg 18Âµs/call:
#    once (23Âµs+0s) by POE::Kernel::_data_sig_pipe_finalize at <a href="POE-Resource-Signals-pm-85-sub.html#888">line 888 of POE/Resource/Signals.pm</a>
#    once (13Âµs+0s) by POE::Kernel::_data_sig_pipe_finalize at <a href="POE-Resource-Signals-pm-85-sub.html#891">line 891 of POE/Resource/Signals.pm</a></div></div>sub POE::Kernel::CORE:close; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_fteread"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 1.01ms within POE::Kernel::CORE:fteread which was called 819 times, avg 1Âµs/call:
# 819 times (1.01ms+0s) by POE::Kernel::_find_loop at <a href="POE-Kernel-pm-54-sub.html#486">line 486</a>, avg 1Âµs/call</div></div>sub POE::Kernel::CORE:fteread; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_match"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 85Âµs within POE::Kernel::CORE:match which was called 203 times, avg 418ns/call:
# 69 times (46Âµs+0s) by POE::Kernel::_data_sig_initialize at <a href="POE-Resource-Signals-pm-85-sub.html#155">line 155 of POE/Resource/Signals.pm</a>, avg 659ns/call
# 55 times (12Âµs+0s) by POE::Kernel::BEGIN@338 at <a href="POE-Kernel-pm-54-sub.html#353">line 353</a>, avg 213ns/call
# 45 times (18Âµs+0s) by POE::Kernel::_test_loop at <a href="POE-Kernel-pm-54-sub.html#532">line 532</a>, avg 400ns/call
# 34 times (10Âµs+0s) by POE::Kernel::_data_sig_initialize at <a href="POE-Resource-Signals-pm-85-sub.html#171">line 171 of POE/Resource/Signals.pm</a>, avg 285ns/call</div></div>sub POE::Kernel::CORE:match; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_pack"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 4Âµs within POE::Kernel::CORE:pack which was called 3 times, avg 1Âµs/call:
# 3 times (4Âµs+0s) by POE::Kernel::_recalc_id at <a href="POE-Kernel-pm-54-sub.html#2468">line 2468</a>, avg 1Âµs/call</div></div>sub POE::Kernel::CORE:pack; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_select"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 41Âµs within POE::Kernel::CORE:select which was called 64 times, avg 647ns/call:
# 64 times (41Âµs+0s) by POE::Kernel::_data_handle_condition at <a href="POE-Resource-FileHandles-pm-72-sub.html#460">line 460 of POE/Resource/FileHandles.pm</a>, avg 647ns/call</div></div>sub POE::Kernel::CORE:select; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_sort"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 6Âµs within POE::Kernel::CORE:sort which was called 4 times, avg 2Âµs/call:
# 4 times (6Âµs+0s) by POE::Kernel::import at <a href="POE-Kernel-pm-54-sub.html#59">line 59</a>, avg 2Âµs/call</div></div>sub POE::Kernel::CORE:sort; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_sselect"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 811ms within POE::Kernel::CORE:sselect which was called 401 times, avg 2.02ms/call:
# 398 times (811ms+0s) by POE::Kernel::loop_do_timeslice at <a href="POE-Loop-Select-pm-59-sub.html#202">line 202 of POE/Loop/Select.pm</a>, avg 2.04ms/call
#   3 times (12Âµs+0s) by POE::Kernel::_data_sig_pipe_has_signals at <a href="POE-Resource-Signals-pm-85-sub.html#807">line 807 of POE/Resource/Signals.pm</a>, avg 4Âµs/call</div></div>sub POE::Kernel::CORE:sselect; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_subst"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 36Âµs within POE::Kernel::CORE:subst which was called 47 times, avg 777ns/call:
# 45 times (34Âµs+0s) by POE::Kernel::_test_loop at <a href="POE-Kernel-pm-54-sub.html#538">line 538</a>, avg 753ns/call
#     once (2Âµs+0s) by POE::Kernel::_test_loop at <a href="POE-Kernel-pm-54-sub.html#567">line 567</a>
#     once (700ns+0s) by POE::Kernel::_test_loop at <a href="POE-Kernel-pm-54-sub.html#562">line 562</a></div></div>sub POE::Kernel::CORE:subst; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_unpack"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 14Âµs within POE::Kernel::CORE:unpack which was called 6 times, avg 2Âµs/call:
# 3 times (8Âµs+0s) by POE::Kernel::loop_finalize at <a href="POE-Loop-Select-pm-59-sub.html#67">line 67 of POE/Loop/Select.pm</a>, avg 3Âµs/call
# 3 times (6Âµs+0s) by POE::Kernel::_recalc_id at <a href="POE-Kernel-pm-54-sub.html#2468">line 2468</a>, avg 2Âµs/call</div></div>sub POE::Kernel::CORE:unpack; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel__CORE_waitpid"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 14Âµs within POE::Kernel::CORE:waitpid which was called:
#    once (14Âµs+0s) by POE::Kernel::_data_sig_finalize at <a href="POE-Resource-Signals-pm-85-sub.html#281">line 281 of POE/Resource/Signals.pm</a></div></div>sub POE::Kernel::CORE:waitpid; # opcode<br />        </td></tr>
<tr><td class="h"><a name="POE__Kernel____ANON__"></a></td><td></td><td></td><td></td><td></td><td class="s"><div class="calls"><div class="calls_in"># spent 7Âµs within POE::Kernel::__ANON__ which was called 15 times, avg 433ns/call:
# 8 times (3Âµs+0s) by POE::Kernel::_define_trace at <a href="POE-Kernel-pm-54-sub.html#325">line 325</a>, avg 412ns/call
# 5 times (2Âµs+0s) by POE::Kernel::_define_assert at <a href="POE-Kernel-pm-54-sub.html#344">line 344</a>, avg 400ns/call
#    once (600ns+0s) by POE::Session::BEGIN@84 at <a href="POE-Session-pm-87-sub.html#92">line 92 of POE/Session.pm</a>
#    once (600ns+0s) by POE::Session::BEGIN@84 at <a href="POE-Session-pm-87-sub.html#105">line 105 of POE/Session.pm</a></div></div>sub POE::Kernel::__ANON__; # xsub<br />        </td></tr>
</tbody></table></div>
        
            <script type="text/javascript"> $(document).ready(function() { 

        $("#subs_table").tablesorter({
            sortList: [[3,1]],
            headers: {
                3: { sorter: 'fmt_time' },
                4: { sorter: 'fmt_time' }
            }
        });
    
 } ); </script>
        
        <div class="footer">Report produced by the
        <a href="http://search.cpan.org/dist/Devel-NYTProf/">NYTProf 5.06</a>
        Perl profiler, developed by
        <a href="http://www.linkedin.com/in/timbunce">Tim Bunce</a> and
        <a href="http://code.nytimes.com">Adam Kaplan</a>.
        </div>
        <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
    </body></html>